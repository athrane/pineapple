<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 17 Apr 2017
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Allan Thrane Andersen" />
    <meta name="Date-Revision-yyyymmdd" content="20170417" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Pineapple process execution support - How-to: Use the process execution session to execute external processes</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Pineapple process execution support</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="../../../index.html" title="Pineapple Home">
        Pineapple Home</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href="../../" title="Pineapple support projects">
        Pineapple support projects</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href="../" title="Pineapple process execution support">
        Pineapple process execution support</a>
        </li>
      <li class="divider ">/</li>
        <li class="">How-to: Use the process execution session to execute external processes</li>
        
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 17 Apr 2017</li> 
            
                            </ul>
      </div>

                  
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Project Overview</li>
                                
      <li>
    
                          <a href="../../../index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/installation.html" title="Installation">
          <i class="none"></i>
        Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/index.html" title="For Users">
          <i class="none"></i>
        For Users</a>
            </li>
                  
      <li>
    
                          <a href="../../../development/index.html" title="For Developers">
          <i class="none"></i>
        For Developers</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/terms.html" title="Terms and Conditions">
          <i class="none"></i>
        Terms and Conditions</a>
            </li>
                              <li class="nav-header">Clients</li>
                                
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-web-application/pineapple-standalone-web-client/index.html" title="Standalone Web Application">
          <i class="none"></i>
        Standalone Web Application</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-web-application/pineapple-web-application-war/index.html" title="Deployable Web Application">
          <i class="none"></i>
        Deployable Web Application</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-maven-plugin/index.html" title="Maven Plugin">
          <i class="none"></i>
        Maven Plugin</a>
            </li>
                              <li class="nav-header">Plugins</li>
                                
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-agent-plugin/index.html" title="Agent">
          <i class="none"></i>
        Agent</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-composite-execution-plugin/index.html" title="Composite Execution">
          <i class="none"></i>
        Composite Execution</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-ssh-plugin/index.html" title="SSH">
          <i class="none"></i>
        SSH</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-docker-plugin/index.html" title="Docker">
          <i class="none"></i>
        Docker</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-infrastructure-test-plugin/index.html" title="Infrastructure Test">
          <i class="none"></i>
        Infrastructure Test</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-fusion-middleware-installation-plugin/index.html" title="Fusion Middleware Installation">
          <i class="none"></i>
        Fusion Middleware Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-weblogic-installation-plugin/index.html" title="WebLogic Installation">
          <i class="none"></i>
        WebLogic Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-weblogic-scripting-tool-plugin/index.html" title="WebLogic Scripting Tool (WLST)">
          <i class="none"></i>
        WebLogic Scripting Tool (WLST)</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-weblogic-jmx-plugin/index.html" title="WebLogic JMX">
          <i class="none"></i>
        WebLogic JMX</a>
            </li>
                              <li class="nav-header">API's</li>
                                
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-web-application/pineapple-web-application-war/usage/rest.html" title="REST">
          <i class="none"></i>
        REST</a>
            </li>
                  
      <li>
    
                          <a href="../../../development/plugin-framework.html" title="Plugin Framework">
          <i class="none"></i>
        Plugin Framework</a>
            </li>
                              <li class="nav-header">Additional Information</li>
                                
      <li>
    
                          <a href="http://pineapplesoftware.blogspot.com" class="externalLink" title="The Pineapple Project Blog">
          <i class="none"></i>
        The Pineapple Project Blog</a>
            </li>
                  
      <li>
    
                          <a href="http://exceptiontrail.blogspot.com" class="externalLink" title="Pineapple Exception Trail Blog">
          <i class="none"></i>
        Pineapple Exception Trail Blog</a>
            </li>
                              <li class="nav-header">Project Tools</li>
                                
      <li>
    
                          <a href="https://bintray.com/pineapple/maven/com.alpha.pineapple" class="externalLink" title="Downloads">
          <i class="none"></i>
        Downloads</a>
            </li>
                  
      <li>
    
                          <a href="https://github.com/athrane/pineapple" class="externalLink" title="Source Code">
          <i class="none"></i>
        Source Code</a>
            </li>
                  
      <li>
    
                          <a href="https://github.com/athrane/pineapple/issues" class="externalLink" title="Issue Tracker">
          <i class="none"></i>
        Issue Tracker</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                        
      <li>
    
                          <a href="../project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="https://pineapple.dev.java.net" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                        
        <div id="bodyColumn"  class="span10" >
                                  
            <!-- NOTE: For help with the syntax of this file, see: --><!-- http://maven.apache.org/guides/mini/guide-apt-format.html --><div class="section">
<h2>How-to: Use the process execution session to execute external processes<a name="How-to:_Use_the_process_execution_session_to_execute_external_processes"></a></h2>
<div class="section">
<h3>Introduction<a name="Introduction"></a></h3>
<p>This example illustrates how to setup a project to use the <tt>ProcessExecutionSessionImpl</tt> class in a plugin to execute external OS processes and capture the result in execution result objects.</p>
<p>To setup a project to use the asserter follow these steps:</p>
<ul>
<li>Add Maven dependency to the project.</li>
<li>Import the spring configuration file </li>
<li>Subclass <tt>ProcessExecutionSessionImpl</tt> into a plugin specific session class. </li>
<li>Annotate the plugin specific session class. </li>
<li>Use the session object in operations. </li></ul></div>
<div class="section">
<h3>Add Maven dependency to the project<a name="Add_Maven_dependency_to_the_project"></a></h3>
<p>The <tt>ProcessExecutionSessionImpl</tt> class is defined in the <tt>pineapple-process-execution-support</tt> project, so add a Maven dependency to the project POM:</p>
<div class="source">
<pre>  &lt;dependency&gt;
    &lt;groupId&gt;com.alpha.pineapple&lt;/groupId&gt;
    &lt;artifactId&gt;pineapple-process-execution-support&lt;/artifactId&gt;                       
  &lt;/dependency&gt;                         
</pre></div></div>
<div class="section">
<h3>Import the spring configuration file<a name="Import_the_spring_configuration_file"></a></h3>
<p>If the project contain a Spring configuration file for definition of the beans used by the project then add an <tt>import</tt> directive to import the Spring configuration file from the process execution project:</p>
<div class="source">
<pre>        &lt;!-- Configures pineapple-process-execution-plugin-support --&gt;
        &lt;import resource=&quot;classpath:com.alpha.pineapple.process.execution-config.xml&quot; /&gt;
</pre></div>
<p>Now the session class and other command class is available in the project with the bean id's:</p>
<ul>
<li><tt>processExecutionCommand</tt> which is an prototype instance of a process execution command.</li>
<li><tt>processExecutionSession</tt> which is an prototype instance of a process execution session. </li></ul>
<p><b>Please notice:</b> that the purpose isn't to get access to the session class through Spring, but to enable the session class to access the process execution command through Spring. </p></div>
<div class="section">
<h3>Subclass <tt>ProcessExecutionSessionImpl</tt> into a plugin specific session class <a name="Subclass_ProcessExecutionSessionImpl_into_a_plugin_specific_session_class"></a></h3>
<p>Subclass the <tt>ProcessExecutionSessionImpl</tt> into a plugin specific session class to reuse the functionality of the class. </p>
<p>Example: in the JRockit installation plugion the <tt>ProcessExecutionSessionImpl</tt> class is subclasses into <tt>JRockitInstallationSessionImpl</tt> </p>
<div class="source">
<pre>
package com.alpha.pineapple.plugin.jrockit.installation.session;

import com.alpha.pineapple.plugin.PluginSession;
import com.alpha.pineapple.session.ProcessExecutionSessionImpl;

/**
 * Subclass of {@link ProcessExecutionSessionImpl} to reuse it.   
 */
@PluginSession
public class JRockitInstallationSessionImpl extends ProcessExecutionSessionImpl {
}
        
</pre></div></div>
<div class="section">
<h3>Annotate the plugin specific session class <a name="Annotate_the_plugin_specific_session_class"></a></h3>
<p>To enable the usage of the session class at runtime , annotate it with the <tt>@PluginSession</tt> annotation.</p>
<p>Example: From the JRockit installation plugin: </p>
<div class="source">
<pre>
package com.alpha.pineapple.plugin.jrockit.installation.session;

import com.alpha.pineapple.plugin.PluginSession;
import com.alpha.pineapple.session.ProcessExecutionSessionImpl;

/**
 * Subclass of {@link ProcessExecutionSessionImpl} to reuse it.   
 */
@PluginSession
public class JRockitInstallationSessionImpl extends ProcessExecutionSessionImpl {
}
        
</pre></div></div>
<div class="section">
<h3>Use the session object in operations<a name="Use_the_session_object_in_operations"></a></h3>
<p>The session object will now be initialized by Pineapple when an operation is executed. The session object is available to any operation since it is passed as any argument to operations in the plugin. </p>
<p>Example: From the JRockit installation plugin: </p>
<div class="source">
<pre>
@PluginOperation( OperationNames.DEPLOY_CONFIGURATION )
public class DeployConfiguration implements Operation
{

    public void execute( Object content, Session session, ExecutionResult executionResult ) throws PluginExecutionFailedException
    {
        // validate parameters
        Validate.notNull( content, &quot;content is undefined.&quot; );
        Validate.notNull( session, &quot;session is undefined.&quot; );
        Validate.notNull( executionResult, &quot;executionResult is undefined.&quot; );        
        
        // throw exception if required type isn't available
        if ( !( session instanceof ProcessExecutionSession ) )
        {
                Object[] args = { ProcessExecutionSession.class };                      
                String message = messageProvider.getMessage(&quot;dc.session_typecast_failed&quot;, args );
            throw new PluginExecutionFailedException( message );
        }
                
        try
        {               
            // type cast to JRockit installation model object
                JRockitInstallation model = (JRockitInstallation) content;
            
            // type cast to process execution session 
            ProcessExecutionSession externalProcessSession = (ProcessExecutionSession) session; 

                        //.. more code goes here...
                        
                        // execute external process     
                        session.execute(installer , arguments, DEFAULT_PROCESS_TIMEOUT, description2, result);
                        
        }
        catch ( Exception e )
        {
                Object[] args = { e.toString() };                       
                String message = messageProvider.getMessage(&quot;dc.error&quot;, args );
            throw new PluginExecutionFailedException( message, e );
        }                                       
        
        }

}
        
</pre></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2017.
          All Rights Reserved.      
                    
      </div>

                          
        
                </div>
    </footer>
  </body>
</html>
