<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 13 Apr 2017
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Allan Thrane Andersen" />
    <meta name="Date-Revision-yyyymmdd" content="20170413" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Pineapple Project - Module Configuration Reference</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.0.min.js"></script>

    
              <!-- Google Analytics -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28287414-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Pineapple Project</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="../index.html" title="Pineapple Home">
        Pineapple Home</a>
        </li>
      <li class="divider ">/</li>
        <li class="">Module Configuration Reference</li>
        
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 13 Apr 2017</li> 
            
                            </ul>
      </div>

                  
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Project Overview</li>
                                
      <li>
    
                          <a href="../index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="../usage/installation.html" title="Installation">
          <i class="none"></i>
        Installation</a>
            </li>
                  
      <li>
    
                          <a href="../usage/index.html" title="For Users">
          <i class="none"></i>
        For Users</a>
            </li>
                  
      <li>
    
                          <a href="../development/index.html" title="For Developers">
          <i class="none"></i>
        For Developers</a>
            </li>
                  
      <li>
    
                          <a href="../usage/terms.html" title="Terms and Conditions">
          <i class="none"></i>
        Terms and Conditions</a>
            </li>
                              <li class="nav-header">Clients</li>
                                
      <li>
    
                          <a href="../pineapple-applications/pineapple-web-application/pineapple-standalone-web-client/index.html" title="Standalone Web Application">
          <i class="none"></i>
        Standalone Web Application</a>
            </li>
                  
      <li>
    
                          <a href="../pineapple-applications/pineapple-web-application/pineapple-web-application-war/index.html" title="Deployable Web Application">
          <i class="none"></i>
        Deployable Web Application</a>
            </li>
                  
      <li>
    
                          <a href="../pineapple-applications/pineapple-maven-plugin/index.html" title="Maven Plugin">
          <i class="none"></i>
        Maven Plugin</a>
            </li>
                              <li class="nav-header">Plugins</li>
                                
      <li>
    
                          <a href="../pineapple-plugins/pineapple-agent-plugin/index.html" title="Agent">
          <i class="none"></i>
        Agent</a>
            </li>
                  
      <li>
    
                          <a href="../pineapple-plugins/pineapple-composite-execution-plugin/index.html" title="Composite Execution">
          <i class="none"></i>
        Composite Execution</a>
            </li>
                  
      <li>
    
                          <a href="../pineapple-plugins/pineapple-ssh-plugin/index.html" title="SSH">
          <i class="none"></i>
        SSH</a>
            </li>
                  
      <li>
    
                          <a href="../pineapple-plugins/pineapple-docker-plugin/index.html" title="Docker">
          <i class="none"></i>
        Docker</a>
            </li>
                  
      <li>
    
                          <a href="../pineapple-modules/pineapple-infrastructure-test-plugin/index.html" title="Infrastructure Test">
          <i class="none"></i>
        Infrastructure Test</a>
            </li>
                  
      <li>
    
                          <a href="../pineapple-plugins/pineapple-fusion-middleware-installation-plugin/index.html" title="Fusion Middleware Installation">
          <i class="none"></i>
        Fusion Middleware Installation</a>
            </li>
                  
      <li>
    
                          <a href="../pineapple-plugins/pineapple-weblogic-installation-plugin/index.html" title="WebLogic Installation">
          <i class="none"></i>
        WebLogic Installation</a>
            </li>
                  
      <li>
    
                          <a href="../pineapple-modules/pineapple-weblogic-deployment-plugin/index.html" title="WebLogic Deployment">
          <i class="none"></i>
        WebLogic Deployment</a>
            </li>
                  
      <li>
    
                          <a href="../pineapple-plugins/pineapple-weblogic-scripting-tool-plugin/index.html" title="WebLogic Scripting Tool (WLST)">
          <i class="none"></i>
        WebLogic Scripting Tool (WLST)</a>
            </li>
                  
      <li>
    
                          <a href="../pineapple-modules/pineapple-weblogic-jmx-plugin/index.html" title="WebLogic JMX">
          <i class="none"></i>
        WebLogic JMX</a>
            </li>
                              <li class="nav-header">API's</li>
                                
      <li>
    
                          <a href="../pineapple-applications/pineapple-web-application/pineapple-web-application-war/usage/rest.html" title="REST">
          <i class="none"></i>
        REST</a>
            </li>
                  
      <li>
    
                          <a href="../development/plugin-framework.html" title="Plugin Framework">
          <i class="none"></i>
        Plugin Framework</a>
            </li>
                              <li class="nav-header">Additional Information</li>
                                
      <li>
    
                          <a href="http://pineapplesoftware.blogspot.com" class="externalLink" title="The Pineapple Project Blog">
          <i class="none"></i>
        The Pineapple Project Blog</a>
            </li>
                  
      <li>
    
                          <a href="http://exceptiontrail.blogspot.com" class="externalLink" title="Pineapple Exception Trail Blog">
          <i class="none"></i>
        Pineapple Exception Trail Blog</a>
            </li>
                              <li class="nav-header">Project Tools</li>
                                
      <li>
    
                          <a href="https://bintray.com/pineapple/maven/com.alpha.pineapple" class="externalLink" title="Downloads">
          <i class="none"></i>
        Downloads</a>
            </li>
                  
      <li>
    
                          <a href="https://github.com/athrane/pineapple" class="externalLink" title="Source Code">
          <i class="none"></i>
        Source Code</a>
            </li>
                  
      <li>
    
                          <a href="https://github.com/athrane/pineapple/issues" class="externalLink" title="Issue Tracker">
          <i class="none"></i>
        Issue Tracker</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                        
      <li>
    
                          <a href="../project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="http://pineapple.java.net/" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                        
        <div id="bodyColumn"  class="span10" >
                                  
            <!-- NOTE: For help with the syntax of this file, see: --><!-- http://maven.apache.org/guides/mini/guide-apt-format.html --><div class="section">
<h2>Module Configuration Reference<a name="Module_Configuration_Reference"></a></h2>
<ul>
<li><a href="#Introduction">Introduction</a></li>
<li><a href="#Module_overview">Module overview</a></li>
<li><a href="#Model_overview">Model overview</a></li>
<li><a href="#Module_configuration_details">Module configuration details</a></li>
<li><a href="#Controlling_execution">Controlling execution</a></li>
<li><a href="#Variable_support_in_modules">Variable support in modules</a></li>
<li><a href="#Trigger_support_in_modules">Trigger support in modules</a></li></ul>
<div class="section">
<h3>Introduction<a name="Introduction"></a></h3>
<p>A module defines the input used by Pineapple when an operation is executed to do some work. </p>
<p>A module contains a managed artifact. Examples of managed artifacts are:</p>
<ul>
<li>A web application which is deployed (or undeployed) to a target environment.</li>
<li>An installer which installs( or uninstalls) a software product to a target environment.</li>
<li>A model which defines test cases to test some IT infrastructure.</li>
<li>A model which defines commands to configure or test an operating system.</li>
<li>A model which defines the configuration of an application server.</li></ul>
<p>The module contains all information to manage the artifact except:</p>
<ul>
<li>Platform specific information. </li>
<li>Security information. </li></ul>
<p>Platform and security information are defined in the environment configuration. The environment configuration is a small CMDB which is divided into logical environments. </p>
<p>Modules are used to define targeted updates of the computing environment modelled by the environment configuration. </p></div>
<div class="section">
<h3>Module overview<a name="Module_overview"></a></h3>
<div class="section">
<h4>Entities defined in a module<a name="Entities_defined_in_a_module"></a></h4>
<p>The entities defined in the module configuration:</p>
<ul>
<li><b>module directory</b> - the directory structure which defines a module.</li>
<li><b>module descriptor</b> - optional module descriptor file which defines meta data and variables. </li>
<li><b>model</b> - contains data which directs the actions of the plugins. </li></ul></div>
<div class="section">
<h4>A module is defined in a directory <a name="A_module_is_defined_in_a_directory"></a></h4>
<p>A module is defined by a directory. The name of directory should reflect the content of directory but there are no strict requirements. </p>
<p>The individual module directories are by default located as sub directories in the <b>Modules Directory</b>. The default location of the Modules Directory is <tt>${pineapple.home.dir}/modules</tt> which by default is resolved to <tt>${user.home}/.pineapple/modules</tt>. </p><img src="../images/module-directory-layout.jpg" alt="" /></div>
<div class="section">
<h4>A module can contain a module descriptor file named <tt>module.xml</tt><a name="A_module_can_contain_a_module_descriptor_file_named_module.xml"></a></h4>
<p>The module directory can contain a file named <tt>module.xml</tt> which must adhere to the <b>module schema</b> whose content is described in the details section below. </p>
<p>The purposes of the module descriptor are:</p>
<ul>
<li><b>Define meta data</b>. The descriptor file can define the <tt>id</tt> and <tt>version</tt> meta data. If the a module doesn't contain the descriptor file then the name of the directory is used as <tt>id</tt> and the version will be set to the default version <tt>1.0.0</tt>. The meta data is used in the human readable output generated at runtime, i.e the GUI and reports.</li>
<li><b>Define variables</b>. the descriptor file can variables which then are available in the models.</li></ul></div>
<div class="section">
<h4>A module is self contained package - but for security information<a name="A_module_is_self_contained_package_-_but_for_security_information"></a></h4>
<p>A module contains a managed artifact to test or configure a computing environment. </p>
<p>The module contains all information to manage the artifact except for platform specific information and security information which are located in the environment configuration. </p></div>
<div class="section">
<h4>The content of a module are grouped by environment <a name="The_content_of_a_module_are_grouped_by_environment"></a></h4>
<p>The models which are defined in a module are grouped by environment as a module often will different configuration for each environments. An example could be a module which contains an application. The deployment targets will differ in each environment.</p></div></div>
<div class="section">
<h3>Model overview<a name="Model_overview"></a></h3>
<div class="section">
<h4>Models are located in the <tt>models</tt> directory within a module<a name="Models_are_located_in_the_models_directory_within_a_module"></a></h4>
<p>The models which are part of a module are located in the <b>mandatory</b> <tt>models</tt> directory within the module directory.</p></div>
<div class="section">
<h4>The model name defines the target environment<a name="The_model_name_defines_the_target_environment"></a></h4>
<p>The model file name defines the target environment for which the model defines input. For this to work, the environment must be defined in environment configuration. Otherwise execution of the model will fail since Pineapple wouldn't know which resource(s) to target for the execution.</p></div>
<div class="section">
<h4>A model file can contains multiple plugin specific models<a name="A_model_file_can_contains_multiple_plugin_specific_models"></a></h4>
<p>The simple scenario is define one plugin specific model in a model file. The plugin specific model is then targeted to a set of target resources, i.e getting some work done at the targeted resources. A model file can contain multiple plugin specific models. One purpose is to separate a plugin specific model into smaller manageable parts, e.g. a precondition test, a configuration part and a postcondition test. An alternate reason for having multiple plugin specific models within a model is to target different plugins in sequence. </p></div>
<div class="section">
<h4>A model is bound to one or more target resource(s)<a name="A_model_is_bound_to_one_or_more_target_resources"></a></h4><img src="../images/model-resource-ref.jpg" alt="" />
<p>To identify the resource within an environment which should be invoked with the model, each model defines a <b>target resource</b> whose value must be a valid ID of a resource defined in the environment. The target resource also supports targeting of multiple resources, either through lists or regular expressions as described in the <a href="#Module_configuration_details">Module configuration details</a> section. </p>
<p>The <b>target resource</b> binds a model to one or more resource(s) at runtime. The reason for this design is to implement a <i>decoupling</i> of platform specific information and security information from the modules (hence the models). </p><img src="../images/model-resource-ref2.jpg" alt="" />
<p>Resource definitions can be fairly static as longs as they represent the computing environment and they are intended to be reused across the models used to manage that particular computing environment.</p></div></div>
<div class="section">
<h3>Module configuration details <a name="Module_configuration_details"></a></h3>
<p>This section is a detailed description of how to define module configuration files which adheres to the <b>module schema</b> and <b>module model schema</b> .</p>
<div class="section">
<h4>The module configuration schemas<a name="The_module_configuration_schemas"></a></h4>
<div class="section">
<h5>Why two schemas to define a module<a name="Why_two_schemas_to_define_a_module"></a></h5>
<p>Two schemas are used to define the content of a module. One schema is used to define the content of module descriptor and one schema is used to defined the content of module models:</p>
<ul>
<li><b>Module schema.</b> The schema defines the namespace <tt>http://pineapple.dev.java.net/ns/module_1_0</tt></li>
<li><b>Module model schema.</b> The schema defines the namespace <tt>http://pineapple.dev.java.net/ns/module_model_1_0</tt></li></ul>
<p><b><a href="./schemas.html">Link to information about the location of the schemas.</a></b> </p></div>
<div class="section">
<h5>Element and attribute qualification for the module schema <a name="Element_and_attribute_qualification_for_the_module_schema"></a></h5>
<p>The schema is defined with:</p>
<ul>
<li>elementFormDefault=&quot;qualified&quot; </li>
<li>attributeFormDefault=&quot;unqualified&quot;</li></ul>
<p>The module configuration documents using the schema will only use a single namespace and hence there is no need for qualified attributes. </p></div>
<div class="section">
<h5>Element and attribute qualification for the module model schema <a name="Element_and_attribute_qualification_for_the_module_model_schema"></a></h5>
<p>The schema is defined with:</p>
<ul>
<li>elementFormDefault=&quot;qualified&quot; </li>
<li>attributeFormDefault=&quot;unqualified&quot;</li></ul>
<p>The module model configuration documents using the schema will use multiple schemas so the attribute/element qualification settings is intended to promote documents where ALL elements are prefix with their namespace. </p></div></div>
<div class="section">
<h4>The minimal module descriptor (optional)<a name="The_minimal_module_descriptor_optional"></a></h4>
<p>The minimal file for <tt>module.xml</tt> looks like:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;module xmlns=&quot;http://pineapple.dev.java.net/ns/module_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_1_0 
                      http://pineapple.dev.java.net/ns/module_1_0.xsd&quot;
                       
  id=&quot;my-first-module&quot; 
  version=&quot;1.0.0&quot; /&gt;
</pre></div>
<p>The <tt>?xml</tt> element defines an XML file with UTF-8 encoding. </p>
<p>The top level element for a module file is <tt>module</tt>. The element contains attributes which defines the used XML schemas and the two module attributes <tt>id</tt> and <tt>version</tt>.</p>
<p>Usage of the module schema as the main schema is defined with the <tt>xmlns</tt> attribute:</p>
<div class="source">
<pre>  xmlns=&quot;http://pineapple.dev.java.net/ns/module_1_0
</pre></div>
<p>Inclusion of the XML-Schema schema with namespace <tt>xsi</tt> is defined by:</p>
<div class="source">
<pre>  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
</pre></div>
<p>Specification of the schema location for the module schema is defined by:</p>
<div class="source">
<pre>  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_1_0 
                      http://pineapple.dev.java.net/ns/module_1_0.xsd&quot;
</pre></div>
<p>The id of the module is defined by the <b>id</b> attribute, in this case the module is named &quot;my-first-module&quot;: </p>
<div class="source">
<pre>  id=&quot;my-first-module&quot;
</pre></div>
<p>The version information of the module is defined by the <b>version</b> attribute, in this case the version is 1.0.0: </p>
<div class="source">
<pre>  version=&quot;1.0.0&quot;
</pre></div></div>
<div class="section">
<h4>The minimal model file<a name="The_minimal_model_file"></a></h4>
<p>The minimal model file looks like:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model__1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;  
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model__1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; /&gt;
</pre></div>
<p>The <tt>?xml</tt> element defines an XML file with UTF-8 encoding. </p>
<p>The top level element for a model file is <tt>mmd:models</tt>. The element contains attributes which defines the used XML schemas. The element (and all other elements in a model file ) should be qualified as a model of any usage will contains elements from multiple name spaces. Such documents will contain elements from the module model namespace and from the namespaces of the used plugins. </p>
<p>Usage of the module model schema is defined with the <tt>xmlns:mmd</tt> attribute:</p>
<div class="source">
<pre>  xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_1_0
</pre></div>
<p>..but any prefix could have been used, e.g. mm, m, mod. Anything that signifies that the element belongs to the module model schema. </p>
<p>Inclusion of the XML-Schema schema with namespace <tt>xsi</tt> is defined by:</p>
<div class="source">
<pre>  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
</pre></div>
<p>Specification of the schema location for the module model schema is defined by:</p>
<div class="source">
<pre>  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot;
</pre></div></div>
<div class="section">
<h4>Defining plugin specific models <a name="Defining_plugin_specific_models"></a></h4>
<p>A model file can consist of any number of plugin specific models. A plugin specific model is defined by a <tt>model</tt> element.</p>
<div class="section">
<h5>Defining the model container <a name="Defining_the_model_container"></a></h5>
<p>The <tt>model</tt> element defines a plugin specific model. The element contains:</p>
<ul>
<li><b>Meta data.</b> The element attributes defines how the model is applied to the targeted resource(s).</li>
<li><b>Model content.</b> The model content defines the input to a plugin which interprets the content and performs some action one the targeted resource(s) depending on the invoked operation. </li></ul>
<p>The minimal plugin specific model contains: </p>
<ul>
<li>One mandatory attribute <tt>target-resource</tt> which defines the resource(s) that the model content should be targeted to. </li>
<li>One mandatory sub element <tt>content</tt> which defines root of the input to the invoked plugin. </li></ul>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;

  &lt;mmd:model target-resource=&quot;ssh-node1&quot; &gt;
    &lt;mmd:content /&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div></div>
<div class="section">
<h5>Targeting a model to resources<a name="Targeting_a_model_to_resources"></a></h5>
<p>The mandatory <tt>target-resource</tt> attribute defines the resource(s) in the environment configuration that the model content should be targeted to.</p>
<p>The attribute supports three options for targeting resources:</p>
<ul>
<li><b>Single resource</b>. A single resource can be targeted by setting the attribute value to the resource name, e.g. target-resource=&quot;ssh-node1&quot;. </li>
<li><b>List</b>. Any number of resources can be targeted through the usage of a list notation. The value enclosed by { } is interpreted as a comma-separated list and the resources defined in the list will be targeted. Example: target-resource=&quot;{ssh-node1, ssh-node2, ssh-node3}&quot;. </li>
<li><b>Regular expression</b>. Any number of resources can be targeted through the usage of a regular expression notation. The value which follow the regex: prefix is interpreted as a regular expression. Any resource which match the regular expression will will be targeted. The java.util.regex API is used to match the resources against the regular expression, so the syntax of this API must be observed. Example: target-resource=&quot;regex:ssh-node.*&quot; </li></ul>
<p>Example illustrating the three targeting options:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;

  &lt;!-- will target ssh-node1 only --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; &gt;
    &lt;mmd:content /&gt;
  &lt;/mmd:model&gt;

  &lt;!-- will target ssh-node1 to ssh-node3 --&gt;
  &lt;mmd:model target-resource=&quot;{ssh-node1, ssh-node2, ssh-node3}&quot; &gt;
    &lt;mmd:content /&gt;
  &lt;/mmd:model&gt;

  &lt;!-- will target ssh-node1 to ssh-node9 --&gt;
  &lt;mmd:model target-resource=&quot;regex:ssh-node.*&quot; &gt;
    &lt;mmd:content /&gt;
  &lt;/mmd:model&gt;

&lt;/mmd:models&gt;
</pre></div></div>
<div class="section">
<h5>Defining the operations when a model is executed<a name="Defining_the_operations_when_a_model_is_executed"></a></h5>
<p>The optional <tt>target-operation</tt> attribute defines the operation(s) when the model should be applied to the target resources.</p>
<p><i>(A science bit):</i> The main idea with Pineapple in regard to the trinity of models, plugins and operation is that the same model applied to a plugin with different operations results in the execution of different semantics. The semantics of a model depends on the operation that it is invoked with. The idea holds true for some plugins. An example is the installation plugins where a model invoked with a <i>deploy-configuration</i> operation installs a product and the same model invoked with the <i>undeploy-configuration</i> uninstalls the installed product. The idea doesn't hold true all plugins though. An example is the SSH plugin, whose models tends to be very specific in regard to either deploy some configuration (e.g. <i>mkdir</i> stuff) or delete it (e.g. <i>rm -rf</i> stuff). To realize the idea, and support different semantics for a model, then Pineapple must abstract the domain and provide a domain specific language and then implement the semantics for the support operations (e.g. create, destroy, test, report etc). In this perspective, the SSH plugin can be considered to be too low level to fit into the overall design of Pineapple. </p>
<p>But the SSH plugin has proven to be very handy in provisioning scenarios, so a practical solution is introduced. The solution is the addition of support for targeting a model to one or more operations. The <tt>target-operation</tt> attribute support this requirement and as a result a single model file can contain two plugin specific models, one which deploy some configuration (e.g. <i>mkdir</i> stuff) and one which delete it (e.g. <i>rm -rf</i> stuff). </p>
<p>When the model is invoked with the <i>deploy-configuration</i> operation then first model is executed (the one with: <tt>target-operation=&quot;deploy-configuration&quot;</tt>) and some configuration is deployed (e.g. <i>mkdir</i> stuff). When the model is invoked with the <i>undeploy-configuration</i> operation then second model is executed (the one with: <tt>target-operation=&quot;undeploy-configuration&quot;</tt>) and some configuration is undeployed (e.g. <i>rm -rf</i> stuff): </p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;

  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;deploy-configuration&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;mkdir stuff&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;undeploy-configuration&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;rm -rf stuff&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;  
&lt;/mmd:models&gt;
</pre></div>
<p>The attribute supports three options for targeting operations:</p>
<ul>
<li><b>* (The wildcard identifier)</b>. The model is targeted for any operation. This is the default value.</li>
<li><b>Single operation</b>. A single operation can be targeted by setting the attribute value to the operation name, e.g. target-operation=&quot;deploy-configuration&quot;.</li>
<li><b>List</b>. Any number of operations can be targeted through the usage of a list notation. The value enclosed by { } is interpreted as a comma-separated list and the model will be executed if the operation match one of the names in the list. Example: target-operation=&quot;{deploy-configuration, test}&quot;. </li></ul>
<p>Example illustrating the targeting options:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;

  &lt;!-- will only execute model when module is invoked with the &quot;deploy-configuration&quot; operation --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;deploy-configuration&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;mkdir stuff&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;

  &lt;!-- will only execute model when module is invoked with the &quot;undeploy-configuration&quot; operation --&gt;  
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;undeploy-configuration&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;rm -rf stuff&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;  

  &lt;!-- will execute model when module is invoked with either the &quot;undeploy-configuration&quot; or the &quot;deploy-configuration&quot; operation --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;{deploy-configuration, undeploy-configuration}&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;!-- more stuff here --&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;  

  &lt;!-- will execute model when module is invoked with any operation --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;*&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;!-- more stuff here --&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;  

&lt;/mmd:models&gt;
</pre></div>
<p>If the attribute isn't defined then default value is the wildcard identifier &quot;*&quot;, where the model will be executed for any operation. </p></div>
<div class="section">
<h5>Describing the model<a name="Describing_the_model"></a></h5>
<p>The optional <tt>description</tt> attribute support definition of a human readable description which is used in the GUI and generated reports..</p>
<p>If the attribute isn't defined then default value is &quot;Description n/a&quot;. </p>
<p>Example illustrating the usage of the attribute:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;

  &lt;mmd:model target-resource=&quot;ssh-node1&quot; description=&quot;Model targeted to ssh-node1 only&quot; &gt;
    &lt;mmd:content /&gt;
  &lt;/mmd:model&gt;

  &lt;mmd:model target-resource=&quot;{ssh-node1, ssh-node2, ssh-node3}&quot; description=&quot;Model targeted to ssh-node1 to ssh-node3&quot; &gt;
    &lt;mmd:content /&gt;
  &lt;/mmd:model&gt;

  &lt;mmd:model target-resource=&quot;regex:ssh-node.*&quot; description=&quot;Model targeted to ssh-node1 to ssh-node9&quot; &gt;
    &lt;mmd:content /&gt;
  &lt;/mmd:model&gt;

&lt;/mmd:models&gt;
</pre></div></div>
<div class="section">
<h5>Controlling variable substitution<a name="Controlling_variable_substitution"></a></h5>
<p>The optional <tt>substitute-variables</tt> attribute controls whether variable substitution is enabled or disabled for the content of the plugin specific model.</p>
<p>If the attribute isn't defined then default value is <tt>true</tt>, i.e. variable substitution is enabled. </p>
<p>Example illustrating the usage of the attribute whose execution will fail due to the variable <tt>${host}</tt> not being resolved in the model:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;
  xmlns:mdl=&quot;http://pineapple.dev.java.net/ns/module_1_0&quot; 
  xmlns:itp=&quot;http://pineapple.dev.java.net/ns/plugin/infrastructure_1_0&quot; &gt;
  &lt;mmd:variables&gt;
    &lt;mmd:variable key=&quot;host&quot; value=&quot;10.15.100.20&quot; /&gt;
  &lt;/mmd:variables&gt;
  &lt;mmd:model target-resource=&quot;infrastructure-test&quot; substitute-variables=&quot;false&quot;&gt;
    &lt;mmd:content&gt;
      &lt;itp:infrastructure&gt;
        &lt;itp:tcp-connection-test host=&quot;${host}&quot; description=&quot;WebLogic Adm Server:7001,7091&quot;&gt;
          &lt;itp:port value=&quot;7001&quot; /&gt;                                     
          &lt;itp:port value=&quot;7091&quot; /&gt;
        &lt;/itp:tcp-connection-test&gt;
      &lt;/itp:infrastructure&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div></div>
<div class="section">
<h5>Defining the model content <a name="Defining_the_model_content"></a></h5>
<p>The mandatory <tt>content</tt> element defines the root of the model content.</p>
<p>Everything under the <tt>content</tt> element is bound to the schema of the plugin which is used by the resource and used as input to the plugin at runtime. </p>
<p>The plugin specific model elements below the <tt>content</tt> element can (should) be specified using fully qualified elements. Example illustrating the model content with fully qualified elements (using the <tt>shp</tt> prefix): </p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;

  &lt;mmd:model target-resource=&quot;ssh-node1&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;sudo yum --assumeyes install unzip&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div></div>
<div class="section">
<h5>A model file can contain multiple plugin specfic models<a name="A_model_file_can_contain_multiple_plugin_specfic_models"></a></h5>
<p>A model file can contain multiple models. The models can either target the same resource(s);</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;

  &lt;mmd:model target-resource=&quot;ssh-node1&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;sudo yum --assumeyes install unzip&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;sudo yum --assumeyes install chkconfig&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div>
<p>or different resources as shown here: </p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xmlns:pap=&quot;http://pineapple.dev.java.net/ns/plugin/agent_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;

  &lt;mmd:model target-resource=&quot;ssh-node1&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;sudo yum --assumeyes install unzip&quot; /&gt;
        &lt;shp:execute command=&quot;sudo yum --assumeyes install chkconfig&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
  &lt;mmd:model target-resource=&quot;agent-node1&quot; &gt;
    &lt;mmd:content&gt;  
      &lt;pap:agent&gt;
        &lt;pap:distribute-and-execute-operation module=&quot;my-testsuite&quot; environment=&quot;local&quot; operation=&quot;test&quot; /&gt;
      &lt;/pap:agent&gt;                      
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;                  
&lt;/mmd:models&gt;
</pre></div></div></div></div>
<div class="section">
<h3>Controlling execution <a name="Controlling_execution"></a></h3>
<p>Pineapple supports the concept of <i>continuation policy</i> which controls how it reacts when an error or failure occurs executing an operation. The continuation policy can be used in two different ways:</p>
<ul>
<li><a href="#Defining_a_continuation_policy_to_control_execution_on_failure_or_error">Defining a continuation policy to control execution on failure or error</a>. It can be declared in modules to control how Pineapple should react when an error or failure occurs executing an operation.</li>
<li><a href="#Cancelling_an_operation_during_execution">Cancelling an operation during execution</a>. The continuation policy can also be used by a user at runtime to interrupt the execution of an operation:</li></ul>
<p>Furthermore, the execution of an operation can be controlled declaratively by:</p>
<ul>
<li><a href="#Targeting_a_model_to_resources">Targeting a model to resources</a>. </li>
<li><a href="#Defining_the_operations_when_a_model_is_executed">Defining the operations when a model is executed</a>.</li></ul>
<div class="section">
<h4>Defining a continuation policy to control execution on failure or error<a name="Defining_a_continuation_policy_to_control_execution_on_failure_or_error"></a></h4>
<p>The optional model <tt>continue</tt> attribute defines a <i>continuation policy</i>encountered which controls how Pineapple reacts when an error or failure occurs executing an operation.</p>
<p>The attribute supports these options for controlling the execution: </p>
<ul>
<li><b>true</b>. Execution will continue when an failure or error is encountered during execution. </li>
<li><b>false</b>. Execution is aborted when an failure or error is encountered during execution.</li></ul>
<p>If the attribute isn't defined then default value is <tt>true</tt>, i.e. continuation is enabled. </p>
<p>The <tt>continue</tt> attribute is defined on the top level element for a model file <tt>mmd:models</tt>:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; 
  continue=&quot;false&quot; &gt;

  &lt;mmd:model target-resource=&quot;ssh-node1&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;sudo yum --assumeyes install unzip&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div></div>
<div class="section">
<h4>Continuation policy behaviour in different contexts<a name="Continuation_policy_behaviour_in_different_contexts"></a></h4>
<p>There are several aspects to how the continuation policy operates (i.e. the semantics of the policy across the different model parts and execution units):</p>
<ul>
<li><a href="#Continuation_behaviour_in_a_model_file">Continuation behaviour in a model file</a>.</li>
<li><a href="#Continuation_behaviour_in_a_plugin">Continuation behaviour in a plugin</a>.</li>
<li><a href="#Continuation_behaviour_in_a_composite_model">Continuation behaviour in a composite model</a>.</li>
<li><a href="#Continuation_behaviour_in_an_agent">Continuation behaviour in an agent</a>.</li>
<li><a href="#Continuation_behaviour_in_the_agent_plugin">Continuation behaviour in the agent plugin</a>.</li></ul></div>
<div class="section">
<h4>Continuation behaviour in a model file<a name="Continuation_behaviour_in_a_model_file"></a></h4>
<p>Within a model file the attribute is global for all models. The value (defined in the <i>models</i> element) will control the execution of all models in the model file.</p>
<div class="section">
<h5>With continuation enabled<a name="With_continuation_enabled"></a></h5>
<p>If the continuation policy is set to <i>true</i>, then Pineapple will ignore any failures or errors during the execution of a model and continue with the execution in these phases:</p>
<ol style="list-style-type: decimal">
<li><i>Plugin execution:</i> Handle the failure/error within the invoked plugin as described in the paragraph: <a href="#Continuation_behaviour_in_a_plugin">Continuation behaviour in a plugin</a>.</li>
<li><i>Target resources:</i> Pineapple will continue to execute the model with the next resolved resource defined by the <i>target-resource</i> attribute as in the paragraph: <a href="#Targeting_a_model_to_resources">Targeting a model to resources</a>. </li>
<li><i>Next model execution:</i> Pineapple will start execution of the next model defined in the model file.</li></ol>
<p>Here is an example with two models (M1 and M2) targeted to one resource (R1). Despite a failure or error during execution of model M1, model M2 will be executed:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; 
  continue=&quot;true&quot; &gt;

  &lt;mmd:model target-resource=&quot;R1&quot; description=&quot;Model M1&quot; &gt;
    &lt;mmd:content&gt;
      &lt;!-- actual model content here --&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
  
  &lt;mmd:model target-resource=&quot;R1&quot; description=&quot;Model M2&quot; &gt;
    &lt;mmd:content&gt;
      &lt;!-- actual model content here --&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div>
<p>Here is an example with two models (M1 and M2) each targeted to two resources (R1, R2). Despite a failure or error during execution of model M1 when targeted to R1, model M1 targeted to R2 will be executed. And model M2 targeted to R1. And model M2 targeted to R2:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; 
  continue=&quot;true&quot; &gt;

  &lt;mmd:model target-resource=&quot;R1, R2&quot; description=&quot;Model M1&quot; &gt;
    &lt;mmd:content&gt;
      &lt;!-- actual model content here --&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
  
  &lt;mmd:model target-resource=&quot;R1, R2&quot; description=&quot;Model M2&quot; &gt;
    &lt;mmd:content&gt;
      &lt;!-- actual model content here --&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div></div>
<div class="section">
<h5>With continuation disabled<a name="With_continuation_disabled"></a></h5>
<p>If the continuation policy is set to <i>false</i>, then Pineapple will abort the execution of a model and continue through execution of these phases:</p>
<ol style="list-style-type: decimal">
<li><i>Plugin execution:</i> Handle the failure/error within the invoked plugin as described in the paragraph: <a href="#Continuation_behaviour_in_a_plugin">Continuation behaviour in a plugin</a>.</li>
<li><i>Target resources:</i> Pineapple will skip execution of the model with the next resolved resource (and any subsequent resolved resources) defined by the <i>target-resource</i> attribute.</li>
<li><i>Next model execution:</i> Pineapple will skip execution of the next model (and any subsequent models) defined in the model file.</li></ol>
<p>Here is an example with two models (M1 and M2) targeted to one resource (R1). An error during execution of model M1 will abort the execution and the execution of model M2 will never be attempted: </p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; 
  continue=&quot;false&quot; &gt;

  &lt;mmd:model target-resource=&quot;ssh-node1&quot; description=&quot;Model M1&quot; &gt;
    &lt;mmd:content&gt;
      &lt;!-- actual model content here --&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
  
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; description=&quot;Model M2&quot; &gt;
    &lt;mmd:content&gt;
      &lt;!-- actual model content here --&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div>
<p>Here is an example with two models (M1 and M2) each targeted to two resources (R1, R2). An error during execution of model M1 when targeted to R1 will abort the execution and execution is skipped for model M1 targeted to R2. And model M2 targeted to R1 is skipped. And model M2 targeted to R2 is skipped:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; 
  continue=&quot;true&quot; &gt;

  &lt;mmd:model target-resource=&quot;R1, R2&quot; description=&quot;Model M1&quot; &gt;
    &lt;mmd:content&gt;
      &lt;!-- actual model content here --&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
  
  &lt;mmd:model target-resource=&quot;R1, R2&quot; description=&quot;Model M2&quot; &gt;
    &lt;mmd:content&gt;
      &lt;!-- actual model content here --&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div></div></div>
<div class="section">
<h4>Continuation behaviour in a plugin<a name="Continuation_behaviour_in_a_plugin"></a></h4>
<p>The value (defined in the <tt>models</tt> element) should control the execution of a model but the behaviour depends on the implementation of the invoked plugin. Some plugins might continue execution despite failures/errors when invoked with a <i>test</i> operation. Other plugins might abort execution during failures/errors when invoked with a <i>deploy</i> operation if some prerequisite isn't fulfilled. </p>
<div class="section">
<h5>With continuation enabled<a name="With_continuation_enabled"></a></h5>
<p>The behaviour is individual for each plugin and depends on the invoked operation.</p>
<p>The behaviour for two plugin specifically are described since they are used to define execution flows:</p>
<ul>
<li>The behaviour for <a href="../pineapple-plugins/pineapple-composite-execution-plugin/index.html">Pineapple composite execution plugin</a> is described in the paragraph: <a href="#Continuation_behaviour_in_a_composite_model">Continuation behaviour in a composite model</a>.</li>
<li>The behaviour for <a href="../pineapple-plugins/pineapple-agent-plugin/index.html">Pineapple Agent plugin</a> is described in the paragraph: <a href="#Continuation_behaviour_in_the_agent_plugin">Continuation behaviour in the agent plugin</a>.</li></ul></div>
<div class="section">
<h5>With continuation disabled<a name="With_continuation_disabled"></a></h5>
<p>See previous paragraph.</p></div></div>
<div class="section">
<h4>Continuation behaviour in a composite model<a name="Continuation_behaviour_in_a_composite_model"></a></h4>
<p>Execution of composite models is handled by the <a href="../pineapple-plugins/pineapple-composite-execution-plugin/index.html">Pineapple composite execution plugin</a>. The behaviour of the plugin is based on the continuation policy value defined in the model file where usage of the plugin is defined. Once set the value is considered global and overrides any value set by a model in a referenced composite module. </p>
<p>Here is an example with a model (the parent). The model defines usage of a composite model with two composite modules. The composites are module C1 and C2. The continuation policy is set to <i>false</i> in the parent model. When the composite module C1 is executed then the continuation policy defined in its model is ignored. The continuation policy set in the parent model overrides the policy value defined i C1. This goes for C2 as well.</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;       
  xmlns:cep=&quot;http://pineapple.dev.java.net/ns/plugin/composite_execution_1_0&quot; 
  continue=&quot;false&quot; &gt;

    &lt;mmd:model target-resource=&quot;composite-execution&quot;&gt;
        &lt;mmd:content&gt;
          &lt;cep:composite-execution&gt;
            &lt;cep:module name=&quot;C1&quot; /&gt;
            &lt;cep:module name=&quot;C2&quot; /&gt;                         
        &lt;/cep:composite-execution&gt;                      
        &lt;/mmd:content&gt;
    &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div>
<div class="section">
<h5>With continuation enabled<a name="With_continuation_enabled"></a></h5>
<p>If the continuation policy is set to <i>true</i>, then the plugin will ignore any failures or errors and continue with the execution in these phases:</p>
<ol style="list-style-type: decimal">
<li><i>Model execution:</i> Handle the failure or error within the model as described in the paragraph: <a href="#Continuation_behaviour_in_a_model_file">Continuation behaviour in a model file</a>.</li>
<li><i>Next model execution:</i> The plugin will start execution of the model defined in the next referenced composite module.</li></ol>
<p>Here is an example with a model which defines usage of a composite model with two composite modules. The composites are module C1 and C2. Despite a failure or error during execution of the model in composite module C1, the model in composite module C2 will be executed. This will happen even if the continuation policy is set to <i>false</i> in the model in composite module C1:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;       
  xmlns:cep=&quot;http://pineapple.dev.java.net/ns/plugin/composite_execution_1_0&quot; 
  continue=&quot;true&quot; &gt;

    &lt;mmd:model target-resource=&quot;composite-execution&quot;&gt;
        &lt;mmd:content&gt;
          &lt;cep:composite-execution&gt;
            &lt;cep:module name=&quot;C1&quot; /&gt;
            &lt;cep:module name=&quot;C2&quot; /&gt;                         
        &lt;/cep:composite-execution&gt;                      
        &lt;/mmd:content&gt;
    &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div></div>
<div class="section">
<h5>With continuation disabled<a name="With_continuation_disabled"></a></h5>
<p>If the continuation policy is set to <i>false</i>, the plugin will react to failure or errors and stop the execution. The process of stopping is done through execution of these phases:</p>
<ol style="list-style-type: decimal">
<li><i>Model execution:</i> Handle the failure or error within the model as described in the paragraph: <a href="#Continuation_behaviour_in_a_model_file">Continuation behaviour in a model file</a>.</li>
<li><i>Next model execution:</i> The plugin will skip execution of the model defined in the next referenced composite module (and any subsequent composite modules) .</li></ol>
<p>Here is an example with a model which defines usage of a composite model with two composite modules. The composites are module C1 and C2. If a failure or error during execution of the model in composite module C1, then execution of the model is aborted. Execution of the module in composite module C2 is skipped. This will happen even if the continuation policy is set to <i>true</i> in the model in composite module C1:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;       
  xmlns:cep=&quot;http://pineapple.dev.java.net/ns/plugin/composite_execution_1_0&quot; 
  continue=&quot;false&quot; &gt;

    &lt;mmd:model target-resource=&quot;composite-execution&quot;&gt;
        &lt;mmd:content&gt;
          &lt;cep:composite-execution&gt;
            &lt;cep:module name=&quot;C1&quot; /&gt;
            &lt;cep:module name=&quot;C2&quot; /&gt;                         
        &lt;/cep:composite-execution&gt;                      
        &lt;/mmd:content&gt;
    &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div></div></div>
<div class="section">
<h4>Continuation behaviour in an agent<a name="Continuation_behaviour_in_an_agent"></a></h4>
<p>Invocation of an agent is done through the <a href="../pineapple-applications/pineapple-web-application/pineapple-web-application-war/usage/rest.html">Pineapple REST API</a>. When a client invokes an operation at an agent, then the continuation policy is set from the model in the invoked module. Any continuation policy set at the the client (e.g. the <a href="../pineapple-plugins/pineapple-agent-plugin/index.html">Pineapple agent plugin</a>) is ignored.</p>
<p>All errors or failures can be reported back to the client using the REST API. Clients can use this information to control the execution of its operation using the the continuation policy defined in the model in the invoked module.</p>
<div class="section">
<h5>With continuation enabled<a name="With_continuation_enabled"></a></h5>
<p>The agent implements the same continuation behaviour as <a href="#Continuation_behaviour_in_a_model_file">Continuation behaviour in a model file</a>.</p></div>
<div class="section">
<h5>With continuation disabled<a name="With_continuation_disabled"></a></h5>
<p>The agent implements the same continuation behaviour as <a href="#Continuation_behaviour_in_a_model_file">Continuation behaviour in a model file</a>.</p></div></div>
<div class="section">
<h4>Continuation behaviour in the agent plugin<a name="Continuation_behaviour_in_the_agent_plugin"></a></h4>
<p>The <a href="../pineapple-plugins/pineapple-agent-plugin/index.html">Pineapple Agent plugin</a> supports invocation of agents through the <a href="../pineapple-applications/pineapple-web-application/pineapple-web-application-war/usage/rest.html">Pineapple REST API</a>. When the agent plugin is used to invoke an agent then the continuation policy from the model isn't carried across to the agent.</p>
<p>Information about errors or failures in an agent is reported back to the agent plugin (also using the REST API). Pineapple and the agent plugin uses this information to control the continuation behaviour exactly as if it was a local execution.</p>
<div class="section">
<h5>With continuation enabled<a name="With_continuation_enabled"></a></h5>
<p>If the continuation policy is set to <i>true</i>, then the plugin will ignore any failures or errors and continue with the execution in these phases:</p>
<ol style="list-style-type: decimal">
<li><i>Agent service execution:</i> Let the agent handle the failure or error and report the result to the plugin. If an operation was invoked at the agent, it is handled by the agent as described in the paragraph: <a href="#Continuation_behaviour_in_an_agent">Continuation behaviour in an agent</a>.</li>
<li><i>Next model element execution:</i> The plugin will start execution of the next defined model element (and invoke the agent using an agent service).</li></ol></div>
<div class="section">
<h5>With continuation disabled<a name="With_continuation_disabled"></a></h5>
<p>If the continuation policy is set to <i>false</i>, the plugin will react to failure or errors and stop the execution. The process of stopping is done through execution of these phases:</p>
<ol style="list-style-type: decimal">
<li><i>Agent service execution:</i> Let the agent handle the failure or error and report the result to the plugin. If an operation was invoked at the agent, it is handled by the agent as described in the paragraph: <a href="#Continuation_behaviour_in_an_agent">Continuation behaviour in an agent</a>.</li>
<li><i>Next model element execution:</i> The plugin will skip execution of the next defined model element (and subsequent model elements).</li></ol>
<p>Here is an example with three models to illustrate the behaviour in the agent plugin and an agent. A model file contains two models M1 and M2. The first model M1 defines usage of the agent plugin to invoke an operation at an agent. The model M1 will invoke the operation <i>test</i> on module <i>ModuleAtAgent</i> at the target resource <i>TheAgent</i> (e.g. the agent). The second model M2 resides in the same model file as M1 and just do some stuff. The continuation policy for the model file which contains the models M1 and M2 is set to skip execution if an error or failure occurs:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;       
  xmlns:pap=&quot;http://pineapple.dev.java.net/ns/plugin/agent_1_0&quot; 
  continue=&quot;false&quot; &gt;

  &lt;mmd:model target-resource=&quot;TheAgent&quot; description=&quot;Model M1. Invokes Model M3 in the module ModuleAtAgent at the agent named TheAgent&quot;&gt;
    &lt;mmd:content&gt;
      &lt;pap:agent&gt;
        &lt;pap:execute-operation module=&quot;ModuleAtAgent&quot; operation&quot;test&quot; environment=&quot;E&quot; /&gt;
      &lt;/pap:agent&gt;                        
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
    
  &lt;mmd:model target-resource=&quot;R1&quot; description=&quot;Model M2&quot; &gt;
    &lt;mmd:content&gt;
      &lt;!-- actual model content here --&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
    
&lt;/mmd:models&gt;
</pre></div>
<p>At the agent a module named <i>ModuleAtAgent</i> exists. The module contains the third model M3. The continuation policy for the third model is set to skip execution if an error or failure occurs:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  continue=&quot;false&quot; &gt;

  &lt;mmd:model target-resource=&quot;AR1&quot; description=&quot;Model M3 in module ModuleAtAgent&quot; &gt;
    &lt;mmd:content&gt;
      &lt;!-- actual model content here --&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;  

&lt;/mmd:models&gt;
</pre></div>
<p>When the module is executed which contains the model file with the models M1 and M2, then execution of M1 is started. The model M1 will invoke the module name <i>ModuleAtAgent</i> with the operation <i>test</i> at the agent. This will trigger execution of model M3. If a failure or error occurs during execution of model M3, then execution of model M3 will stop since its continuation policy is set to <i>false</i>. The failure or error is reported back to the agent plugin. The runtime information for model M3 will be added to the runtime information for model M1. Execution of model M2 is skipped, because the continuation policy for model file which contains M1 and M2 is set to stop execution if an error or failure occurs.</p></div></div></div>
<div class="section">
<h3>Cancelling an operation during execution<a name="Cancelling_an_operation_during_execution"></a></h3>
<p>The is an experimental feature under development. Will be release in Pineapple 1.7+</p>
<p>The keywords are..</p>
<p>..one part of the continuation support</p>
<p>..cooperative interruption..</p>
<p>..cancellation behaviour in plugins</p>
<p>..cancellation behaviour in composite executions</p>
<p>..cancellation behaviour in agents</p>
<p>..no configurations</p></div>
<div class="section">
<h3>Variable support in modules <a name="Variable_support_in_modules"></a></h3>
<p>Variables can be declared and referenced from within a model.</p>
<div class="section">
<h4>An introductory example<a name="An_introductory_example"></a></h4>
<p>A variable can be declared in the <tt>variables</tt> section in a model:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;
  xmlns:mdl=&quot;http://pineapple.dev.java.net/ns/module_1_0&quot; 
  xmlns:itp=&quot;http://pineapple.dev.java.net/ns/plugin/infrastructure_1_0&quot; &gt;
  &lt;mmd:variables&gt;
    &lt;mmd:variable key=&quot;host&quot; value=&quot;10.15.100.20&quot; /&gt;
  &lt;/mmd:variables&gt;
  &lt;mmd:model target-resource=&quot;infrastructure-test&quot;&gt;
    &lt;mmd:content&gt;
      &lt;itp:infrastructure&gt;
        &lt;itp:tcp-connection-test host=&quot;${host}&quot; description=&quot;WebLogic Adm Server:7001,7091&quot;&gt;
          &lt;itp:port value=&quot;7001&quot; /&gt;                                     
          &lt;itp:port value=&quot;7091&quot; /&gt;
        &lt;/itp:tcp-connection-test&gt;
      &lt;/itp:infrastructure&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div>
<p>A variable is declared with a key and a value:</p>
<div class="source">
<pre>  &lt;mmd:variable key=&quot;host&quot; value=&quot;10.15.100.20&quot; /&gt;
</pre></div>
<p>The variable can then be reference from any plugin model elements. This will all sub elements of the <tt>content</tt> element which are those bound to the schema of a particular plugin. The variable is referenced using the syntax: <tt>${key}</tt>, where <i>key</i> should match the key of a defined variable. Here is the variable with the key <i>host</i> is referenced:</p>
<div class="source">
<pre> &lt;itp:tcp-connection-test host=&quot;${host}&quot; description=&quot;WebLogic Adm Server:7001,7091&quot;&gt;
</pre></div></div>
<div class="section">
<h4>Declaration of variables<a name="Declaration_of_variables"></a></h4>
<p>Variables can be declared at different levels:</p>
<ul>
<li><b>At the module level</b>. The (optional) module descriptor <tt>module.xml</tt> located at the root of the module directory supports declaration of variables. A <tt>variables</tt> section can be defined in the module descriptor where variables can be defined. A variable declared in the module descriptor is available in all models within the module. </li>
<li><b>At the model level</b>. Variables can be defined in each model in a module. A <tt>variables</tt> section can be defined in a model where variables can be defined. A variable declared in a model is available within the model alone.</li>
<li><b>At the resource level</b>. Resources support definition of properties. A property defined on a resource is also a variable declaration. A variable declared as a resource property is only available when the model is targeted to the particular resource. </li></ul>
<div class="section">
<h5>Declaration of a variable in the module descriptor<a name="Declaration_of_a_variable_in_the_module_descriptor"></a></h5>
<p>The module descriptor supports definition of a <tt>variables</tt> section where variables can be defined:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;module xmlns=&quot;http://pineapple.dev.java.net/ns/module_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_1_0 
                      http://pineapple.dev.java.net/ns/module_1_0.xsd&quot;
                       
  id=&quot;my-first-module&quot; 
  version=&quot;1.0.0&quot; &gt;
    &lt;variables&gt;
      &lt;variable key=&quot;host&quot; value=&quot;10.33.33.33&quot; /&gt;
    &lt;/variables&gt;
  &lt;/module&gt;
</pre></div>
<p>A variable is declared with a key and a value:</p>
<div class="source">
<pre>  &lt;variable key=&quot;host&quot; value=&quot;10.33.33.33&quot; /&gt;
</pre></div></div>
<div class="section">
<h5>Declaration of a variable in a model<a name="Declaration_of_a_variable_in_a_model"></a></h5>
<p>A model supports definition of a <tt>variables</tt> section where variables can be defined:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;
  xmlns:mdl=&quot;http://pineapple.dev.java.net/ns/module_1_0&quot; 
  xmlns:itp=&quot;http://pineapple.dev.java.net/ns/plugin/infrastructure_1_0&quot; &gt;
  &lt;mmd:variables&gt;
    &lt;mmd:variable key=&quot;host&quot; value=&quot;10.22.22.22&quot; /&gt;
  &lt;/mmd:variables&gt;
  
  &lt;!-- more stuff here --&gt;
  
&lt;/mmd:models&gt;
</pre></div>
<p>A variable is declared with a key and a value:</p>
<div class="source">
<pre>  &lt;variable key=&quot;host&quot; value=&quot;10.22.22.22&quot; /&gt;
</pre></div></div>
<div class="section">
<h5>Declaration of a variable as a resource property<a name="Declaration_of_a_variable_as_a_resource_property"></a></h5>
<p>A resource defined in the environment configuration supports definition of properties:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration xmlns=&quot;http://pineapple.dev.java.net/ns/environment_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/environment_1_0 
                      http://pineapple.dev.java.net/ns/environment_1_0.xsd&quot;&gt;
 
  &lt;environments&gt;
    &lt;environment id=&quot;local-development&quot; description=&quot;my local development environment&quot; &gt;
      &lt;resources&gt;
        &lt;resource id=&quot;weblogic-deployment&quot; 
                  credential-id-ref=&quot;weblogic-deployment-credential&quot; 
                  plugin-id=&quot;com.alpha.pineapple.plugin.weblogic.deployment&quot; &gt;
                        &lt;property key=&quot;adminserver-protocol&quot; value=&quot;t3&quot; /&gt;
                        &lt;property key=&quot;adminserver-listenaddress&quot; value=&quot;127.0.0.1&quot; /&gt;
                        &lt;property key=&quot;adminserver-listenport&quot; value=&quot;7001&quot; /&gt;
       &lt;/resource&gt;              
      &lt;resources&gt;      
    &lt;/environment&gt;    
  &lt;/environments&gt;  
&lt;/configuration&gt; 
</pre></div>
<p>A property is declared with a key and a value in the same way as variables are defined in the module descriptor and models:</p>
<div class="source">
<pre>  &lt;property key=&quot;adminserver-protocol&quot; value=&quot;t3&quot; /&gt;
</pre></div></div></div>
<div class="section">
<h4>Referencing variables in models<a name="Referencing_variables_in_models"></a></h4>
<div class="section">
<h5>Syntax for referencing a variable<a name="Syntax_for_referencing_a_variable"></a></h5>
<p>A variable is referenced from a model using the syntax: <tt>${key}</tt> where <tt>key</tt> must match the key of a defined variable.</p></div>
<div class="section">
<h5>Unmatched references are ignored<a name="Unmatched_references_are_ignored"></a></h5>
<p>If a referenced variable can't resolved, i.e. no match is found amoung the set of defined variables, then the reference is ignored because it can mean one of two things:</p>
<ul>
<li>It's an error that it isn't resolved.</li>
<li>The expression serves another purpose in the plugin model.</li></ul></div>
<div class="section">
<h5>Support for forced resolution <a name="Support_for_forced_resolution"></a></h5>
<p>Resolution can be forced to a particular definition by adding a prefix to the variable reference: </p>
<ul>
<li><tt>${module.key}</tt> only attempts to resolve the variable named <tt>key</tt> from the variables defined in the module descriptor.</li>
<li><tt>${model.key}</tt> only attempts to resolve the variable named <tt>key</tt> from the variables defined in the model.</li>
<li><tt>${resource.key}</tt> only attempts to resolve the variable named <tt>key</tt> from the properties of the targeted resource.</li></ul></div>
<div class="section">
<h5>Variables can be referenced from plugin specfic models <a name="Variables_can_be_referenced_from_plugin_specfic_models"></a></h5>
<p>Variables can be referenced in plugin specific models, i.e all the elements below the <tt>&lt;content&gt;</tt> elements in a model. </p>
<p>Below is a model which consists of two plugin specific models. The first model uses the SSH plugin (the elements prefixed with <tt>shp</tt>). The second model uses the Agent plugin (the elements prefixed with <tt>pap</tt>). References to variables are supported in all elements prefixed with <tt>shp</tt> and <tt>pap</tt>:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xmlns:pap=&quot;http://pineapple.dev.java.net/ns/plugin/agent_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;
  &lt;mmd:variables&gt;
    &lt;variable key=&quot;yum-install-command&quot; value=&quot;sudo yum --assumeyes install&quot; /&gt;  
    &lt;variable key=&quot;remote-environment&quot; value=&quot;local&quot; /&gt;  
    &lt;variable key=&quot;remote-operation&quot; value=&quot;test&quot; /&gt;          
  &lt;/mmd:variables&gt;  
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;${yum-install-command} unzip&quot; /&gt;
        &lt;shp:execute command=&quot;${yum-install-command} chkconfig&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
  &lt;mmd:model target-resource=&quot;agent-node1&quot; &gt;
    &lt;mmd:content&gt;  
      &lt;pap:agent&gt;
        &lt;pap:distribute-and-execute-operation module=&quot;my-testsuite&quot; environment=&quot;${remote-environment}&quot; operation=&quot;${remote-operation}&quot; /&gt;
      &lt;/pap:agent&gt;                      
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;                  
&lt;/mmd:models&gt;
</pre></div></div>
<div class="section">
<h5>Variables aren't supported in the module model schema<a name="Variables_arent_supported_in_the_module_model_schema"></a></h5>
<p>References to variables aren't supported in the elements defined by the module model schema, i.e. the elements prefixed by <tt>mmd</tt> in the model below. The variable reference <tt>${agent-node}</tt> in the <tt>target-resource</tt> attribute will not be resolved:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:pap=&quot;http://pineapple.dev.java.net/ns/plugin/agent_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;
  &lt;mmd:variables&gt;
    &lt;variable key=&quot;agent-node&quot; value=&quot;agent-node1&quot; /&gt;  
    &lt;variable key=&quot;remote-environment&quot; value=&quot;local&quot; /&gt;  
    &lt;variable key=&quot;remote-operation&quot; value=&quot;test&quot; /&gt;          
  &lt;/mmd:variables&gt;  
  &lt;mmd:model target-resource=&quot;${agent-node}&quot; &gt;
    &lt;mmd:content&gt;  
      &lt;pap:agent&gt;
        &lt;pap:distribute-and-execute-operation module=&quot;my-testsuite&quot; environment=&quot;${remote-environment}&quot; operation=&quot;${remote-operation}&quot; /&gt;
      &lt;/pap:agent&gt;                      
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;                  
&lt;/mmd:models&gt;
</pre></div></div></div>
<div class="section">
<h4>Resolution of variables<a name="Resolution_of_variables"></a></h4>
<p>The value of a variable is resolved using the algorithm:</p>
<ul>
<li>If <b>forced variable reference</b>: If the variable reference is prefixed with either a <i>module:</i>, <i>model:</i> or <i>resource:</i> prefix then attempt to resolve the value from the targeted set of variables. If the variable isn't defined in the targeted set then ignore the variable reference and quit the resolution.</li>
<li>Resolve at <b>resource level</b>: If the variable is declared at resource level then value is resolved to this value. </li>
<li>Resolve at <b>model level</b>: If the variable is declared at model level then value is resolved to this value.</li>
<li>Resolve at <b>module level</b>: If the variable is declared at module level then value is resolved to this value.</li>
<li><b>Ignore undeclared variables</b>: If the variable isn't found to be declared then the variable reference is ignored. </li></ul>
<p>Example 1: If a variable named <i>dave</i> is defined at the model level with value <i>10</i> and at the module level with the value <i>20</i> then the <i>dave</i> variable will be resolved to the value <i>10</i>.</p>
<p>Example 2: If a variable named <i>jill</i> is defined as resource property with value <i>10</i> and at the module level with the value <i>20</i> then the <i>jill</i> variable will be resolved to the value <i>10</i>.</p>
<p>Example 3: If the variable named <i>jim</i> isn't defined, but referenced from a model with <tt>${jim}</tt> then the variable isn't resolved and the model will contain the expression <tt>${jim}</tt> when it is processed by the targeted plugin. This can make perfect sense if this type of expression make sense within the domain of the targeted plugin, e.g. shell scripts. </p></div>
<div class="section">
<h4>Regarding resolution of variables at runtime<a name="Regarding_resolution_of_variables_at_runtime"></a></h4>
<p>Variables are resolved after the target resource have been resolved to be able to support variables defined as resource properties.</p>
<p>Since a model can be targeted to multiple resources, either using a list or a regular expression, then the variables are re-resolved for each targeted resource to be able to support variables defined as resource properties.</p></div>
<div class="section">
<h4>Regarding resource properties<a name="Regarding_resource_properties"></a></h4>
<p>Special care must be taken when resource properties are used.</p>
<p>When a variable is defined in the module descriptor or in a model then the variable will be defined for all targeted resources.</p>
<p>If a variable is defined as a resource property then the variable will only be available for that particular resource. One must keep this this in mind to avoid errors when using variables which are resolved from resource properties. </p>
<p>Here's an example to illustrate the case:</p>
<ul>
<li>A module is defined, with a single model.</li>
<li>Within the model a plugin specfic model is defined which uses the Agent plugin. The model should be targeted to three target nodes named <tt>agent-node1</tt>, <tt>agent-node2</tt> and <tt>agent-node3</tt>. This is defined in the model using a list expression for the <tt>target-resource</tt> attribute.</li>
<li>A variable named <tt>${mymodule}</tt> is referenced from the model. The variable should be defined as a resource property. </li></ul>
<p>The model looks like:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:pap=&quot;http://pineapple.dev.java.net/ns/plugin/agent_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;
  &lt;mmd:variables /&gt;
  &lt;mmd:model target-resource=&quot;{agent-node1, agent-node2, agent-node3}&quot; &gt;
    &lt;mmd:content&gt;  
      &lt;pap:agent&gt;
        &lt;pap:distribute-and-execute-operation module=&quot;${mymodule}&quot; environment=&quot;local&quot; operation=&quot;test&quot; /&gt;
      &lt;/pap:agent&gt;                      
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;                  
&lt;/mmd:models&gt;
</pre></div>
<p>To support resolution of the <tt>${mymodule}</tt> variable from resource properties, then the variable must be defined on alle three targeted resource properties for the resolution to succeed. If it is only defined on one, e.g. <tt>agent-node1</tt> then the value can be resolved when the model is targeted to that resource. For the other two resources the variable resolution will fail, and the <tt>${mymodule}</tt> expression will be passed on when the model is executed by the Agent plugin. </p></div></div>
<div class="section">
<h3>Trigger support in modules <a name="Trigger_support_in_modules"></a></h3>
<p>Triggers can be declared for a plugin specific model and they are executed after a plugin specific model have been targeted to a resource.</p>
<div class="section">
<h4>An introductory example<a name="An_introductory_example"></a></h4>
<p>A trigger can be declared in the <tt>model</tt> section of a model file:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;
  xmlns:mdl=&quot;http://pineapple.dev.java.net/ns/module_1_0&quot; 
  xmlns:itp=&quot;http://pineapple.dev.java.net/ns/plugin/infrastructure_1_0&quot; &gt;
  &lt;mmd:model target-resource=&quot;infrastructure-test&quot;&gt;
    &lt;mmd:content&gt;
      &lt;itp:infrastructure&gt;
        &lt;itp:tcp-connection-test host=&quot;10.15.100.20&quot; description=&quot;WebLogic Adm Server:7001,7091&quot;&gt;
          &lt;itp:port value=&quot;7001&quot; /&gt;                                     
          &lt;itp:port value=&quot;7091&quot; /&gt;
        &lt;/itp:tcp-connection-test&gt;
      &lt;/itp:infrastructure&gt;
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;failure&quot; module=&quot;restart-weblogic&quot; environment=&quot;local&quot; operation=&quot;deploy-configuration&quot; /&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div>
<p>A trigger is declared with two directives. The directives determine if the trigger should be executed. The two directive are named <tt>on-target-operation</tt> and <tt>on-result</tt>:</p>
<div class="source">
<pre>  &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;failure&quot; ... /&gt;
</pre></div>
<p>If evaluation of the directives determines that the trigger should be executed then the remaining attributes declares another module which is invoked:</p>
<div class="source">
<pre>  &lt;mmd:trigger ... module=&quot;restart-weblogic&quot; environment=&quot;local&quot; operation=&quot;deploy&quot; /&gt;
</pre></div></div>
<div class="section">
<h4>Declaration of triggers<a name="Declaration_of_triggers"></a></h4>
<p>A trigger can be declared as part of a plugin specific model in a model file. A trigger is defined within the <i>model</i> element:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;
  xmlns:mdl=&quot;http://pineapple.dev.java.net/ns/module_1_0&quot; 
  xmlns:itp=&quot;http://pineapple.dev.java.net/ns/plugin/infrastructure_1_0&quot; &gt;
  &lt;mmd:model target-resource=&quot;infrastructure-test&quot;&gt;
    &lt;mmd:content&gt;
      ...
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;failure&quot; module=&quot;activate-something&quot; environment=&quot;local&quot; operation=&quot;deploy-configuration&quot; /&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div>
<p>Declaration of a trigger consists of two parts:</p>
<ul>
<li><b>Trigger directives</b>. The directives controls whether a trigger should be executed.</li>
<li><b>Target module</b>. Definition of the module which is invoked when the trigger is executed.</li></ul>
<div class="section">
<h5>Trigger directives<a name="Trigger_directives"></a></h5>
<p>The two trigger directives are:</p>
<ul>
<li>The <tt>on-target-operation</tt> is an optional directive. The directive is resolved against the operation used to invoke the model file.</li>
<li>The <tt>on-result</tt> is a optional directive. The directive is resolved against the execution result generated when the plugin specific model (containing the trigger) is targeted to a resource.</li></ul></div>
<div class="section">
<h5>The operation directive <a name="The_operation_directive"></a></h5>
<p>The <tt>on-target-operation</tt> attribute supports three options for defining the condition for the trigger to run:</p>
<ul>
<li><b>* (The wildcard identifier)</b>. The trigger is executed for any operation. This is the default value.</li>
<li><b>Single operation</b>. The trigger is only executed when the operation name defined by the attribute value is identical to the invoked operation.</li>
<li><b>List</b>. Multiple operations can be defined using a list notation. The value enclosed by { } is interpreted as a comma-separated list and the trigger is executed if the invoked operation matches one of the names in the list. </li></ul>
<p>The directive is optional. If the directive isn't defined or is empty then it is interpreted as the default value (the wildcard identifier). </p>
<p>Example illustrating the configuration options. As mentioned above, the trigger resolution is based on an AND-based resolution of both directives. The value of the other directive, <tt>on-result</tt>, isn't defined which corresponds to its wildcard value:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;

  &lt;!-- will only execute trigger when module is invoked with the &quot;deploy-configuration&quot; operation --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;deploy-configuration&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;mkdir stuff&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-target-operation=&quot;deploy-configuration&quot; module=&quot;trigger-module-1&quot; environment=&quot;alpha&quot; operation=&quot;test&quot; /&gt;    
  &lt;/mmd:model&gt;

  &lt;!-- will only execute trigger when module is invoked with the &quot;undeploy-configuration&quot; operation --&gt;  
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;undeploy-configuration&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;rm -rf stuff&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-target-operation=&quot;undeploy-configuration&quot; module=&quot;trigger-module-2&quot; environment=&quot;alpha&quot; operation=&quot;test&quot; /&gt;        
  &lt;/mmd:model&gt;  

  &lt;!-- will execute trigger when module is invoked with either the &quot;undeploy-configuration&quot; or the &quot;deploy-configuration&quot; operation --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;{deploy-configuration, undeploy-configuration}&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;!-- more stuff here --&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-target-operation=&quot;{deploy-configuration, undeploy-configuration}&quot; module=&quot;trigger-module-3&quot; environment=&quot;alpha&quot; operation=&quot;test&quot; /&gt;            
  &lt;/mmd:model&gt;  

  &lt;!-- will execute trigger when module is invoked with any operation --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;*&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;!-- more stuff here --&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-target-operation=&quot;*&quot; module=&quot;trigger-module-4&quot; environment=&quot;alpha&quot; operation=&quot;test&quot; /&gt;                
  &lt;/mmd:model&gt;  

  &lt;!-- operation directive isn't defined,
      defaults to the wild card identifier. Will execute trigger when module is invoked with any operation --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;*&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;!-- more stuff here --&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
    &lt;mmd:trigger module=&quot;trigger-module-4&quot; environment=&quot;alpha&quot; operation=&quot;test&quot; /&gt;                
  &lt;/mmd:model&gt;  

&lt;/mmd:models&gt;
</pre></div></div>
<div class="section">
<h5>The result directive <a name="The_result_directive"></a></h5>
<p>The <tt>on-result</tt> attribute supports three options for defining when the condition for the trigger to run:</p>
<ul>
<li><b>* (The wildcard identifier)</b>. The trigger is executed for any execution result generated when the plugin specific model (containing the trigger) is targeted to a resource. This is the default value.</li>
<li><b>Single result</b>. The trigger is only executed when the execution result defined by the attribute value is identical to the execution result generated from the plugin specific model. </li>
<li><b>List</b>. Multiple results can be defined the using a list notation. The value enclosed by { } is interpreted as a comma-separated list and the trigger is executed if the execution result, generated from the plugin specific model, matches one of the names in the list. </li></ul>
<p>The directive is optional. If the directive isn't defined or is empty then it is interpreted as the default value (the wildcard identifier). </p>
<p>Example illustrating the configuration options. As mentioned above, the trigger resolution is based on an AND-based resolution of both directives. The value of the other directive, <tt>on-target-operation</tt>, is set to its wildcard value in the example.</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:shp=&quot;http://pineapple.dev.java.net/ns/plugin/ssh_1_0&quot;
  xsi:schemaLocation=&quot;http://pineapple.dev.java.net/ns/module_model_1_0 
                      http://pineapple.dev.java.net/ns/module_model_1_0.xsd&quot; &gt;

  &lt;!-- will only execute trigger when model execution result was a success --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;deploy-configuration&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;mkdir stuff&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-result=&quot;success&quot; module=&quot;trigger-module-1&quot; environment=&quot;alpha&quot; operation=&quot;test&quot; /&gt;    
  &lt;/mmd:model&gt;

  &lt;!-- will only execute trigger when model execution result was an error --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;undeploy-configuration&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;shp:execute command=&quot;rm -rf stuff&quot; /&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-result=&quot;Error&quot; module=&quot;trigger-module-2&quot; environment=&quot;alpha&quot; operation=&quot;test&quot; /&gt;        
  &lt;/mmd:model&gt;  

  &lt;!-- will execute trigger when model execution result is either &quot;failure&quot; or &quot;error&quot; --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;{deploy-configuration, undeploy-configuration}&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;!-- more stuff here --&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-result=&quot;{failure, error}&quot; module=&quot;trigger-module-3&quot; environment=&quot;alpha&quot; operation=&quot;test&quot; /&gt;            
  &lt;/mmd:model&gt;  

  &lt;!-- will execute trigger whatever the when model execution result is --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;*&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;!-- more stuff here --&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-result=&quot;*&quot; module=&quot;trigger-module-4&quot; environment=&quot;alpha&quot; operation=&quot;test&quot; /&gt;                
  &lt;/mmd:model&gt;  

  &lt;!-- result directive isn't defined,
      defaults to the wild card identifier. Will execute trigger whatever the model execution result is --&gt;
  &lt;mmd:model target-resource=&quot;ssh-node1&quot; target-operation=&quot;*&quot; &gt;
    &lt;mmd:content&gt;
      &lt;shp:ssh&gt;
        &lt;!-- more stuff here --&gt;
      &lt;/shp:ssh&gt;
    &lt;/mmd:content&gt;
    &lt;mmd:trigger module=&quot;trigger-module-4&quot; environment=&quot;alpha&quot; operation=&quot;test&quot; /&gt;                
  &lt;/mmd:model&gt;  

&lt;/mmd:models&gt;
</pre></div></div>
<div class="section">
<h5>Target module <a name="Target_module"></a></h5>
<p>The only action supported by a trigger is the invocation of another module. For this purpose the remaining mandatory attributes in the trigger defines the target module, environment and the operation to invoke:</p>
<div class="source">
<pre>  &lt;mmd:trigger module=&quot;activate-something&quot; environment=&quot;local&quot; operation=&quot;deploy-configuration&quot; /&gt;
</pre></div>
<p>To support execution of multiple modules, either define multiple triggers or define the target module to use the composite execution plugin.</p>
<p>TODO: make environment optional. inherit.</p>
<p>TODO: make operation optional. inherit.</p></div>
<div class="section">
<h5>Multiple triggers can be declared for a plugin specific model<a name="Multiple_triggers_can_be_declared_for_a_plugin_specific_model"></a></h5>
<p>Any number of triggers can be defined for a plugin specific model:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;
  xmlns:mdl=&quot;http://pineapple.dev.java.net/ns/module_1_0&quot; 
  xmlns:itp=&quot;http://pineapple.dev.java.net/ns/plugin/infrastructure_1_0&quot; &gt;
  &lt;mmd:model target-resource=&quot;infrastructure-test&quot;&gt;
    &lt;mmd:content&gt;
      ...
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;success&quot; module=&quot;report-something&quot; environment=&quot;local&quot; operation=&quot;deploy&quot; /&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;failure&quot; module=&quot;activate-something&quot; environment=&quot;local&quot; operation=&quot;deploy&quot; /&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;error&quot; module=&quot;activate-something&quot; environment=&quot;local&quot; operation=&quot;deploy&quot; /&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;error&quot; module=&quot;report-something-else&quot; environment=&quot;local&quot; operation=&quot;deploy&quot; /&gt;    
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div>
<p>.. ordering of triggers???</p></div>
<div class="section">
<h5>A trigger is local a to plugin specific model<a name="A_trigger_is_local_a_to_plugin_specific_model"></a></h5>
<p>A trigger is local to the plugin specific model. If a model file contains multiple plugin specific models then triggers must be declared for each plugin specific model. Triggers can't be declared globally within a model file and neither can they be referenced:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;mmd:models xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;
  xmlns:mdl=&quot;http://pineapple.dev.java.net/ns/module_1_0&quot; 
  xmlns:itp=&quot;http://pineapple.dev.java.net/ns/plugin/infrastructure_1_0&quot; &gt;
  &lt;mmd:model target-resource=&quot;infrastructure-test&quot;&gt;
    &lt;mmd:content&gt;
      ...
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;success&quot; module=&quot;report-something&quot; environment=&quot;local&quot; operation=&quot;deploy&quot; /&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;failure&quot; module=&quot;activate-something&quot; environment=&quot;local&quot; operation=&quot;deploy&quot; /&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;error&quot; module=&quot;activate-something&quot; environment=&quot;local&quot; operation=&quot;deploy&quot; /&gt;
  &lt;/mmd:model&gt;
  
  &lt;mmd:model target-resource=&quot;infrastructure-test&quot;&gt;
    &lt;mmd:content&gt;
      ...
    &lt;/mmd:content&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;success&quot; module=&quot;report-something&quot; environment=&quot;local&quot; operation=&quot;deploy&quot; /&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;failure&quot; module=&quot;activate-something&quot; environment=&quot;local&quot; operation=&quot;deploy&quot; /&gt;
    &lt;mmd:trigger on-target-operation=&quot;test&quot; on-result=&quot;error&quot; module=&quot;activate-something&quot; environment=&quot;local&quot; operation=&quot;deploy&quot; /&gt;
  &lt;/mmd:model&gt;
  
&lt;/mmd:models&gt;
</pre></div></div></div>
<div class="section">
<h4>Resolution of triggers<a name="Resolution_of_triggers"></a></h4>
<p>The two directives has a different set of rules. The directives are resolved using a logical AND. For a trigger to execute, both directives must resolve the trigger for execution.</p>
<p>The rules used to resolve whether a trigger should run:</p>
<ol style="list-style-type: decimal">
<li>The value of the <tt>on-target-operation</tt> attribute is null.</li>
<li>The value of the <tt>on-target-operation</tt> attribute is empty.</li>
<li>The value of the <tt>on-target-operation</tt> attribute is the wildcard value &quot;*&quot;.</li>
<li>The value of the <tt>on-target-operation</tt> attribute is identical to the operation that the model was invoked with.</li>
<li>The value of the <tt>on-target-operation</tt> attribute is a list value and one of the values in the list is identical to the operation that the model was invoked with.</li></ol>
<p><b>and</b>:</p>
<ol style="list-style-type: decimal">
<li>The value of the <tt>on-result </tt> attribute is null.</li>
<li>The value of the <tt>on-result </tt> attribute is empty.</li>
<li>The value of the <tt>on-result</tt> attribute is the wildcard value &quot;*&quot;</li>
<li>The value of the <tt>on-result</tt> attribute is identical to the result that the execution of the plugin specific model concluded with.</li>
<li>The value of the <tt>on-result</tt> attribute is a list value and one of the values in the list is identical to the result that execution of the plugin specific model concluded with.</li></ol></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2017.
          All Rights Reserved.      
                    
      </div>

                          
        
                </div>
    </footer>
  </body>
</html>
