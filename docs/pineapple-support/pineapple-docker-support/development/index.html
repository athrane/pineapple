<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 13 Apr 2017
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Allan Thrane Andersen" />
    <meta name="Date-Revision-yyyymmdd" content="20170413" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Pineapple Docker support - Development documentation</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Pineapple Docker support</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="../../../index.html" title="Pineapple Home">
        Pineapple Home</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href="../../" title="Pineapple support projects">
        Pineapple support projects</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href="../" title="Pineapple Docker support">
        Pineapple Docker support</a>
        </li>
      <li class="divider ">/</li>
        <li class="">Development documentation</li>
        
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 13 Apr 2017</li> 
            
                            </ul>
      </div>

                  
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Project Overview</li>
                                
      <li>
    
                          <a href="../../../index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/installation.html" title="Installation">
          <i class="none"></i>
        Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/index.html" title="For Users">
          <i class="none"></i>
        For Users</a>
            </li>
                  
      <li>
    
                          <a href="../../../development/index.html" title="For Developers">
          <i class="none"></i>
        For Developers</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/terms.html" title="Terms and Conditions">
          <i class="none"></i>
        Terms and Conditions</a>
            </li>
                              <li class="nav-header">Clients</li>
                                
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-web-application/pineapple-standalone-web-client/index.html" title="Standalone Web Application">
          <i class="none"></i>
        Standalone Web Application</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-web-application/pineapple-web-application-war/index.html" title="Deployable Web Application">
          <i class="none"></i>
        Deployable Web Application</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-maven-plugin/index.html" title="Maven Plugin">
          <i class="none"></i>
        Maven Plugin</a>
            </li>
                              <li class="nav-header">Plugins</li>
                                
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-agent-plugin/index.html" title="Agent">
          <i class="none"></i>
        Agent</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-composite-execution-plugin/index.html" title="Composite Execution">
          <i class="none"></i>
        Composite Execution</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-ssh-plugin/index.html" title="SSH">
          <i class="none"></i>
        SSH</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-docker-plugin/index.html" title="Docker">
          <i class="none"></i>
        Docker</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-infrastructure-test-plugin/index.html" title="Infrastructure Test">
          <i class="none"></i>
        Infrastructure Test</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-jrockit-installation-plugin/index.html" title="JRockit Installation">
          <i class="none"></i>
        JRockit Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-fusion-middleware-installation-plugin/index.html" title="Fusion Middleware Installation">
          <i class="none"></i>
        Fusion Middleware Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-weblogic-installation-plugin/index.html" title="WebLogic Installation">
          <i class="none"></i>
        WebLogic Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-weblogic-deployment-plugin/index.html" title="WebLogic Deployment">
          <i class="none"></i>
        WebLogic Deployment</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-weblogic-scripting-tool-plugin/index.html" title="WebLogic Scripting Tool (WLST)">
          <i class="none"></i>
        WebLogic Scripting Tool (WLST)</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-weblogic-jmx-plugin/index.html" title="WebLogic JMX">
          <i class="none"></i>
        WebLogic JMX</a>
            </li>
                              <li class="nav-header">API's</li>
                                
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-web-application/pineapple-web-application-war/usage/rest.html" title="REST">
          <i class="none"></i>
        REST</a>
            </li>
                  
      <li>
    
                          <a href="../../../development/plugin-framework.html" title="Plugin Framework">
          <i class="none"></i>
        Plugin Framework</a>
            </li>
                              <li class="nav-header">Additional Information</li>
                                
      <li>
    
                          <a href="http://pineapplesoftware.blogspot.com" class="externalLink" title="The Pineapple Project Blog">
          <i class="none"></i>
        The Pineapple Project Blog</a>
            </li>
                  
      <li>
    
                          <a href="http://exceptiontrail.blogspot.com" class="externalLink" title="Pineapple Exception Trail Blog">
          <i class="none"></i>
        Pineapple Exception Trail Blog</a>
            </li>
                              <li class="nav-header">Project Tools</li>
                                
      <li>
    
                          <a href="https://bintray.com/pineapple/maven/com.alpha.pineapple" class="externalLink" title="Downloads">
          <i class="none"></i>
        Downloads</a>
            </li>
                  
      <li>
    
                          <a href="https://github.com/athrane/pineapple" class="externalLink" title="Source Code">
          <i class="none"></i>
        Source Code</a>
            </li>
                  
      <li>
    
                          <a href="https://github.com/athrane/pineapple/issues" class="externalLink" title="Issue Tracker">
          <i class="none"></i>
        Issue Tracker</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                        
      <li>
    
                          <a href="../project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="https://pineapple.java.net" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                        
        <div id="bodyColumn"  class="span10" >
                                  
            <!-- NOTE: For help with the syntax of this file, see: --><!-- http://maven.apache.org/guides/mini/guide-apt-format.html --><div class="section">
<h2>Development documentation<a name="Development_documentation"></a></h2>
<div class="section">
<h3>Schema location<a name="Schema_location"></a></h3>
<p>The schema is located in the folder: <tt>src/main/resources.</tt></p>
<div class="section">
<h4>Adding the schemas to the main project web site<a name="Adding_the_schemas_to_the_main_project_web_site"></a></h4>
<p>During the <tt>site</tt> phase the schema is copied to the main site in the <tt>pineapple-project</tt>. The schema is copied to the directory: <tt>/ns/support</tt>.</p>
<p>This is implemented in the <tt>pom.xml</tt> for the <tt>pineapple-docker-suppor</tt> project. </p></div></div>
<div class="section">
<h3>Generation of classes from XML schemas<a name="Generation_of_classes_from_XML_schemas"></a></h3>
<p>The project uses JABX through the Maven 2 plugin <tt>maven-jaxb2-plugin</tt> to generate classes from XML schemas. </p>
<div class="section">
<h4>Customized package names<a name="Customized_package_names"></a></h4>
<p>The generated classes are mapping into the package <tt>com.alpha.pineapple.docker.model.rest</tt> using the JAXB bindings file at: <tt>src/main/resources/bindings.xjb</tt>.</p></div>
<div class="section">
<h4>Customized type names<a name="Customized_type_names"></a></h4>
<p>The JAXB bindings file also defines mappings of Schema type into Java types. The applied rule is to remove the postfixed <tt>Type</tt> from the Schema type in the corresponding Java types, i.e. from the schema type named <tt>NiceType</tt> a Java type named <tt>Nice</tt> is generated by JAXB. </p></div>
<div class="section">
<h4>Schema types <a name="Schema_types"></a></h4>
<p>The schema contains these types for handling images</p>
<ul>
<li><tt>listedImageType</tt> - Info about a listed Docker image (Output from listing images).</li>
<li><tt>imageCreationType</tt> - Info about Docker image creation progress.</li>
<li><tt>imageDeletionType</tt> - Info about Docker image deletion progress.</li>
<li><tt>progressDetailType</tt> - Detailed info about progress during image creation (Partial output from image creation).</li>
<li><tt>errorDetailType</tt> - Detailed info about errors during image creation (Partial output from image creation).</li></ul>
<p>The schema contains these types for handling container</p>
<ul>
<li><tt>containerConfigurationType</tt> - Docker container configuration (Input to container creation and output from container inspection).</li>
<li><tt>containerConfigurationExposedPortType</tt> - Docker container configuration of a single exposed port (Input to container creation and output from container inspection). The JSON marshalled from this type when the Docker REST API is invoked requires a map with values with the format: <tt>{ &quot;&lt;port&gt;/&lt;tcp|udp&gt;: {}&quot; }</tt>. To support this requirement the exposed port type defines a port (the port/protocol part) and a null value (the {} part). To generate the null object for the value the <tt>containerConfigurationExposedPortNullValueType</tt> is used.</li>
<li><tt>containerConfigurationExposedPortNullValueType</tt> - Null value for export port (Input to container creation and output from container inspection).</li>
<li><tt>containerConfigurationExposedPortsType</tt> - Docker container configuration of a map of exposed ports (Input to container creation and output from container inspection). Each port is defined using the <tt>containerConfigurationExposedPortType</tt>. During marshalling the type is bound to the map <tt>ContainerConfigurationExposedPortsMap</tt> using the <tt>ContainerConfigurationExposedPortsMapAdapter</tt>.</li>
<li><tt>containerConfigurationLabelType</tt> - Docker container configuration of a label (Input to container creation, output from container inspection and listing of containers). The JSON marshalled from this type when the Docker REST API is invoked requires a map with values with the format: <tt>{ string : string }</tt>. To support this requirement the label type defines a key and value </li>
<li><tt>containerConfigurationLabelsType</tt> - Docker container configuration of a map of labels (Input to container creation, output from container inspection and listing of containers). Each label is defined using the <tt>containerConfigurationLabelType</tt>. During marshalling the type is bound to the map <tt>ContainerConfigurationLabelsMap</tt> using the <tt>ContainerConfigurationLabelsMapAdapter</tt>.</li>
<li><tt>containerConfigurationVolumeType</tt> - Docker container configuration of a mounted volume (Input to container creation and output from container inspection). The JSON marshalled from this type when the Docker REST API is invoked requires a map with where string keys defined a mount points with null object values. To support this requirement the exposed port type defines a volume key and a null value . To generate the null object for the value the <tt>containerConfigurationVolumeNullValueType</tt> is used.</li>
<li><tt>containerConfigurationVolumeNullValueType</tt> - Null value for volume (Input to container creation and output from container inspection).</li>
<li><tt>containerConfigurationVolumesType</tt> - Docker container configuration of a map of volumes (Input to container creation and output from container inspection). Each volume is defined using the <tt>containerConfigurationVolumeType</tt>. During marshalling the type is bound to the map <tt>ContainerConfigurationVolumesMap</tt> using the <tt>ContainerConfigurationVolumesMapAdapter</tt>.</li>
<li><tt>containerConfigurationHostConfigPortBindingValueType</tt> - Value for port binding</li>
<li><tt>containerConfigurationHostConfigPortBindingType</tt> - Docker container configuration of a port binding (Input to container creation and output from container inspection). The JSON marshalled from this type when the Docker REST API is invoked requires a map with values with the format: <tt>{ &quot;22/tcp&quot;: [{ &quot;HostPort&quot;: &quot;11022&quot; }] } </tt>. To support this requirement the binding type defines a key (element named containerPort) and value (element named value). The value is of the type <tt>containerConfigurationHostConfigPortBindingValueType</tt>.</li>
<li><tt>containerConfigurationHostConfigPortBindingsType</tt> - Docker container configuration of a map of port bindings (Input to container creation and output from container inspection). Each label is defined using the <tt>containerConfigurationHostConfigPortBindingType</tt>. During marshalling the type is bound to the map <tt>ContainerConfigurationHostConfigPortBindingsMap</tt> using the <tt>ContainerConfigurationHostConfigPortBindingsMapAdapter</tt>.</li>
<li><tt>createdContainerType</tt> - Info about created Docker container (Output from container creation).</li>
<li><tt>listedContainerType</tt> - Info about a listed Docker container (Output from listing containers).</li>
<li><tt>listedContainerPortType</tt> - Info about a port from a container info (Partial output from listing a container).</li>
<li><tt>inspectedContainerType</tt> - Info about an inspected Docker container (Output from inspecting a container).</li>
<li><tt>inspectedContainerStateType</tt> - Info about the state of a Docker container (Partial output from inspecting a containers).</li>
<li><tt>inspectedContainerNetworkSettingsType</tt> - Info about the network configuration of a Docker container (Partial output from inspecting a containers).</li>
<li><tt>inspectedContainerHostConfigType</tt> - Info about the host configuration of a Docker container (Partial output from inspecting a container).</li>
<li><tt>inspectedContainerVolumesType</tt> - Info about volumes from a container inspection info (Partial output from inspecting a container). Has role comparable to <tt>containerConfigurationVolumesType</tt> but for inspected container.</li>
<li><tt>inspectedContainerVolumeType</tt> - Info about a volume from a container inspection info (Partial output from inspecting a container). Has role comparable to <tt>containerConfigurationVolumeType</tt> but for inspected container.</li>
<li><tt>inspectedContainerVolumesRelabelType</tt> - Info about volumes from a container inspection info (Partial output from inspecting a container). Has role comparable to <tt>containerConfigurationVolumesType</tt> but for inspected container.</li>
<li><tt>inspectedContainerVolumeRelabelType</tt> - Info about a volume from a container inspection info (Partial output from inspecting a container). Has role comparable to <tt>containerConfigurationVolumeType</tt> but for inspected container.</li>
<li><tt>inspectedContainerVolumesRwType</tt> - Info about volumes RW from a container inspection info (Partial output from inspecting a container). Has role comparable to <tt>containerConfigurationVolumesType</tt> but for inspected container.</li>
<li><tt>inspectedContainerVolumeRwType</tt> - Info about a volume from a container inspection info (Partial output from inspecting a container). Has role comparable to <tt>containerConfigurationVolumeType</tt> but for inspected container.</li>
<li><tt>inspectedContainerNetworkSettingsNetworkType</tt> - Info about a Docker container network from a container inspection info. The JSON marshalled from this type when the Docker REST API is invoked requires a map with where string keys defines the driver with network object values. To support this requirement the networks type defines a driver key and a network value </li>
<li><tt>inspectedContainerNetworkSettingsNetworkType</tt> - Docker container configuration of a map of container networks from container inspection. Each volume is defined using the <tt>inspectedContainerNetworkSettingsNetworkType</tt>. During marshalling the type is bound to the map <tt>InspectedContainerNetworkSettingsNetworksMap</tt> using the <tt>InspectedContainerNetworkSettingsNetworksMapAdapter</tt>.</li></ul></div>
<div class="section">
<h4>Binding<a name="Binding"></a></h4>
<div class="section">
<h5>Exposed ports<a name="Exposed_ports"></a></h5>
<p>To support binding of schema element <tt>containerConfigurationType.exposedPorts</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationExposedPortsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationExposedPortsMapAdapter</tt>. The map and JAXB adaptor is shared with the two other bindings described in this section.</p>
<p>To support binding of schema element <tt>inspectedContainerConfigurationType.exposedPorts</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationExposedPortsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationExposedPortsMapAdapter</tt>. The map and JAXB adaptor is shared with the two other bindings described in this section.</p>
<p>To support binding of schema element <tt>inspectedConfigurationType.exposedPorts</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationExposedPortsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationExposedPortsMapAdapter</tt>. The map and JAXB adaptor is shared with the two other bindings described in this section.</p>
<p>To support binding of schema element <tt>inspectedContainerNetworkSettingsType.ports</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationExposedPortsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationExposedPortsMapAdapter</tt>. The map and JAXB adaptor is shared with the two other bindings described in this section.</p>
<p>To support binding of schema element <tt>inspectedImageContainerConfigurationType.exposedPorts</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationExposedPortsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationExposedPortsMapAdapter</tt>. The map and JAXB adaptor is shared with the two other bindings described in this section.</p></div>
<div class="section">
<h5>Labels<a name="Labels"></a></h5>
<p>To support binding of schema element <tt>containerConfigurationType.labels</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationLabelsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationLabelsMapAdapter</tt>. The map and JAXB adaptor is shared with the other bindings in the section.</p>
<p>To support binding of schema element <tt>listedContainerType.labels</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationLabelsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationLabelsMapAdapter</tt>. The map and JAXB adaptor is shared with the other bindings in the section.</p>
<p>To support binding of schema element <tt>inspectedContainerConfigurationType.labels</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationLabelsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationLabelsMapAdapter</tt>. The map and JAXB adaptor is shared with the other bindings in the section.</p>
<p>To support binding of schema element <tt>inspectedImageContainerType.labels</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationLabelsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationLabelsMapAdapter</tt>. The map and JAXB adaptor is shared with the other bindings in the section.</p>
<p>To support binding of schema element <tt>inspectedImageContainerConfigurationType.labels</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationLabelsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationLabelsMapAdapter</tt>. The map and JAXB adaptor is shared with the other bindings in the section.</p>
<p>To support binding of schema element <tt>listedImageType.labels</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationLabelsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationLabelsMapAdapter</tt>. The map and JAXB adaptor is shared with the other bindings in the section.</p></div>
<div class="section">
<h5>Port binding<a name="Port_binding"></a></h5>
<p>To support binding of schema element <tt>containerConfigurationHostConfigType.portBindings</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationHostConfigPortBindingsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationHostConfigPortBindingsMapAdapter</tt>. The map and JAXB adaptor is shared with two other bindings in this section.</p>
<p>To support binding of schema element <tt>inspectedContainerHostConfigType.portBindings</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationHostConfigPortBindingsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationHostConfigPortBindingsMapAdapter</tt>. The map and JAXB adaptor is shared with two other bindings in this section.</p>
<p>To support binding of schema element <tt>inspectedContainerConfigurationType.portSpecs</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationHostConfigPortBindingsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationHostConfigPortBindingsMapAdapter</tt>. The map and JAXB adaptor is shared with two other bindings in this section.</p>
<p>To support binding of schema element <tt>inspectedImageConfigurationType.portSpecs</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationHostConfigPortBindingsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationHostConfigPortBindingsMapAdapter</tt>. The map and JAXB adaptor is shared with two other bindings in this section.</p>
<p>To support binding of schema element <tt>inspectedImageContainerConfigurationType.portSpecs</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationHostConfigPortBindingsMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationHostConfigPortBindingsMapAdapter</tt>. The map and JAXB adaptor is shared with two other bindings in this section.</p></div>
<div class="section">
<h5>Restart policy<a name="Restart_policy"></a></h5>
<p>TODO:..</p></div>
<div class="section">
<h5>Volumes<a name="Volumes"></a></h5>
<p>To support binding of <tt>containerConfigurationType.volumes</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationVolumesMap&gt;&gt; using the custom JABX adaptor &lt;&lt;&lt;ContainerConfigurationVolumesMapAdapter</tt>. The map and JAXB adaptor is shared with binding of <tt>inspectedContainerConfigurationType.volumes</tt> and <tt>inspectedImageContainerConfigurationType.volumes</tt>.</p>
<p>To support binding of schema element <tt>inspectedContainerConfigurationType.volumes</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationVolumesMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationVolumesMapAdapter</tt>. The map and JAXB adaptor is shared with binding of <tt>containerConfigurationType.volumes</tt> and <tt>inspectedImageContainerConfigurationType.volumes</tt>.</p>
<p>To support binding of schema element <tt>inspectedImageConfigurationType.volumes</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationVolumesMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationVolumesMapAdapter</tt>. The map and JAXB adaptor is shared with binding of <tt>containerConfigurationType.volumes</tt> and <tt>inspectedContainerConfigurationType.volumes</tt>.</p>
<p>To support binding of schema element <tt>inspectedImageContainerConfigurationType.volumes</tt> to a map, the binding is customized to bind to the custom map <tt>ContainerConfigurationVolumesMap</tt> using the custom JABX adaptor <tt>ContainerConfigurationVolumesMapAdapter</tt>. The map and JAXB adaptor is shared with binding of <tt>containerConfigurationType.volumes</tt> and <tt>inspectedContainerConfigurationType.volumes</tt>.</p>
<p>To support binding of schema element <tt>inspectedContainerType.volumes</tt> to a map, the binding is customized to bind to the custom map <tt>InspectedContainerVolumesMap</tt> using the custom JABX adaptor <tt>InspectedContainerVolumesMapAdapter</tt>.</p>
<p>To support binding of schema element <tt>inspectedContainerType.volumesRelabel</tt>to a map, the binding is customized to bind to the custom map <tt>inspectedContainerVolumesRelabelMap</tt> using the custom JABX adaptor <tt>inspectedContainerVolumesRelabelMapAdapter</tt>.</p>
<p>To support binding of schema element <tt>inspectedContainerType.volumesRW</tt>to a map, the binding is customized to bind to the custom map <tt>inspectedContainerVolumesRwMap</tt> using the custom JABX adaptor <tt>inspectedContainerVolumesRwMapAdapter</tt>.</p></div>
<div class="section">
<h5>Network<a name="Network"></a></h5>
<p>To support binding of schema element <tt>inspectedContainerNetworkSettingsType.networks</tt> to a map, the binding is customized to bind to the custom map <tt>InspectedContainerNetworkSettingsNetworksMap</tt> using the custom JABX adaptor <tt>InspectedContainerNetworkSettingsNetworksMapAdapter</tt>.</p></div></div>
<div class="section">
<h4>JAXB Links<a name="JAXB_Links"></a></h4>
<p>More information about JAXB can be found <a class="externalLink" href="https://jaxb.dev.java.net/">here.</a></p>
<p>More information about <tt>maven-jaxb2-plugin</tt> can be found <a class="externalLink" href="https://maven-jaxb2-plugin.dev.java.net/">here.</a> </p></div></div>
<div class="section">
<h3>Internal configuration<a name="Internal_configuration"></a></h3>
<div class="section">
<h4>Logging<a name="Logging"></a></h4>
<p>The project uses Log4j for logging. Each project which links to this project must provide a Log4j configuration which is accessible at runtime as a result of the build process.</p>
<p>For testing the project uses the Log4j configuration supplied by the <tt>pineapple-test-utils</tt> project. </p></div>
<div class="section">
<h4>Spring configuration file <a name="Spring_configuration_file"></a></h4>
<p>The plugin contains a configuration file which defines a Spring application context. The Spring application context defines the input unmarshalling for the project. The file is located in <tt>src/main/resources/com.alpha.pineapple.docker-config.xml</tt>.</p>
<div class="section">
<h5>Minimal JSON marshalling<a name="Minimal_JSON_marshalling"></a></h5>
<p>The Docker remote API favors invocation only with fields which are changed or defined with meaningful information. The Jackson marshaller used by the Spring REST template to marshall JSON is configured only to serialize non-null and non-default values when invoking a Docker host, using the <tt>serializationInclusion</tt> property:</p>
<div class="source">
<pre>&lt;bean id=&quot;jacksonObjectMapper&quot; class=&quot;com.fasterxml.jackson.databind.ObjectMapper&quot;&gt;
        &lt;property name=&quot;propertyNamingStrategy&quot;&gt;                        
                &lt;bean class=&quot;com.alpha.pineapple.docker.utils.UpperCaseStyleStrategy&quot; /&gt;
        &lt;/property&gt;
        &lt;property name=&quot;serializationInclusion&quot;&gt;
        &lt;value type=&quot;com.fasterxml.jackson.annotation.JsonInclude.Include&quot;&gt;NON_DEFAULT&lt;/value&gt;
        &lt;/property&gt;
&lt;/bean&gt; 
</pre></div></div></div>
<div class="section">
<h4>Internationalization (I18N) configuration file <a name="Internationalization_I18N_configuration_file"></a></h4>
<p>The report generator uses internationalization. Messages used by classes in the project are located in the file <tt>src/main/resources/com.alpha.pineapple.docker-messages.properties</tt>. </p></div>
<div class="section">
<h4>JAXB binding file <a name="JAXB_binding_file"></a></h4>
<p>JAXB bindings file used during generation of model objects from the plugin schema is located at <tt>src/main/resources/bindings.xjb</tt>.</p></div></div>
<div class="section">
<h3>Test <a name="Test"></a></h3>
<div class="section">
<h4>Unit test<a name="Unit_test"></a></h4>
<p>All test cases expects a Docker daemon at 192.168.99.11:8082. This is due to their usage of <tt>DockerHelper.createDefaultSession()</tt> to create a session. For more details, see the <i>Pineapple Test Infrastructure</i>.</p></div>
<div class="section">
<h4>Docker images<a name="Docker_images"></a></h4>
<p>The system test cases within the project are based on the usage of a set of Docker images. CentOS is used as the OS due to its similarities to an Enterprise Linux like Red Hat enterprise Linux.</p>
<p>The root image is the CentOS image <i>tianon/centos</i> defined by the constant <tt>DockerTestConstants.TEST_DOCKER_ROOT_CENTOS_IMAGE</tt>. The root is image isn't intended to be used directly in test cases. The default image should be used in test cases.</p>
<p>The default image is defined as a tag of the root image. The default image is defined in the user repository <i>pineapple_ci/centos</i>. The image is defined by the constant <tt>DockerTestConstants.TEST_DOCKER_DEFAULT_CENTOS_IMAGE</tt>.</p></div></div>
<div class="section">
<h3>Implementation<a name="Implementation"></a></h3>
<div class="section">
<h4>Project constants<a name="Project_constants"></a></h4>
<p>The package <tt>com.alpha.pineapple.docker</tt> is the root package of the project and contains the interface <tt>DockerConstants</tt> which constant used by the project.</p></div>
<div class="section">
<h4>Docker Client <a name="Docker_Client"></a></h4>
<p>The package <tt>com.alpha.pineapple.docker</tt> also contains the classes which defines the Docker client:</p>
<ul>
<li><tt>DockerClient</tt> is the interface for the Docker client API.</li>
<li><tt>DockerClient</tt> is the implementation of the Docker client which implements a communication with Docker daemons using the Docker Remote API. </li>
<li><tt>DockerClientExceptionException</tt> is an exception class for signaling errors in the Docker client.</li></ul></div>
<div class="section">
<h4>Session class<a name="Session_class"></a></h4>
<p>The package <tt>com.alpha.pineapple.docker.session</tt> contains the session classes implement in the project:</p>
<ul>
<li><tt>DockertSession</tt> defines the interface for plugin session which handles the communication with Docker daemons using the REST API. </li>
<li><tt>DockerSessionImpl</tt> extends the <tt>DockertSession</tt> interface and implements the communication layer using the Spring REST client <tt>RestTemplate</tt>.</li></ul>
<div class="section">
<h5>Handling multiple JSON responses during creation of a Docker image<a name="Handling_multiple_JSON_responses_during_creation_of_a_Docker_image"></a></h5>
<p>The method <tt>httpPostForObjectWithMultipleRootElements(..)</tt> is used to create a Docker image from the <tt>CreateImageCommand</tt>. The Docker REST API doesn't returns a valid JSON but a string containing multiple JSON responses.</p>
<p><tt>RestTemplate</tt> configured with a Jackson message converter ins't able to parse the string. To parse the set of JSON responses in the string, the string is first transformed into a JSON array by:</p>
<ul>
<li>The string is decorated with JSON array delimiters</li>
<li>All carriage returns and new line chars are removed.</li>
<li>A comma is add between every array entry.</li></ul>
<p>The created JSON array is then marshalled by a Jackson JSON object mapper into objects and returned.</p></div></div>
<div class="section">
<h4>Spring RestTemplate configuration <a name="Spring_RestTemplate_configuration"></a></h4>
<p>The project configures two instances of the Spring REST client <tt>RestTemplate</tt>.</p>
<p>One instance of RestTemplate is configured with the <tt>MappingJackson2HttpMessageConverter</tt> which supports marshalling of JSON using the Jackson library and the <tt>StringHttpMessageConverter</tt> which supports marshalling of string based messages frin the HTTP response body.</p>
<p>The second instance of RestTemplate is configured without any message converters. This instance is used to parse responses from Docker isn't a valid JSON but a string containing multiple JSON responses. This RestTemplate instance is used in the <tt>DockertSessionImpl</tt> in the method <b>httpPostForObjectWithMultipleRootElements(..)</b>&gt; used during creation of an image from the <tt>CreateImageCommand</tt>.</p>
<div class="section">
<h5>Error Handling<a name="Error_Handling"></a></h5>
<p>The package <tt>com.alpha.pineapple.docker.utils</tt> contains classes to improve the error handling from for RestTemlpate: </p>
<ul>
<li><tt>RestResponseErrorHandler</tt> which implements the <tt>ResponseErrorHandler</tt> interface to provide a customized error handler for exceptions returned by RestTemplate. The error handle captures the exception from RestTemplate and information from the HTTP response. The handler then throws a <tt>RestResponseException</tt> with all the collected data.</li>
<li><tt>RestResponseException</tt> used to signal an error invoking REST request or received a response.</li></ul></div>
<div class="section">
<h5>JSON marshalling<a name="JSON_marshalling"></a></h5>
<p>The package <tt>com.alpha.pineapple.docker.utils</tt> also contains helper classes used during marshalling JSON to objects:</p>
<ul>
<li><tt>UpperCaseStyleStrategy</tt> implements the Jackson <tt>PropertyNamingStrategy</tt> interface to provide a customized property naming strategy during marshalling. The strategy generates upper case target attribute names in objects for for JSON attribute to be mapped to. Special cases:
<ul>
<li>If the target object attribute is <tt>ListedImage.id</tt> then the received JSON property <tt>Id</tt> is mapped to to the target attribute <tt>id</tt>.</li>
<li>If the target object attribute is <tt>CreatedContainer.id</tt> then the received JSON property <tt>Id</tt> is mapped to to the target attribute <tt>id</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerHostConfig.utsMode</tt> then the received JSON property <tt>UTSMode</tt> is mapped to to the target attribute <tt>utsMode</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettings.ipAddress</tt> then the received JSON property <tt>IPAddress</tt> is mapped to to the target attribute <tt>ipAddress</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettings.ipPrefixLen</tt> then the received JSON property <tt>IPPrefixLen</tt> is mapped to to the target attribute <tt>ipPrefixLen</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettings.ipv6Gateway</tt> then the received JSON property <tt>IPv6Gateway</tt> is mapped to to the target attribute <tt>ipv6Gateway</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettings.endpointId</tt> then the received JSON property <tt>EndpointID</tt> is mapped to to the target attribute <tt>endpointId</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettings.networkId</tt> then the received JSON property <tt>NetworkID</tt> is mapped to to the target attribute <tt>networkId</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettings.sandboxId</tt> then the received JSON property <tt>SandboxID</tt> is mapped to to the target attribute <tt>sandboxId</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettingsNetworkValue.ipAddress</tt> then the received JSON property <tt>IPAddress</tt> is mapped to to the target attribute <tt>ipAddress</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettingsNetworkValue.ipPrefixLen</tt> then the received JSON property <tt>IPPrefixLen</tt> is mapped to to the target attribute <tt>ipPrefixLen</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettingsNetworkValue.ipv6Gateway</tt> then the received JSON property <tt>IPv6Gateway</tt> is mapped to to the target attribute <tt>ipv6Gateway</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettingsNetworkValue.endpointId</tt> then the received JSON property <tt>EndpointID</tt> is mapped to to the target attribute <tt>endpointId</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettingsNetworkValue.globalIpv6Address</tt> then the received JSON property <tt>GlobalIPv6Address</tt> is mapped to to the target attribute <tt>globalIpv6Address</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettingsNetworkValue.globalIpv6PrefixLen</tt> then the received JSON property <tt>GlobalIPv6PrefixLen</tt> is mapped to to the target attribute <tt>globalIpv6PrefixLen</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerNetworkSettingsNetworkValue.ipamConfig</tt> then the received JSON property <tt>IPAMConfig</tt> is mapped to to the target attribute <tt>ipamConfig</tt>.</li>
<li>If the target object attribute is <tt>*.ip</tt> then the received JSON property <tt>IP</tt> is mapped to to the target attribute <tt>ip</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerState.oomKilled</tt> then the received JSON property <tt>OOMKilled</tt> is mapped to to the target attribute <tt>oomKilled</tt>.</li>
<li>If the target object attribute is <tt>ListedContainer.imageId</tt> then the received JSON property <tt>ImageID</tt> is mapped to to the target attribute <tt>imageId</tt>.</li>
<li>If the target object attribute is <tt>InspectedContainerMounts.rw</tt> then the received JSON property <tt>RW</tt> is mapped to to the target attribute <tt>rw</tt>.</li></ul></li></ul></div></div>
<div class="section">
<h4>General utilities <a name="General_utilities"></a></h4>
<p>The package <tt>com.alpha.pineapple.docker.utils</tt> also contains general utilities: </p>
<ul>
<li><tt>ModelUtils</tt> is a general helper class for querying Docker model objects. </li></ul></div>
<div class="section">
<h4>Commands<a name="Commands"></a></h4>
<p>The package <tt>com.alpha.pineapple.docker.command</tt> contains Chain commands which invokes REST services at the Docker daemons, the exact semantics of these services are described in the <a class="externalLink" href="http://docs.docker.io/reference/api/docker_remote_api/">Docker Remote API</a> documentation. </p>
<p>These commands are implemented:</p>
<ul>
<li><tt>BuildImageCommand</tt> creates a new Docker image from a Dockerfile.
<ul>
<li><tt>CreateImageCommand</tt> creates a new Docker image either by pulling it from the registry or by importing it.</li>
<li><tt>CreateTaggedImageCommand</tt> creates a tagged Docker image from an existing image. </li>
<li><tt>DeleteImageCommand</tt> deletes a Docker image. </li>
<li><tt>ListAllImagesCommand</tt> list all images in a Docker daemon. </li>
<li><tt>CreateContainerCommand</tt> creates a Docker container from an base image. </li>
<li><tt>DeleteContainerCommand</tt> deletes a Docker container. </li>
<li><tt>KillContainerCommand</tt> kills a running Docker container. </li>
<li><tt>StartContainerCommand</tt> starts a Docker container. </li>
<li><tt>StopContainerCommand</tt> stops a Docker container. </li>
<li><tt>PauseContainerCommand</tt> pauses a running container. </li>
<li><tt>TestContainerCommand</tt> validates the container definition in a model with a container in a Docker host.</li>
<li><tt>ReportOnImagesCommand</tt> creates a report of all images in a Docker host.</li>
<li><tt>ReportOnContainersCommand</tt> creates a report of all containers in a Docker host.</li>
<li><tt>InspectsContainerCommand</tt> returns information about a Docker container. </li>
<li><tt>ListAllContainersCommand</tt> list all containers in a Docker daemon. </li>
<li><tt>CreateTarArchiveCommand</tt> creates a TAR archive from a source directory. </li></ul></li></ul>
<div class="section">
<h5>BuildImageCommand <a name="BuildImageCommand"></a></h5>
<p>Command which can create a Docker image, from TAR archive which contains a DockerFile.</p>
<p>The command is invoked with a TAR archive (which must contain a Dockerfile in a root directory) and a <tt>ImageInfo</tt> object which is used to tag the image created from the Dockerfile.</p></div>
<div class="section">
<h5>CreateImageCommand <a name="CreateImageCommand"></a></h5>
<p>Command which can create a Docker image, either by pulling it from the registry or by importing it.</p>
<p>The command is invoked with a <tt>ImageInfo</tt> object which defines an image through a Docker repository and image tag.</p>
<p>Example of official repository name is <i>ubuntu</i> which holds Ubuntu images.</p>
<p>Example of user repository (which has the name format user/repo) is <i>mrpono/pineapple</i>.</p>
<p>Example of image tags are: <i>latest</i> and <i>12.10</i>.</p></div>
<div class="section">
<h5>CreateTaggedImageCommand<a name="CreateTaggedImageCommand"></a></h5>
<p>Command which can create a Docker image from an existing image.</p>
<p>The command is invoked with:</p>
<ul>
<li>Source <tt>ImageInfo</tt> object which defines an image through a Docker repository and image tag.</li>
<li>Target <tt>ImageInfo</tt> object which defines an image through a Docker repository and image tag. The value of the image tag is current ignored, since the created image will be created with the <i>latest</i> tag.</li></ul>
<p>When the command is executes a Docker image is created in the repository named by the repository value in the target image info object. The image is created with the <i>latest</i> tag. The image is a tagged copy of the image defined in the source image object. The two images shares the same image ID. </p></div></div>
<div class="section">
<h4>Data transfer objects<a name="Data_transfer_objects"></a></h4>
<p>The package <tt>com.alpha.pineapple.docker.model</tt> contains helper objects and data transfer objects (DTO) used as input to commands: </p>
<ul>
<li><tt>InfoBuilder</tt> is interface for building DTO's.</li>
<li><tt>InfoBuilderImpl</tt> is the default implementation of the <tt>InfoBuilder</tt> interface.</li>
<li><tt>ImageInfoImpl</tt> is the default implementation of the <tt>ImageInfo</tt> interface.</li>
<li><tt>ImageInfo</tt> is interface for DTO which defines a Docker image.</li>
<li><tt>ImageInfoImpl</tt> is the default implementation of the <tt>ImageInfo</tt> interface.</li>
<li><tt>ContainerInfo</tt> is interface for DTO which defines a Docker container.</li>
<li><tt>ContainerInfoImpl</tt> is the default implementation of the <tt>ContainerInfo</tt> interface.</li>
<li><tt>ContainerInstanceInfo</tt> is interface for DTO which defines a Docker container instance.</li>
<li><tt>ContainerInstanceInfoImpl</tt> is the default implementation of the <tt>ContainerInstanceInfo</tt> interface.</li></ul></div>
<div class="section">
<h4>Support for customized JAXB bindings <a name="Support_for_customized_JAXB_bindings"></a></h4>
<p>The package <tt>com.alpha.pineapple.docker.model.jaxb</tt> contains objects for implementation of customized JAXB bindings:</p>
<ul>
<li><tt>ContainerConfigurationExposedPortsMap</tt> custom map implementation. Used bind to the schema generated type <tt>ContainerConfigurationExposedPorts</tt> into a map.</li>
<li><tt>ContainerConfigurationExposedPortsMapAdapter</tt> JAXB binding adapter. Implements binding of schema generated type <tt>ContainerConfigurationExposedPorts</tt> to <tt>ContainerConfigurationExposedPortsMap</tt> and back.</li>
<li><tt>ContainerConfigurationLabelsMap</tt> custom map implementation. Used bind to the schema generated type <tt>ContainerConfigurationLabels</tt>, <tt>ContainerConfigurationLabels</tt> into a map.</li>
<li><tt>ContainerConfigurationLabelsMapAdapter</tt> JAXB binding adapter. Implements binding of schema generated type <tt>ContainerConfigurationLabels</tt> to <tt>ContainerConfigurationLabelsMap</tt> and back.</li>
<li><tt>ContainerConfigurationVolumesMap</tt> custom map implementation. Used bind to schema generated type <tt>ContainerConfigurationVolumes</tt> into a map.</li>
<li><tt>ContainerConfigurationVolumesMapAdapter</tt> JAXB binding adapter. Implements binding of schema generated type <tt>ContainerConfigurationVolumes</tt> to <tt>ContainerConfigurationVolumesMap</tt> and back.</li>
<li><tt>ContainerConfigurationHostConfigPortBindingsMap</tt> custom map implementation. Used bind to the schema generated type <tt>ContainerConfigurationHostConfigPortBinding</tt> into a map.</li>
<li><tt>ContainerConfigurationHostConfigPortBindingsMapAdapter</tt> JAXB binding adapter. Implements binding of schema generated type <tt>ContainerConfigurationHostConfigPortBinding</tt> to <tt>ContainerConfigurationHostConfigPortBindingsMap</tt> and back.</li>
<li><tt>InspectedContainerVolumesMap</tt> custom map implementation. Used bind to schema generated type <tt>InspectedContainerVolumes</tt> into a map.</li>
<li><tt>InspectedContainerVolumesMapAdapter</tt> JAXB binding adapter. Implements binding of schema generated type <tt>InspectedContainerVolumes</tt> to <tt>InspectedContainerVolumesMap</tt> and back.</li>
<li><tt>InspectedContainerVolumesRelabelMap</tt> custom map implementation. Used bind to schema generated type <tt>InspectedContainerVolumesRelabel</tt> into a map.</li>
<li><tt>InspectedContainerVolumesRelabelMapAdapter</tt> JAXB binding adapter. Implements binding of schema generated type <tt>InspectedContainerVolumesRelabel</tt> to <tt>InspectedContainerVolumesRelabelMap</tt> and back.</li>
<li><tt>InspectedContainerVolumesRwMap</tt> custom map implementation. Used bind to schema generated type <tt>InspectedContainerVolumesRw</tt> into a map.</li>
<li><tt>InspectedContainerVolumesRwMapAdapter</tt> JAXB binding adapter. Implements binding of schema generated type <tt>InspectedContainerVolumesRw</tt> to <tt>InspectedContainerVolumesRwMap</tt> and back.</li></ul></div>
<div class="section">
<h4>General test utilities <a name="General_test_utilities"></a></h4>
<p>The package <tt>com.alpha.testutils</tt> contains general test utilities: </p>
<ul>
<li><tt>DockerTestHelper</tt> is a test helper class for using the Docker client.</li>
<li><tt>DockerHelperException</tt> is an exception class for signaling errors in the Docker test helper.</li>
<li><tt>LoggingRequestInterceptorImpl</tt> is an Implementation of the <tt>ClientHttpRequestInterceptor</tt> interface which supports logging of HTTP responses received by <tt>RestTemplate</tt>.</li></ul>
<div class="section">
<h5>DockerHelper<a name="DockerHelper"></a></h5>
<p>When the <tt>createDefaultSession()</tt> method is invoked then a session to a Docker daemon at 192.168.99.11:8082 is created. For more details, see the <i>Pineapple Test Infrastructure</i>.</p></div></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2017.
          All Rights Reserved.      
                    
      </div>

                          
        
                </div>
    </footer>
  </body>
</html>
