<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src\site\apt/usage\agents.apt at 03 Feb 2019
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Allan Thrane Andersen" />
    <meta name="Date-Revision-yyyymmdd" content="20190203" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Pineapple Project &#x2013; Pineapple agent architecture overview</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script type="text/javascript" src="../js/apache-maven-fluido-1.7.min.js"></script>
    <!-- Google Analytics -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28287414-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>Pineapple Project</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
      <li class=""><a href="../index.html" title="Pineapple Home">Pineapple Home</a><span class="divider">/</span></li>
    <li class="active ">Pineapple agent architecture overview</li>
        <li id="publishDate" class="pull-right">Last Published: 03 Feb 2019</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Project Overview</li>
    <li><a href="../index.html" title="Home"><span class="none"></span>Home</a></li>
    <li><a href="../usage/installation.html" title="Installation"><span class="none"></span>Installation</a></li>
    <li><a href="../usage/index.html" title="For Users"><span class="none"></span>For Users</a></li>
    <li><a href="../development/index.html" title="For Developers"><span class="none"></span>For Developers</a></li>
    <li><a href="../usage/terms.html" title="Terms and Conditions"><span class="none"></span>Terms and Conditions</a></li>
      <li class="nav-header">Clients</li>
    <li><a href="../pineapple-applications/pineapple-web-application/pineapple-standalone-web-client/index.html" title="Standalone Web Application"><span class="none"></span>Standalone Web Application</a></li>
    <li><a href="../pineapple-applications/pineapple-web-application/pineapple-web-application-war/index.html" title="Deployable Web Application"><span class="none"></span>Deployable Web Application</a></li>
    <li><a href="../pineapple-applications/pineapple-maven-plugin/index.html" title="Maven Plugin"><span class="none"></span>Maven Plugin</a></li>
      <li class="nav-header">Plugins</li>
    <li><a href="../pineapple-plugins/pineapple-agent-plugin/index.html" title="Agent"><span class="none"></span>Agent</a></li>
    <li><a href="../pineapple-plugins/pineapple-composite-execution-plugin/index.html" title="Composite Execution"><span class="none"></span>Composite Execution</a></li>
    <li><a href="../pineapple-plugins/pineapple-ssh-plugin/index.html" title="SSH"><span class="none"></span>SSH</a></li>
    <li><a href="../pineapple-plugins/pineapple-docker-plugin/index.html" title="Docker"><span class="none"></span>Docker</a></li>
    <li><a href="../pineapple-modules/pineapple-infrastructure-test-plugin/index.html" title="Infrastructure Test"><span class="none"></span>Infrastructure Test</a></li>
      <li class="nav-header">API's</li>
    <li><a href="../pineapple-applications/pineapple-web-application/pineapple-web-application-war/usage/rest.html" title="REST"><span class="none"></span>REST</a></li>
    <li><a href="../development/plugin-framework.html" title="Plugin Framework"><span class="none"></span>Plugin Framework</a></li>
      <li class="nav-header">Additional Information</li>
    <li><a href="http://pineapplesoftware.blogspot.com" class="externalLink" title="The Pineapple Project Blog"><span class="none"></span>The Pineapple Project Blog</a></li>
    <li><a href="http://exceptiontrail.blogspot.com" class="externalLink" title="Pineapple Exception Trail Blog"><span class="none"></span>Pineapple Exception Trail Blog</a></li>
      <li class="nav-header">Project Tools</li>
    <li><a href="https://bintray.com/pineapple/maven/com.alpha.pineapple" class="externalLink" title="Downloads"><span class="none"></span>Downloads</a></li>
    <li><a href="https://github.com/athrane/pineapple" class="externalLink" title="Source Code"><span class="none"></span>Source Code</a></li>
    <li><a href="https://github.com/athrane/pineapple/issues" class="externalLink" title="Issue Tracker"><span class="none"></span>Issue Tracker</a></li>
      <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
</ul>
          <hr />
          <div id="poweredBy">
    <script type="text/javascript">asyncJs( 'https://apis.google.com/js/plusone.js' )</script>
    <div class="g-plusone" data-href="https://athrane.github.io/pineapple/" data-size="tall" ></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<div class="section">
<h2><a name="Pineapple_agent_architecture_overview"></a>Pineapple agent architecture overview</h2>
<div class="section">
<h3><a name="Master_and_agents"></a>Master and agents</h3>
<p>The agent architecture supports the usage of Pineapple in a distributed setting. It's done through the usage of the Pineapple binary in two different roles as either master or agent. </p>
<p>In the role as master, a Pineapple instance is used to start and orchestrate the execution of operations on any number of agents. In the role as agent, a Pineapple instance executes operations on behalf of the master and reports back the results.</p><img src="../images/pineapple-agent-architecture.png" alt="" />
<div class="section">
<h4><a name="The_main_components"></a>The main components </h4>
<p>The two main components in the agent architecture are the agent plugin and the REST API which enables the communication between the master and agents. The agent plugin implements the master side of the agent architecture, where the plugin implements the functionality to start remote operations, communicate with agents and collect the results. The REST API implements the agent side of the agent architecture, where it is capable of receiving requests from the master, execute the request and report the results. </p></div></div>
<div class="section">
<h3><a name="Enabling_.22local.22_functionality_in_a_distributed_setting"></a>Enabling &quot;local&quot; functionality in a distributed setting </h3>
<p>Through the distribution and operation of agents the functionality of all plugins can be used in a distributed setting.</p>
<p>The functionality of a plugin can be categorized as intended for local operation on the host where Pineapple is running or for remote operation targeting one or more remote hosts through a protocol. </p>
<p>Examples of plugins which supports local operation are: </p>
<ul>
<li><b>Infrastructure test plugin</b> - which support basic test of IT infrastructure. </li>
<li><b>Composite execution plugin</b> - which supports execution of bulk execution of Pineapple modules. </li></ul>
<p>Examples of plugins which supports remote operation are: </p>
<ul>
<li><b>WebLogic JMX plugin</b> - which support configuration of a running WebLogic through its JMX API. </li>
<li><b>SSH plugin</b> - which support SSH access to remote host for copying files, execution of shell commands and execution of tests.</li>
<li><b>Infrastructure test plugin</b> - which support basic test of IT infrastructure.</li>
<li><b>Docker plugin</b> - which support configuration of Docker containers.</li>
<li><b>Agent plugin</b> - which support remote invocation of functionality of Pineapple agents.</li></ul>
<p>Distribution of agents enables the usage of plugins intended for local operation in a distributed setting. </p></div>
<div class="section">
<h3><a name="Controlling_the_agents"></a>Controlling the agents</h3>
<p>Agents are controlled by a central Pineapple instance which has the role of master. The master handles the distribution, configuration and usage of agents.</p></div>
<div class="section">
<h3><a name="Agent_binaries"></a>Agent binaries </h3>
<p>The functionality of the master and agents is contained in the same binary; the Pineapple web application (e.g. the WAR archive). This also includes the Pineapple standalone web client, since it is a packaging of the WAR archive with an embedded web server (e.g. Jetty).</p>
<p>It is recommend to use the standalone web client as a basis for agents. It is easier to distribute and configure because it comes with its own embedded web server. Using the WAR archive as a basis of agents requires the installation of a web server. Only the usage of the standalone client as a basis for agents is documented currently. </p></div>
<div class="section">
<h3><a name="Installation_of_agents"></a>Installation of agents </h3>
<div class="section">
<h4><a name="Prerequisites"></a>Prerequisites </h4>
<p>The prerequisites for installation and execution of an agent are: </p>
<ul>
<li>Creation of the required users and directories to run the agent on the host.</li>
<li>Installation of Java on the host where the agent is installed.</li></ul></div>
<div class="section">
<h4><a name="Installation_steps_on_Linux"></a>Installation steps on Linux</h4>
<p>The installation consists of three steps:</p>
<ul>
<li>Distribution of the Pineapple standalone binary (e.g a ZIP archive), Pineapple configuration files and a service script to install the agent as a OS service.</li>
<li>Remote creation of users and directories used for the execution of the agent.</li>
<li>Installation and start of the agent as a OS service.</li></ul></div>
<div class="section">
<h4><a name="Installed_as_a_module"></a>Installed as a module</h4>
<p>The installation steps are implemented in a module which uses the SSH plugin to do the job.</p></div>
<div class="section">
<h4><a name="Uninstallation_of_agents"></a>Uninstallation of agents</h4>
<p>Uninstallation is the reversal of the above installation steps. It is also implemented in a module which uses the SSH plugin.</p></div>
<div class="section">
<h4><a name="Additional_information:"></a>Additional information:</h4>
<ul>
<li><a href="../pineapple-applications/pineapple-web-application/pineapple-standalone-web-client/usage/installation-linux.html">How-to: Install the Pineapple standalone web application as an agent (i.e. a service) on Linux.</a></li>
<li><a href="../pineapple-plugins/pineapple-ssh-plugin/examples/install-pineapple-agent-linux.html">Example illustrating how use the SSH plugin to install agents on Linux</a>.</li>
<li><a href="./issues-installing-agents-linux-ssh.html">Common issues during installation of Pineapple agents on Linux</a>.</li></ul></div></div>
<div class="section">
<h3><a name="Communication_between_the_master_and_agents"></a>Communication between the master and agents </h3>
<p>Communication between the master and the agents is implemented through the usage of a REST API which is used by the master to:</p>
<ul>
<li>Distribute modules to agents.</li>
<li>Execute operations at agents.</li>
<li>Manage the configuration of agents.</li></ul>
<p>There are three ways that work can be initiated at the master:</p>
<ul>
<li>Using the web application GUI.</li>
<li>Execution of a module whose model uses the agent agent plugin.</li>
<li>Invoking the REST API of the master..</li></ul>
<div class="section">
<h4><a name="The_REST_API"></a>The REST API </h4>
<p>The REST API implements the agent side of the communication. Agents are contacted by the master through the usage of the REST API. </p></div>
<div class="section">
<h4><a name="The_agent_plugin"></a>The agent plugin </h4>
<p>The agent plugin implements the master side of the communication. The agent plugin is intended to be a mirror of the services exposed by the REST API. In its current incarnation, the plugin is a REST service client.</p></div>
<div class="section">
<h4><a name="Design_of_communication"></a>Design of communication</h4>
<p>Currently all communication originates from the masterand information updates during long running transactions are implemented using polling of REST resources.</p>
<p>Asynchronous communication from agents to the controlling Pineapple instance is postponed to the release of Spring 4.x. </p></div></div>
<div class="section">
<h3><a name="Security"></a>Security</h3>
<div class="section">
<h4><a name="Network_security"></a>Network security</h4>
<p>Network communication during installation of Pineapple agents is secured using SSH.</p>
<p>Communication between the master and agents is done in uencrypted HTTP. Support for TLS is pending resolution of issue: PINEAPPLE-447: Secure REST WS calls (through HTTPS).</p>
<p>REST services are unsecured. Support for authentication of REST services is pending resolution of issue: PINEAPPLE-448: Authorization of REST WS calls.</p></div>
<div class="section">
<h4><a name="Security_of_username_and_password_on_agent_hosts"></a>Security of username and password on agent hosts </h4>
<p>The user name and password of Pineapple resources are stored in plain text in the configuration file named <tt>credentials.xml</tt>. Support encryption of credentials is pending resolution of issue: PINEAPPLE-449: Encryption of credentials.</p></div>
<div class="section">
<h4><a name="Intended_usage_pattern_due_to_the_current_level_of_security"></a>Intended usage pattern due to the current level of security</h4>
<p>The current low level of security calls for a usage pattern when agents are installed, do their job and are removed instantly as part of an composite operation.</p></div></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
Copyright (C) 2007-2017 Allan Thrane Andersen. All Rights Reserved.
        </div>
      </div>
    </footer>
  </body>
</html>
