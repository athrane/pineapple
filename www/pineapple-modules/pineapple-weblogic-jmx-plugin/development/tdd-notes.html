<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Oct 13, 2012
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Allan Thrane Andersen" />
    <meta name="Date-Revision-yyyymmdd" content="20121013" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Pineapple WebLogic JMX plugin - Test driven development notes</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Pineapple WebLogic JMX plugin</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="../../../index.html" title="Pineapple home">
        Pineapple home</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href="../../" title="Pineapple modules">
        Pineapple modules</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href="../" title="Pineapple WebLogic JMX plugin">
        Pineapple WebLogic JMX plugin</a>
        </li>
      <li class="divider ">/</li>
        <li class="">Test driven development notes</li>
        
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 13 Oct 2012</li> 
            
                            </ul>
      </div>

                  
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Project overview</li>
                                
      <li>
    
                          <a href="../../../index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/installation.html" title="Installation">
          <i class="none"></i>
        Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/index.html" title="For users">
          <i class="none"></i>
        For users</a>
            </li>
                  
      <li>
    
                          <a href="../../../development/index.html" title="For developers">
          <i class="none"></i>
        For developers</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/terms.html" title="Terms and Conditions">
          <i class="none"></i>
        Terms and Conditions</a>
            </li>
                              <li class="nav-header">Clients</li>
                                
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-web-application/pineapple-standalone-web-client/index.html" title="Standalone web client">
          <i class="none"></i>
        Standalone web client</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-web-application/pineapple-web-application-war/index.html" title="Deployable web client">
          <i class="none"></i>
        Deployable web client</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-gui-release/index.html" title="Swing client">
          <i class="none"></i>
        Swing client</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-maven-plugin/index.html" title="Maven plugin">
          <i class="none"></i>
        Maven plugin</a>
            </li>
                              <li class="nav-header">Plugins</li>
                                
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-infrastructure-test-plugin/index.html" title="Infrastructure test">
          <i class="none"></i>
        Infrastructure test</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-wbem-plugin/index.html" title="WBEM">
          <i class="none"></i>
        WBEM</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-jrockit-installation-plugin/index.html" title="JRockit installation">
          <i class="none"></i>
        JRockit installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-weblogic-installation-plugin/index.html" title="WebLogic installation">
          <i class="none"></i>
        WebLogic installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-weblogic-deployment-plugin/index.html" title="WebLogic deployment">
          <i class="none"></i>
        WebLogic deployment</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-weblogic-scripting-tool-plugin/index.html" title="WebLogic scripting tool (WLST)">
          <i class="none"></i>
        WebLogic scripting tool (WLST)</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-weblogic-jmx-plugin/index.html" title="WebLogic JMX">
          <i class="none"></i>
        WebLogic JMX</a>
            </li>
                              <li class="nav-header">Additional information</li>
                                
      <li>
    
                          <a href="http://pineapplesoftware.blogspot.com" class="externalLink" title="The Pineapple Blog">
          <i class="none"></i>
        The Pineapple Blog</a>
            </li>
                              <li class="nav-header">Project tools</li>
                                
      <li>
    
                          <a href="http://java.net/projects/pineapple/downloads" class="externalLink" title="Downloads">
          <i class="none"></i>
        Downloads</a>
            </li>
                  
      <li>
    
                          <a href="http://java.net/projects/pineapple/sources/svn/show" class="externalLink" title="Source Code">
          <i class="none"></i>
        Source Code</a>
            </li>
                  
      <li>
    
                          <a href="http://java.net/jira/browse/PINEAPPLE" class="externalLink" title="Issue tracker">
          <i class="none"></i>
        Issue tracker</a>
            </li>
                  
      <li>
    
                          <a href="http://java.net/projects/pineapple/lists" class="externalLink" title="Mailing lists">
          <i class="none"></i>
        Mailing lists</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                        
      <li>
    
                          <a href="../project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="http://maven.apache.org" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                        
        <div id="bodyColumn"  class="span10" >
                                  
            <!-- NOTE: For help with the syntax of this file, see: --><!-- http://maven.apache.org/guides/mini/guide-apt-format.html --><div class="section"><h2>Test driven development notes<a name="Test_driven_development_notes"></a></h2><div class="section"><h3>Uresolved TDD Notes<a name="Uresolved_TDD_Notes"></a></h3><div class="section"><h4>4) implement proper algoritm for type resolution in XMLBean models<a name="a4_implement_proper_algoritm_for_type_resolution_in_XMLBean_models"></a></h4><p><b>Current algorithm:</b></p><p>Implemented in <tt>XmlBeansModelResolverImpl.resolveType(..)</tt> using the algorithm: </p><ul><li>The schema property for the property with name <i>attribute name</i> is resolved from the xmlBean. </li></ul><p><b>Final algorithm:</b> </p><p>Implemented in <tt>XmlBeansModelResolverImpl.resolveType(..)</tt> using the algorithm: </p><ul><li>The schema property for the property with name <i>attribute name</i> is resolved from the parent schema property, i.e. XMLBean type where the attribute is defined on. </li></ul></div><div class="section"><h4>18) Resolution of XMLBeans objects fails<a name="a18_Resolution_of_XMLBeans_objects_fails"></a></h4></div><div class="section"><h4>19) ldap.node-manager-password-encrypted doesn't appear a tested property <a name="a19_ldap.node-manager-password-encrypted_doesnt_appear_a_tested_property"></a></h4><p><i>node-manager-password-encrypted</i><a name="a3DES">3DES</a>sFVI2zdwIyefey5hsxsGeA==<i>/node-manager-password-encrypted</i></p></div><div class="section"><h4>22) Resolution of Realm fails<a name="a22_Resolution_of_Realm_fails"></a></h4><p>Example: myrealm:realm</p><p>StackTrace: java.lang.NullPointerException at com.alpha.pineapple.plugin.weblogic.jmx.model.traversal.DefaultModelTraversalDirectorImpl.traverse(DefaultModelTraversalDirectorImpl.java:100) at com.alpha.pineapple.plugin.weblogic.jmx.model.traversal.DefaultModelTraversalDirectorImpl.traverse(DefaultModelTraversalDirectorImpl.java:86) at com.alpha.pineapple.plugin.weblogic.jmx.model.traversal.DefaultModelTraversalDirectorImpl.traverse(DefaultModelTraversalDirectorImpl.java:86) at com.alpha.pineapple.plugin.weblogic.jmx.model.traversal.DefaultModelTraversalDirectorImpl.traverse(DefaultModelTraversalDirectorImpl.java:86) at com.alpha.pineapple.plugin.weblogic.jmx.model.traversal.DefaultModelTraversalDirectorImpl.traverse(DefaultModelTraversalDirectorImpl.java:86) at com.alpha.pineapple.plugin.weblogic.jmx.operation.TestDeployedConfiguration.execute(TestDeployedConfiguration.java:137) at com.alpha.pineapple.plugin.session.SessionHandlerImpl.execute(SessionHandlerImpl.java:75) at com.alpha.pineapple.command.InvokePluginsCommand.executeModel(InvokePluginsCommand.java:336) at com.alpha.pineapple.command.InvokePluginsCommand.executeModels(InvokePluginsCommand.java:275) </p><p>XmlBeansModelBuilderVisitorImpl fails during iteration over the names of the AuthenticationProvider:authentication-provider[] attribute in the realm.</p><p>The reason why the resolution fails is because name of the authentication-provider is null. </p></div><div class="section"><h4>29) TestCollectionValueCommand should access collections through model accessors<a name="a29_TestCollectionValueCommand_should_access_collections_through_model_accessors"></a></h4><p>Currently the command assumes that the type of the two collectiond is of type Object[] this can not always be assumed depending on the represenation in the underlying model. </p></div><div class="section"><h4>41) ldap.credential-encrypted doesn't appear a tested property <a name="a41_ldap.credential-encrypted_doesnt_appear_a_tested_property"></a></h4></div><div class="section"><h4>48) Proper handling af unnamed authentication-provider's<a name="a48_Proper_handling_af_unnamed_authentication-providers"></a></h4><p>e.g. for DefaultIdentityAsserter and DefaultAuthenticator whihc is only defined by schema type. xsitype=... </p></div><div class="section"><h4>49) Add I18N to MethodUtilsImpl<a name="a49_Add_I18N_to_MethodUtilsImpl"></a></h4></div><div class="section"><h4>50) Add I18N to MBeansGetterMethodMatcherImpl<a name="a50_Add_I18N_to_MBeansGetterMethodMatcherImpl"></a></h4></div><div class="section"><h4>51) Add I18N to MBeansModelAccessorImpl<a name="a51_Add_I18N_to_MBeansModelAccessorImpl"></a></h4></div><div class="section"><h4>52) Provide a good error message when resolving collection entries fails<a name="a52_Provide_a_good_error_message_when_resolving_collection_entries_fails"></a></h4><p>E.g. authentication providers,..</p></div><div class="section"><h4>53) Clarify why the authentication provider collection can be resolved but no the role mapper collection<a name="a53_Clarify_why_the_authentication_provider_collection_can_be_resolved_but_no_the_role_mapper_collection"></a></h4><p>...the authentication providers collection is resolved, the problems occour when the 'two null' entries is resolved. ...the resolution of the authentication providers collection can be solved by adding a name element to the authenticator elements.</p><p>the resolution of the role mapper collection fails on the secondary participant, e.g. the MBean.</p></div><div class="section"><h4>55) Object identity tests has strange message if test fails due to child errors <a name="a55_Object_identity_tests_has_strange_message_if_test_fails_due_to_child_errors"></a></h4></div><div class="section"><h4>56) Collection Value identity tests has strange message if test fails due to child errors <a name="a56_Collection_Value_identity_tests_has_strange_message_if_test_fails_due_to_child_errors"></a></h4></div><div class="section"><h4>59) Test PreOrderDirectorImpl<a name="a59_Test_PreOrderDirectorImpl"></a></h4></div><div class="section"><h4>60) Test PostOrderDirectorImpl<a name="a60_Test_PostOrderDirectorImpl"></a></h4></div><div class="section"><h4>62) MesseageSource doesn't resolve tavc.not_equal_failed properly <a name="a62_MesseageSource_doesnt_resolve_tavc.not_equal_failed_properly"></a></h4><p>Test failed, because the collection attribute values wasnt equal [<a name="a0">0</a>] vs. [<a name="a1">1</a>]. </p></div><div class="section"><h4>63) Inconstistency in message from TestAttributeValueCommand <a name="a63_Inconstistency_in_message_from_TestAttributeValueCommand"></a></h4><p>Either the message is wrong, the values in the message or the comparison of values is wrong:</p><p>Test failed, because the attribute values was not equal [false] vs. [false]. </p></div><div class="section"><h4>64) Inconsistency in message from TestAttributeValueCommand<a name="a64_Inconsistency_in_message_from_TestAttributeValueCommand"></a></h4></div><div class="section"><h4>65) Usage of traverseExplicitNodeOnlyStrategy excludes unsuccessful model nodes<a name="a65_Usage_of_traverseExplicitNodeOnlyStrategy_excludes_unsuccessful_model_nodes"></a></h4><p>Example: RoleMapper:role-mapper[] will disapear. </p></div><div class="section"><h4>66) Implement support for security attributes in the WLS schemas<a name="a66_Implement_support_for_security_attributes_in_the_WLS_schemas"></a></h4><div class="source"><pre class="prettyprint linenums">
        &lt;mmd:model target-resource=&quot;weblogic-jmx&quot;&gt;              
                &lt;mmd:content&gt;           
                        &lt;wjp:domain &gt;                           
                                &lt;wjp:name&gt;alphadomain&lt;/wjp:name&gt;
                                &lt;wjp:security-configuration&gt;
                                        &lt;wjp:name&gt;alphadomain&lt;/wjp:name&gt;
                                        &lt;wjp:realm&gt;
                                          &lt;sec:authentication-provider xsi:type=&quot;wls:default-authenticatorType&quot;&gt;

</pre></div><p>..the xsi:type attribute defines the default autheticator type.. </p></div><div class="section"><h4>72) Find out why no Name attribute can be resolved from Authorizer <a name="a72_Find_out_why_no_Name_attribute_can_be_resolved_from_Authorizer"></a></h4><p>Illustrated in example: weblogic-jmx-example-0.6.7</p></div><div class="section"><h4>75) Find out why no Name attribute can be resolved from role mapper<a name="a75_Find_out_why_no_Name_attribute_can_be_resolved_from_role_mapper"></a></h4><p>Illustrated in example: weblogic-jmx-example-0.6.5 </p></div><div class="section"><h4>77a) Verify that unnamed role mappers can be resolved and tested<a name="a77a_Verify_that_unnamed_role_mappers_can_be_resolved_and_tested"></a></h4><p>Tested in ResolvedModelBuilderVisitorIntegrationTest.testAuthenticationProviderCollectionWithUnnamedProvider():</p></div><div class="section"><h4>77b) Verify that named role mappers can be resolved and tested<a name="a77b_Verify_that_named_role_mappers_can_be_resolved_and_tested"></a></h4><p>Tested in ResolvedModelBuilderVisitorIntegrationTest.testAuthenticationProviderCollectionWithNamedProvider():</p></div><div class="section"><h4>78a) Verify that unnamed authorizer can be resolved and tested<a name="a78a_Verify_that_unnamed_authorizer_can_be_resolved_and_tested"></a></h4><p>Tested in ResolvedModelBuilderVisitorIntegrationTest.testAuthenticationProviderCollectionWithUnnamedProvider():</p></div><div class="section"><h4>78b) Verify that named authorizer can be resolved and tested<a name="a78b_Verify_that_named_authorizer_can_be_resolved_and_tested"></a></h4><p>Tested in ResolvedModelBuilderVisitorIntegrationTest.testAuthenticationProviderCollectionWithNamedProvider():</p></div><div class="section"><h4>81) Test MBeansModelResolverImpl.createNonExistingCollectionValue<a name="a81_Test_MBeansModelResolverImpl.createNonExistingCollectionValue"></a></h4></div><div class="section"><h4>84) Test XmlBeansModelResolverImpl.createNonExistingCollectionValue<a name="a84_Test_XmlBeansModelResolverImpl.createNonExistingCollectionValue"></a></h4></div><div class="section"><h4>86) Test ResolvedModelBuilderVisitorImpl.visit(ResolvedCollection resolvedCollection, ...)<a name="a86_Test_ResolvedModelBuilderVisitorImpl.visitResolvedCollection_resolvedCollection_..."></a></h4><p>which uses the modified method resolveCollectionEntry.</p></div><div class="section"><h4>87) Delete deprecated MBeanMetaDataHelper<a name="a87_Delete_deprecated_MBeanMetaDataHelper"></a></h4><p>logic should be replaced by MBeansModelAccessorImpl + MBeansGetterMethodMatcherImpl. </p></div><div class="section"><h4>88) Delete deprecated WeblogicJMXPluginTestConstants<a name="a88_Delete_deprecated_WeblogicJMXPluginTestConstants"></a></h4><p>Use constant in WJPIntTestConstants instead. </p></div><div class="section"><h4>94) Test CreateMBeanCommand<a name="a94_Test_CreateMBeanCommand"></a></h4><p>.. test case when object is resoleved from collection usgin the grand parent.. .. make the last two test cases go green. </p></div><div class="section"><h4>95) Test SetMBeanAttributeCommand<a name="a95_Test_SetMBeanAttributeCommand"></a></h4></div><div class="section"><h4>97) Clean up WeblogicJMXEditSessionImpl implementation<a name="a97_Clean_up_WeblogicJMXEditSessionImpl_implementation"></a></h4><p>.. use message provider .. implement conditional logging. .. remove dependency to JMXFactory</p><p>use the methods on the session.... </p></div><div class="section"><h4>98) Execution result hierachy dosen't propate error/failure up in MBeansCreatorVisitorImpl<a name="a98_Execution_result_hierachy_dosent_propate_errorfailure_up_in_MBeansCreatorVisitorImpl"></a></h4></div><div class="section"><h4>99) MBeansModelResolverImpl cant resolve VirtualHost.VirtualHostName <a name="a99_MBeansModelResolverImpl_cant_resolve_VirtualHost.VirtualHostName"></a></h4></div><div class="section"><h4>100) SetMBeanAttributeCommand fails to set multiple list values in a string[] field<a name="a100_SetMBeanAttributeCommand_fails_to_set_multiple_list_values_in_a_string_field"></a></h4><p>Example: MBean: String[] VirtualHostMBean.VirtualHostNames XMLBeans String VirtualHost.VirtualHostName</p><p>Handling the case of: String =&gt; String[]</p><p>ResolvedModelJmxGetterImpl.getAttributeValue(): ..The value resolved from the value of the primary participant which is converted to a string object.</p></div><div class="section"><h4>102) Fails to resolve enabled-server property on SnmpLogFilter<a name="a102_Fails_to_resolve_enabled-server_property_on_SnmpLogFilter"></a></h4><p>Resolution message:</p><div class="source"><pre class="prettyprint linenums">Completed traversing resolved type [
com.alpha.pineapple.resolvedmodel.ResolvedPrimitive@194a8eb[
primaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@2c1b13[
name=EnabledServer,
exception=&lt;null&gt;,
type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@1a59727,
value=admserver,
state=SET],
secondaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@de1cb6[
name=EnabledServer,
exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: 
Failed to resolve MBean attribute [EnabledServer] as no getter method could be resolved from MBean 
[[MBeanServerInvocationHandler]com.bea:Name=snmp-server-logfilter,Type=SNMPLogFilter,SNMPAgent=alphadomain].,
type=&lt;null&gt;,
value=&lt;null&gt;,tate=FAILED]]].
</pre></div></div><div class="section"><h4>103) Fails to test enabled-server property on SnmpLogFilter<a name="a103_Fails_to_test_enabled-server_property_on_SnmpLogFilter"></a></h4><p>Resolution message:</p><div class="source"><pre class="prettyprint linenums">Completed traversing resolved type [
com.alpha.pineapple.resolvedmodel.ResolvedPrimitive@194a8eb[
primaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@2c1b13[
name=EnabledServer,
exception=&lt;null&gt;,
type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@1a59727,
value=admserver,
state=SET],
secondaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@de1cb6[
name=EnabledServer,
exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: 
Failed to resolve MBean attribute [EnabledServer] as no getter method could be resolved from MBean 
[[MBeanServerInvocationHandler]com.bea:Name=snmp-server-logfilter,Type=SNMPLogFilter,SNMPAgent=alphadomain].,
type=&lt;null&gt;,
value=&lt;null&gt;,tate=FAILED]]].
</pre></div><p>Test message:</p><div class="source"><pre class="prettyprint linenums">Description:
enabled-server=admserver
Message:
Test failed, because resolution of secondary participant failed with exception 
[com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: 
Failed to resolve MBean attribute [EnabledServer] as no getter method could be resolved from MBean 
[[MBeanServerInvocationHandler]com.bea:Name=snmp-server-logfilter,Type=SNMPLogFilter,SNMPAgent=alphadomain].].
</pre></div></div><div class="section"><h4>104) Resolution fails when JMX-plugin is executed twice<a name="a104_Resolution_fails_when_JMX-plugin_is_executed_twice"></a></h4><p>Run TestDeployment twice to provoke the error:</p><div class="source"><pre class="prettyprint linenums">&lt;2011-03-30 09:54:36,454&gt; &lt;DEBUG&gt; &lt;MBeansModelResolverImpl&gt; &lt;Starting to resolve MBean attribute [Notes] from [com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@dad6d0[name=alphadomain,exception=&lt;null&gt;,type=class $Proxy29,value=[MBeanServerInvocationHandler]com.bea:Name=alphadomain,Type=Domain,state=SET]].&gt;
&lt;2011-03-30 09:54:36,454&gt; &lt;DEBUG&gt; &lt;MethodUtilsImpl&gt; &lt;Starting to resolve getter methods from &lt;[MBeanServerInvocationHandler]com.bea:Name=alphadomain,Type=Domain&gt; using attribute &lt;Notes&gt; and method matcher &lt;com.alpha.pineapple.plugin.weblogic.jmx.model.mbeans.MBeansGetterMethodMatcherImpl@1e88c7f&gt;.&gt;
&lt;2011-03-30 09:54:36,454&gt; &lt;DEBUG&gt; &lt;MethodUtilsImpl&gt; &lt;Successfully resolved getters methods on object &lt;[MBeanServerInvocationHandler]com.bea:Name=alphadomain,Type=Domain&gt; with result &lt;[Ljava.lang.reflect.Method;@383efa[{public final java.lang.String $Proxy29.getNotes()}]&gt;.&gt;
&lt;2011-03-30 09:54:36,454&gt; &lt;DEBUG&gt; &lt;MBeansModelAccessorImpl&gt; &lt;Starting to get MBean model object from object &lt;[MBeanServerInvocationHandler]com.bea:Name=alphadomain,Type=Domain&gt; using method &lt;public final java.lang.String $Proxy29.getNotes()&gt;.&gt;
&lt;2011-03-30 09:54:36,454&gt; &lt;DEBUG&gt; &lt;ResolvedModelBuilderVisitorImpl&gt; &lt;Created resolved object [com.alpha.pineapple.resolvedmodel.ResolvedPrimitive@12a801[primaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@2fbd59[name=Notes,exception=&lt;null&gt;,type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@c8f0a4,value=&lt;null&gt;,state=FAILED],secondaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@d41115[name=Notes,exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: Failed to resolve MBean attribute [Notes] due to exception [java.lang.reflect.InvocationTargetException].,type=class java.lang.String,value=&lt;null&gt;,state=FAILED]]].&gt;
</pre></div></div><div class="section"><h4>106) Document 100,105 +106<a name="a106_Document_100105_106"></a></h4></div><div class="section"><h4>111) Replace usage of Dynamic proxies in MBean resolved model with Object names<a name="a111_Replace_usage_of_Dynamic_proxies_in_MBean_resolved_model_with_Object_names"></a></h4><p>State with Domain dynamic proxy in the operation class which constitues the root of the reosolved model. </p></div><div class="section"><h4>113) Test of wldf-system-resource.target fails due to comparison between string and an object name<a name="a113_Test_of_wldf-system-resource.target_fails_due_to_comparison_between_string_and_an_object_name"></a></h4><div class="source"><pre class="prettyprint linenums">Test failed, because the attribute values was not equal 
[admserver] vs. [{[MBeanServerInvocationHandler]com.bea:Name=admserver,Type=Server}].
</pre></div></div><div class="section"><h4>122) Document ResolvedModelIntializerImpl<a name="a122_Document_ResolvedModelIntializerImpl"></a></h4></div><div class="section"><h4>124) TestDeployedConfigurationIntegrationTest.testCanExecuteWithDomainWithSingleMachine fails<a name="a124_TestDeployedConfigurationIntegrationTest.testCanExecuteWithDomainWithSingleMachine_fails"></a></h4></div><div class="section"><h4>131 )CreateMBeanCommand.resolveFactoryMethodName() must support object names <a name="a131_CreateMBeanCommand.resolveFactoryMethodName_must_support_object_names"></a></h4></div><div class="section"><h4>132 )Determine how to handle mapping of string values to (Server) object names i SetMBeanAttribute<a name="a132_Determine_how_to_handle_mapping_of_string_values_to_Server_object_names_i_SetMBeanAttribute"></a></h4><p>Currently implemented in the <tt>SetMBeanAttribute.convertAttributeValue()</tt></p><p>Should it be moved to the <tt>SpecialCasesAttributeMapper</tt>? </p></div><div class="section"><h4>138) Strng arrays isn't rendering correct by XMLBeansDescription generator:<a name="a138_Strng_arrays_isnt_rendering_correct_by_XMLBeansDescription_generator:"></a></h4><p>Example: XMLBean: weblogic.management.runtime.JRockitRuntimeMBean:harvested-type attribute: HarvestedAttribute=[Ljava.lang.String;@406f2f</p></div><div class="section"><h4>139) Execution result object isn't updated correctly for created MBeans with failed attributes<a name="a139_Execution_result_object_isnt_updated_correctly_for_created_MBeans_with_failed_attributes"></a></h4></div><div class="section"><h4>149) visit(ResolvedCollection...) in MBeansCreatorVisitorImpl doesn't complete the execution state<a name="a149_visitResolvedCollection..._in_MBeansCreatorVisitorImpl_doesnt_complete_the_execution_state"></a></h4><p>The execution state is set by the <tt>PreOrderDirectorImpl</tt>:</p><div class="source"><pre class="prettyprint linenums">    // if result is executing then compute its state
        Object[] args = { type };
        currentResult.completeAsComputed(messageProvider, &quot;prod.completed&quot;, args);                              
</pre></div><p>which gives the result:</p><div class="source"><pre class="prettyprint linenums">Message: Completed traversing resolved type [
com.alpha.pineapple.resolvedmodel.ResolvedCollection@1363a43[
primaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@a4196e[
name=HarvestedType,exception=&lt;null&gt;,
type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@181af25,
value={&lt;xml-fragment xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; xmlns:sec=&quot;http://www.bea.com/ns/weblogic/90/security&quot; xmlns:wdf=&quot;http://www.bea.com/ns/weblogic/90/diagnostics&quot; xmlns:wjp=&quot;http://www.bea.com/ns/weblogic/920/domain&quot; xmlns:wls=&quot;http://www.bea.com/ns/weblogic/90/security/wls&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance...},
state=SET],
secondaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@87dc72[
name=HarvestedType,
exception=&lt;null&gt;,
type=class [Lweblogic.diagnostics.descriptor.WLDFHarvestedTypeBean;,
value={},
state=SET]]].
</pre></div></div><div class="section"><h4>141) Fails to set JMXNotification attribute on Watch MBean <a name="a141_Fails_to_set_JMXNotification_attribute_on_Watch_MBean"></a></h4></div><div class="section"><h4>142) Fails to set SNMPNotification attribute on Watch MBean<a name="a142_Fails_to_set_SNMPNotification_attribute_on_Watch_MBean"></a></h4></div><div class="section"><h4>143) Fails to set xxNotification attribute on Watch MBean<a name="a143_Fails_to_set_xxNotification_attribute_on_Watch_MBean"></a></h4></div></div><div class="section"><h3>Resolved TDD Notes <a name="Resolved_TDD_Notes"></a></h3><div class="section"><h4>OK - 1) @Deprecated DeployConfigurationJMXEditVisitorImpl<a name="OK_-_1_Deprecated_DeployConfigurationJMXEditVisitorImpl"></a></h4><p>OK - <tt>junk.DeployConfigurationJMXEditVisitorImpl</tt> is deprecated and should be deleted from the project when the functionality is migrated to other classes.</p></div><div class="section"><h4>OK - 2) @Deprecated DeployConfigurationTestJMXEditVisitorImpl<a name="OK_-_2_Deprecated_DeployConfigurationTestJMXEditVisitorImpl"></a></h4><p>OK - <tt>junk.DeployConfigurationTestJMXEditVisitorImpl</tt> is deprecated and should be deleted from the projekt when the functionality is migrated to other classes. </p></div><div class="section"><h4>OK - 5) @Deprecated XmlBeansTraversalDirectorImpl<a name="OK_-_5_Deprecated_XmlBeansTraversalDirectorImpl"></a></h4><p>OK - <tt>junk.XmlBeansTraversalDirectorImpl</tt> is deprecated and should removed from the project.</p><p>OK - Removed reference from spring config.</p><p>OK - <tt>junk.XmlBeansTraversalDirectorImpl</tt> is replaced by <tt>DefaultModelTraversalDirectorImpl</tt> and should deleted from the project when all logic is migrated to <tt>DefaultModelTraversalDirectorImpl</tt>. </p></div><div class="section"><h4>OK - 6) @Deprecated TraversalDirector <a name="OK_-_6_Deprecated_TraversalDirector"></a></h4><p>OK - <tt>junk.TraversalDirector</tt> is deprecated and should be removed from the project.</p></div><div class="section"><h4>OK - ) Reimplement TraversalDescriptionGenerator<a name="OK_-__Reimplement_TraversalDescriptionGenerator"></a></h4><p>OK - <tt>junk.TraversalDescriptionGenerator</tt> should be reimplemented as an <tt>ResolvedModelVisitor</tt>.</p></div><div class="section"><h4>OK - 8) Extend ResolvedModelVisitor<a name="OK_-_8_Extend_ResolvedModelVisitor"></a></h4><p>OK - Extend the <tt>com.alpha.pineapple.plugin.weblogic.jmx.model.resolved.ResolvedModelVisitor</tt> interface to return a object, som that it can be to solved TTD note 7.</p></div><div class="section"><h4>OK - 9) @Deprecated TestDeployedConfigurationVisitorImpl<a name="OK_-_9_Deprecated_TestDeployedConfigurationVisitorImpl"></a></h4><p>OK - <tt>junk.TestDeployedConfigurationVisitorImpl</tt> should reimplemented as an resolved model vistitor </p></div><div class="section"><h4>OK - 10) @Deprecated XmlBeansDescriptionGeneratorImpl<a name="OK_-_10_Deprecated_XmlBeansDescriptionGeneratorImpl"></a></h4><p>OK - <tt>com.alpha.pineapple.plugin.weblogic.jmx.model.xmlbeans.traversal.XmlBeansDescriptionGeneratorImpl</tt> should be replaced by TTD note 7. </p></div><div class="section"><h4>OK - 11) @Deprecated XmlBeansModelVisitor<a name="OK_-_11_Deprecated_XmlBeansModelVisitor"></a></h4><p>OK - <tt>junk.XmlBeansModelVisitor</tt> is replaced by <tt>ResolvedmodelVisitor</tt>.</p><p>OK - The interface is deprecated.</p><p>OK Should be deleted from the project.</p></div><div class="section"><h4>OK - 12) Refactor XmlBeansModelBuilderImpl into a generic XMLBeans model traversal director<a name="OK_-_12_Refactor_XmlBeansModelBuilderImpl_into_a_generic_XMLBeans_model_traversal_director"></a></h4><p>OK - Created the class <tt>DefaultModelTraversalDirectorImpl</tt></p></div><div class="section"><h4>OK - 16) Rename TraversalPairAnswer<a name="OK_-_16_Rename_TraversalPairAnswer"></a></h4><p>OK - rename <tt>com.alpha.testutils.TraversalPairAnswer</tt> to <tt>com.alpha.testutils.ResolvedTypeAnswer</tt> </p></div><div class="section"><h4>OK - 17) Values contains XML in reports at level2, e.g Server and attributes<a name="OK_-_17_Values_contains_XML_in_reports_at_level2_e.g_Server_and_attributes"></a></h4></div><div class="section"><h4>OK - 20) TestAttributeValueCommand doesn't resolved the two test values properly <a name="OK_-_20_TestAttributeValueCommand_doesnt_resolved_the_two_test_values_properly"></a></h4><p>The error message dones't contain resolved test values by the message source, but: Test failed, because the attribute values wasnt equal [<a name="a0">0</a>] vs. [<a name="a1">1</a>]. </p></div><div class="section"><h4>OK - 21) TestArrayCommand always fails on type check <a name="OK_-_21_TestArrayCommand_always_fails_on_type_check"></a></h4><p>Test failed, because primary participant wasnt an array, but the type [<a name="a0">0</a>]. Also the values doesnt get resolved by the message source.</p></div><div class="section"><h4>OK - 23) Document new algorithm in <tt>DefaultModelTraversalDirectorImpl</tt><a name="OK_-_23_Document_new_algorithm_in_DefaultModelTraversalDirectorImpl"></a></h4></div><div class="section"><h4>OK - 24) Refactor hardwired <tt>XmlBeansDescriptionGeneratorImpl</tt> dependency away from <tt>DefaultModelTraversalDirectorImpl</tt><a name="OK_-_24_Refactor_hardwired_XmlBeansDescriptionGeneratorImpl_dependency_away_from_DefaultModelTraversalDirectorImpl"></a></h4></div><div class="section"><h4>OK - 25) <tt>TestObjectIdentityCommand</tt> gives wrong message <a name="OK_-_25_TestObjectIdentityCommand_gives_wrong_message"></a></h4><p>Example: SecurityConfiguration:security-configuration Message: Successfully compared object values which where null. But both participants where resolved an set.</p></div><div class="section"><h4>OK - 27) Rename <tt>TestArrayAttributeCommand</tt><a name="OK_-_27_Rename_TestArrayAttributeCommand"></a></h4><p>Should be called TestCollectionValueCommand...</p></div><div class="section"><h4>OK 31) Refactory XmlBeansModelBuilderVisitorImpl in to generic builder<a name="OK_31_Refactory_XmlBeansModelBuilderVisitorImpl_in_to_generic_builder"></a></h4><p>The method XmlBeansModelBuilderVisitorImpl.createResolvedType contains XMLBean specific code, see TDD note #15.</p><p>Is refactored into <tt>ResolvedModelBuilderVisitorImpl</tt>.</p></div><div class="section"><h4>OK - 29) Refactor XmlBeansModelBuilderVisitorImpl into a generic builder visitor<a name="OK_-_29_Refactor_XmlBeansModelBuilderVisitorImpl_into_a_generic_builder_visitor"></a></h4><p><tt>xmlBeansDescriptionGenerator</tt> should be injected using constructor injection.</p></div><div class="section"><h4>OK - 15) Move collection type resolution in XmlBeansModelBuilderVisitorImpl to model accessor<a name="OK_-_15_Move_collection_type_resolution_in_XmlBeansModelBuilderVisitorImpl_to_model_accessor"></a></h4><p>TODO: The method XmlBeansModelBuilderVisitorImpl.createResolvedType contains XMLBeans specific logic to resolve an XMLBean array/collection type. This code should be moved to the XMLBean model accessor.</p><p>Is refactored into <tt>ResolvedModelBuilderVisitorImpl</tt>. XMLBeans specific logic is refactored into XMLBeansModelResolverImpl.createResolvedType </p></div><div class="section"><h4>OK - 34) Document MBeansModelResolverImpl can't create resolved model entities<a name="OK_-_34_Document_MBeansModelResolverImpl_cant_create_resolved_model_entities"></a></h4></div><div class="section"><h4>OK - 33c) XmlBeansModelAccessor.isPrimitive( ResolvedType pair ) is deprecated<a name="OK_-_33c_XmlBeansModelAccessor.isPrimitive_ResolvedType_pair__is_deprecated"></a></h4><p>Test should be refactored to <tt>isPrimitive( ResolvedParticipant participant )</tt> </p></div><div class="section"><h4>OK - 33b) XmlBeansModelAccessor.isEnum( ResolvedType pair ) is deprecated<a name="OK_-_33b_XmlBeansModelAccessor.isEnum_ResolvedType_pair__is_deprecated"></a></h4><p>Test should be refactored to <tt>isEnum( ResolvedParticipant participant )</tt> </p></div><div class="section"><h4>OK - 33a) XmlBeansModelAccessor.isArray( ResolvedType pair ) is deprecated<a name="OK_-_33a_XmlBeansModelAccessor.isArray_ResolvedType_pair__is_deprecated"></a></h4><p>Test should be refactored to <tt>isCollection( ResolvedParticipant participant )</tt> </p></div><div class="section"><h4>OK - 37) fix bug in XMLBeansModelResolver.createResolvedType()<a name="OK_-_37_fix_bug_in_XMLBeansModelResolver.createResolvedType"></a></h4><p>semantics isn't clearly defined if </p><div class="source"><pre class="prettyprint linenums">if(modelAccessor.isArray( primary ) ) {                         
        if(parent.getPrimaryParticipant().getType() != primary.getType() ) {
                return ResolvedTypeImpl.createResolvedCollection(parent, primary, secondary);                                   
        }                               
}

</pre></div><p>where isArray( primary ) == true and parent.getPrimaryParticipant().getType() != primary.getType() == false </p><p>==&gt; falls through is that correct?</p></div><div class="section"><h4>OK - 38) Add I18N support for XMLBeansModelAccessorImpl<a name="OK_-_38_Add_I18N_support_for_XMLBeansModelAccessorImpl"></a></h4></div><div class="section"><h4>OK - 40) TestDeployedConfiuguration.getDomainXmlBeanSchemaProperty is deprecated<a name="OK_-_40_TestDeployedConfiuguration.getDomainXmlBeanSchemaProperty_is_deprecated"></a></h4><p>Use the method XmlBeansModelAccessorImpl.getSchemaPropertyByName instead.</p></div><div class="section"><h4>OK - 13) Refactor resolution of XMLBean collection/array type in XmlBeansModelResolverImpl to XmlBeanModelAccessor <a name="OK_-_13_Refactor_resolution_of_XMLBean_collectionarray_type_in_XmlBeansModelResolverImpl_to_XmlBeanModelAccessor"></a></h4></div><div class="section"><h4>OK - 32) Implement ModelAccessor for generic builder<a name="OK_-_32_Implement_ModelAccessor_for_generic_builder"></a></h4><p>Se TDD31 + TDD15.</p></div><div class="section"><h4>OK - 39) Document representation/resolution of collections in XMLBeans model <a name="OK_-_39_Document_representationresolution_of_collections_in_XMLBeans_model"></a></h4><ul><li>IMPORTANT!!! *** XmlBeansModeResolverImpl.resolveArrayAttributeValues(..) reuses the type of the &quot;array&quot; as the type for each array entry value.<p>OK - XmlBeansModelAccessorImpl.isCollection(..) must be able to handle this case.. </p></li></ul></div><div class="section"><h4>OK - 35) Rename ModelResolver.resolveArrayAttributeValues<a name="OK_-_35_Rename_ModelResolver.resolveArrayAttributeValues"></a></h4><p>Should be renamed to ModelResolver.resolveCollectionValues</p></div><div class="section"><h4>OK - 30) Deprecate ModelResolver.resolveAttribute( String attributeName, Object modelObject )<a name="OK_-_30_Deprecate_ModelResolver.resolveAttribute_String_attributeName_Object_modelObject_"></a></h4><p>All usage should be replaced by the method <tt>resolveAttribute( String attributeName, ResolvedParticipant attribute )</tt>.</p></div><div class="section"><h4>OK - 36) Refactor ModelResolver.resolveAttribute( String attributeName, Object modelObject ) out<a name="OK_-_36_Refactor_ModelResolver.resolveAttribute_String_attributeName_Object_modelObject__out"></a></h4><p>All usages of the method should be replace with the method ModelResolver.resolveAttribute( String attributeName, ResolvedParticipant modelObject ).</p></div><div class="section"><h4>OK - 42) Remove JMXSession from ResolvedModelBuilderVisitorImpl<a name="OK_-_42_Remove_JMXSession_from_ResolvedModelBuilderVisitorImpl"></a></h4><p>ResolvedModelBuilderVisitorImpl contains a WeblogicJMXEditSession field.</p></div><div class="section"><h4>OK - 44) Remove setSession(..) calls in TestDeployedConfiguration<a name="OK_-_44_Remove_setSession.._calls_in_TestDeployedConfiguration"></a></h4></div><div class="section"><h4>OK - 45) Remove setSession(..) from ResolvedModelVisitor interface and implementations<a name="OK_-_45_Remove_setSession.._from_ResolvedModelVisitor_interface_and_implementations"></a></h4></div><div class="section"><h4>OK - 43) Remove xmlBeansDescriptionGenerator bean reference from ResolvedModelBuilderVisitorImpl<a name="OK_-_43_Remove_xmlBeansDescriptionGenerator_bean_reference_from_ResolvedModelBuilderVisitorImpl"></a></h4><p>@Resource(name=&quot;xmlBeansDescriptionGenerator&quot;) ResolvedModelVisitor descriptionGenerator;</p><p>Should be moved to Spring config. </p></div><div class="section"><h4>OK - 47) MesseageSource doesn't resolve tcvc.secondary_resolution_failed properly<a name="OK_-_47_MesseageSource_doesnt_resolve_tcvc.secondary_resolution_failed_properly"></a></h4><p>Same solution as TDD-48.</p></div><div class="section"><h4>OK - 48) MesseageSource doesn't resolve tavc.secondary_resolution_failed properly<a name="OK_-_48_MesseageSource_doesnt_resolve_tavc.secondary_resolution_failed_properly"></a></h4><p>Solved the problem by substituting the error message:</p><p>OLD: Test failed, because secondary participant wasn't resolved successfully due to exception [<a name="a0">0</a>]. NEW: Test failed, because resolution of secondary participant failed with exception [<a name="a0">0</a>].</p></div><div class="section"><h4>OK - 46) Name attribute isn't resolved for authentication-provider's MBeans<a name="OK_-_46_Name_attribute_isnt_resolved_for_authentication-providers_MBeans"></a></h4><p>e.g. for DefaultIdentityAsserter and DefaultAuthenticator.</p><p>Added: weblogic.security.providers.authentication package to MBeansGetterMethodMatcherImpl as an MBean legal MBean package. </p></div><div class="section"><h4>OK - 28a) Object identity tests with doesn't fail if children fails<a name="OK_-_28a_Object_identity_tests_with_doesnt_fail_if_children_fails"></a></h4><p>if an &quot;composite&quot; test like object identity or collection value doesn fail even though of its children fails.</p><p>Successful state is changed from completeAsSuccessful to completeAsComputed </p></div><div class="section"><h4>OK - 28b) Collection value tests with doesn't fail if children fails<a name="OK_-_28b_Collection_value_tests_with_doesnt_fail_if_children_fails"></a></h4><p>if an &quot;composite&quot; test like object identity or collection value doesn fail even though of its children fails.</p><p>Successful state is changed from completeAsSuccessful to completeAsComputed</p></div><div class="section"><h4>OK - 57) Document PreOrderDirectorImpl<a name="OK_-_57_Document_PreOrderDirectorImpl"></a></h4></div><div class="section"><h4>OK - 58) Document PostOrderDirectorImpl<a name="OK_-_58_Document_PostOrderDirectorImpl"></a></h4></div><div class="section"><h4>OK - 61) Deleted ModelTraversalDirectorImpl<a name="OK_-_61_Deleted_ModelTraversalDirectorImpl"></a></h4></div><div class="section"><h4>OK - 54) If collection resolution fails then execution result should fail<a name="OK_-_54_If_collection_resolution_fails_then_execution_result_should_fail"></a></h4><p>If resolution of an collection then execution result for the collection should fail.</p><p>Examples: Authorizer:authorizer[] + RoleMapper:role-mapper[]</p><p>Resolution of the role mapper collection fails on the secondary participant, e.g. the MBean:</p><p>Message: Test failed, because resolution of secondary participant failed with exception [com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: Failed to resolve MBean attribute [RoleMapper] due to exception [java.lang.reflect.InvocationTargetException].]. </p></div><div class="section"><h4>OK - 67) Implement support for resolution of entities which isnt defined in primary model<a name="OK_-_67_Implement_support_for_resolution_of_entities_which_isnt_defined_in_primary_model"></a></h4><p>This test case currently fails:</p><p>The xml-model has defined = DefaultAuthenticatorXX + DefaultIdentityAsserter The mbean model has defined = DefaultAuthenticator + DefaultIdentityAsserter</p><p>Durin resolution of DefaultAuthenticator the primary resolver fails as the object with that id isnt defined in the primiary model. the the secondary resolver is invoke and it currebtly doesnt support creation of resolved types. = Error. </p><div class="source"><pre class="prettyprint linenums">
          &lt;sec:authentication-provider xsi:type=&quot;wls:default-authenticatorType&quot;&gt;
                &lt;sec:name&gt;DefaultAuthenticatorXX&lt;/sec:name&gt;
          &lt;/sec:authentication-provider&gt;
          &lt;sec:authentication-provider xsi:type=&quot;wls:default-identity-asserterType&quot;&gt;
                &lt;sec:name&gt;DefaultIdentityAsserter&lt;/sec:name&gt;
                &lt;sec:active-type&gt;AuthenticatedUser&lt;/sec:active-type&gt;
          &lt;/sec:authentication-provider&gt;
                                        

</pre></div></div><div class="section"><h4>OK - 70) If object child test fails then execution result should fail for object test<a name="OK_-_70_If_object_child_test_fails_then_execution_result_should_fail_for_object_test"></a></h4><p>..example: SecurityConfiguration:security-configuration test doesn't fail even though child test fails.</p></div><div class="section"><h4>OK - 71) If collection child test fails then execution result should fail for collection test<a name="OK_-_71_If_collection_child_test_fails_then_execution_result_should_fail_for_collection_test"></a></h4><p>..example: myrealm:realm test doesn't fail even though child Rolemapper test fails.</p></div><div class="section"><h4>OK - 69) Find out why the role mapper can't be resolved<a name="OK_-_69_Find_out_why_the_role_mapper_cant_be_resolved"></a></h4><p>the resolution of the role mapper collection fails on the secondary participant, e.g. the MBean. +--- <i>sec:role-mapper xmlns:xac=&quot;http://www.bea.com/ns/weblogic/90/security/xacml&quot; xsi:type=&quot;xac:xacml-role-mapperType&quot;</i><i>/sec:role-mapper</i> +--- </p><p>Illustrated in example: weblogic-jmx-example-0.6.4</p><p>From the log:</p><div class="source"><pre class="prettyprint linenums">        &lt;MBeansModelResolverImpl&gt; &lt;Starting to resolve MBean attribute [RoleMapper] from [com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@4e9bea[name=myrealm,exception=&lt;null&gt;,type=class $Proxy41,value=[MBeanServerInvocationHandler]Security:Name=myrealm,state=SET]].&gt;
        &lt;MethodUtilsImpl&gt; &lt;Starting to resolve getter methods from &lt;[MBeanServerInvocationHandler]Security:Name=myrealm&gt; using attribute &lt;RoleMapper&gt; and method matcher &lt;com.alpha.pineapple.plugin.weblogic.jmx.model.mbeans.MBeansGetterMethodMatcherImpl@1357784&gt;.&gt;
        &lt;MethodUtilsImpl&gt; &lt;Successfully resolved getters methods on object &lt;[MBeanServerInvocationHandler]Security:Name=myrealm&gt; with result &lt;[Ljava.lang.reflect.Method;@198c113[{public final weblogic.management.security.authorization.RoleMapperMBean[] $Proxy41.getRoleMappers()}]&gt;.&gt;
        &lt;MBeansModelAccessorImpl&gt; &lt;Starting to get MBean model object from object &lt;[MBeanServerInvocationHandler]Security:Name=myrealm&gt; using method &lt;public final weblogic.management.security.authorization.RoleMapperMBean[] $Proxy41.getRoleMappers()&gt;.&gt;
        &lt;ResolvedModelBuilderVisitorImpl&gt; &lt;Created resolved object [com.alpha.pineapple.resolvedmodel.ResolvedCollection@1217fef[primaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@899e6a[name=RoleMapper,exception=&lt;null&gt;,type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@ff665a,value={},state=SET],secondaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@562791[name=RoleMapper,exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: Failed to resolve MBean attribute [RoleMapper] due to exception [java.lang.reflect.InvocationTargetException].,type=class [Lweblogic.management.security.authorization.RoleMapperMBean;,value=&lt;null&gt;,state=FAILED]]].&gt;
</pre></div><p>The problem is illustrated by the test case: MBeansModelAccessorIntegrationTest.testCanGetModelObjectOnRealmMBeanWhichIsRoleMapper .. which fails with the stack trace: Caused by: java.lang.NoClassDefFoundError: com/bea/common/security/xacml/policy/Policy .. the problem is solved by adding hte cssapi.jar </p></div><div class="section"><h4>OK - 74) Find out why the resolution of nunamed role mapper doesn't fail<a name="OK_-_74_Find_out_why_the_resolution_of_nunamed_role_mapper_doesnt_fail"></a></h4><p>The model defines:</p><div class="source"><pre class="prettyprint linenums">  &lt;sec:role-mapper xmlns:xac=&quot;http://www.bea.com/ns/weblogic/90/security/xacml&quot; xsi:type=&quot;xac:xacml-role-mapperType&quot;&gt;&lt;/sec:role-mapper&gt;
</pre></div><p>..which is resolved to the name = null. ..but the aplha-domain MBean model contains a role mapper named XACMLRoleMapper.</p><p>Why doesn't this produce a resolution error?</p><p>The answer is:</p><ul><li>First entry in the combined map is XACMLRoleMapper, where the resolution of the primary participant fails as it doesn't contains the mapper named XACMLRoleMapper. Then the secondary is resolved from the MBean model, but the creation of a resolved object fails as the MBean resolver doesn't support this. The exception is caught by the builder visitor which create an unresolve type object to capture the effort. </li><li>Second entry in the map is null, where the resolution of the primary participant succceeds but the resolution of the secondary participant fails as the null mapper isn defined in the MBean model. </li><li>Hence the nu resolution errors.</li></ul><p>Illustrated in example: weblogic-jmx-example-0.6.4</p></div><div class="section"><h4>OK - 73) Find out why the adjudicator can be resolved<a name="OK_-_73_Find_out_why_the_adjudicator_can_be_resolved"></a></h4><p>Why doesnt this xml fail when TTD71+72 does? </p><div class="source"><pre class="prettyprint linenums">  &lt;sec:adjudicator xsi:type=&quot;wls:default-adjudicatorType&quot;&gt;&lt;/sec:adjudicator&gt;
</pre></div><p>Illustrated in example: weblogic-jmx-example-0.6.6</p><p>The reason is that the realm only defines one adjudicator and hence the adjucator is resolved as an object and the name isn't used during the resolution process.</p></div><div class="section"><h4>OK - 76a) Verify that unnamed authentication providers can be resolved and tested<a name="OK_-_76a_Verify_that_unnamed_authentication_providers_can_be_resolved_and_tested"></a></h4><p>Tested in ResolvedModelBuilderVisitorIntegrationTest.testAuthenticationProviderCollectionWithUnnamedProvider():</p></div><div class="section"><h4>OK - 76b) Verify that named authentication providers can be resolved and tested<a name="OK_-_76b_Verify_that_named_authentication_providers_can_be_resolved_and_tested"></a></h4><p>Tested in ResolvedModelBuilderVisitorIntegrationTest.testAuthenticationProviderCollectionWithNamedProvider():</p></div><div class="section"><h4>OK - 82) Document MBeansModelResolverImpl.createNonExistingCollectionValue<a name="OK_-_82_Document_MBeansModelResolverImpl.createNonExistingCollectionValue"></a></h4></div><div class="section"><h4>OK - 83) Provide proper implementation of XmlBeansModelResolverImpl.createNonExistingCollectionValue<a name="OK_-_83_Provide_proper_implementation_of_XmlBeansModelResolverImpl.createNonExistingCollectionValue"></a></h4></div><div class="section"><h4>OK - 85) Document XmlBeansModelResolverImpl.createNonExistingCollectionValue<a name="OK_-_85_Document_XmlBeansModelResolverImpl.createNonExistingCollectionValue"></a></h4></div><div class="section"><h4>OK - 80) Creation of MBean fails<a name="OK_-_80_Creation_of_MBean_fails"></a></h4><p>Creation of MBean fails in CreateMBeanCommand due to missing type information in resolution of collection values. - algoritm for collection resolution in the ResolvedModelBuilderVisitorImpl: line 2041ff</p><p>During traversal with the ResolvedModelBuilderVisitorImpl:</p><p>a) visit(ResolvedCollection resolvedCollection,...) </p><p>b) getResolvedCollectionValue:</p><p>3) primary = getResolvedCollectionValue( id, primaryCollectionValues ); 4) secondary = getResolvedCollectionValue( id, secondaryCollectionValues );</p><p>c) getResolvedCollectionValue - value is looked up in seconary value colllection, but not found. - then a failed participant is created: ResolvedParticipantImpl@19fe5e6[ name=<i>null</i>, exception=ModelResolutionFailedException: Failed to resolve collection value [internalmachine1] from collection which contained the values []., type=<i>null</i>, value=<i>null</i>, state=FAILED]&gt;</p><p>...during traversal with the MBeansCreatorVisitorImpl: </p><p>d) visit(ResolvedObject resolvedObject...)</p><p>e) CreateMBeanCommand.execute(...) fails because it lacks type information due to created participant in step c)</p><p>Solutions: a) add required type info in step c) b) aquire type info in step e)</p><p>Solution: Add ModelResolver.createNonExistingCollectionValue which is invoked in step b).</p></div><div class="section"><h4>OK - 90) Creation of int property snmp-port in SNMPAgent fails.<a name="OK_-_90_Creation_of_int_property_snmp-port_in_SNMPAgent_fails."></a></h4><p>The solution is modify the comparsion of MBean attribute names in SetMBeanAttributeCommand.findAttributeInfo to ignore upper/lower case: if ( attributeInfo.getName().equalsIgnoreCase( attributeID ) )</p></div><div class="section"><h4>OK - 91) Resolution of SnmpTrapDestination fails <a name="OK_-_91_Resolution_of_SnmpTrapDestination_fails"></a></h4><p>The error:</p><div class="source"><pre class="prettyprint linenums">&lt;MBeansModelResolverImpl&gt; 
&lt;Starting to resolve values for MBean collection attribute 
[com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@128d1f4[
name=SnmpTrapDestination,
exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: 
Failed to resolve MBean attribute [SnmpTrapDestination] as no getter method could be resolved from MBean 
[[MBeanServerInvocationHandler]com.bea:Name=alphadomain,
Type=SNMPAgent].,
type=&lt;null&gt;,value=&lt;null&gt;,state=FAILED]].&gt;

Description: SnmpTrapDestination:snmp-trap-destination[]
</pre></div><p>StackTrace:</p><div class="source"><pre class="prettyprint linenums">java.lang.NullPointerException
        at com.alpha.pineapple.plugin.weblogic.jmx.model.mbeans.MBeansModelResolverImpl.resolveCollectionAttributeValues(MBeansModelResolverImpl.java:149)
        at com.alpha.pineapple.resolvedmodel.traversal.ResolvedModelBuilderVisitorImpl.visit(ResolvedModelBuilderVisitorImpl.java:170)
        at com.alpha.pineapple.resolvedmodel.ResolvedCollection.accept(ResolvedCollection.java:25)
        at com.alpha.pineapple.resolvedmodel.traversal.PreOrderDirectorImpl.traverse(PreOrderDirectorImpl.java:95)
        at com.alpha.pineapple.resolvedmodel.traversal.PreOrde
</pre></div><p>During traversal with the ResolvedModelBuilderVisitorImpl:</p><p>a) ModelBuilderVisitor.visit(ResolvedObject resolvedObject,...)</p><p>b) MBeansModelResolverImpl..resolveAttribute( attributeName, resolvedObject.getSecondaryParticiant() <i>2011-03-22 13:26:00,546</i> <i>DEBUG</i> <i>MBeansModelResolverImpl</i> <i>Starting to resolve MBean attribute [SnmpTrapDestination] from [com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1e07d3e[name=SnmpAgent,exception=&lt;null</i>,type=interface weblogic.management.configuration.SNMPAgentMBean,value=[MBeanServerInvocationHandler]com.bea:Name=alphadomain,Type=SNMPAgent,state=SET]].&gt;</p><p>c) MBeansModelAccessorImpl.resolveGetterMethod( attributeName, mbean ):</p><p>d) resolveGetterMethods( Object targetObject, String attributeName, GetterMethodMatcher matcher ) <i>2011-03-22 13:26:00,546</i> <i>DEBUG</i> <i>MethodUtilsImpl</i> <i>Starting to resolve getter methods from &lt;[MBeanServerInvocationHandler]com.bea:Name=alphadomain,Type=SNMPAgent</i> using attribute <i>SnmpTrapDestination</i> and method matcher <i>com.alpha.pineapple.plugin.weblogic.jmx.model.mbeans.MBeansGetterMethodMatcherImpl@1245e75</i>.&gt; <i>2011-03-22 13:26:00,546</i> <i>DEBUG</i> <i>MethodUtilsImpl</i> <i>Successfully resolved getters methods on object &lt;[MBeanServerInvocationHandler]com.bea:Name=alphadomain,Type=SNMPAgent</i> with result <i>[Ljava.lang.reflect.Method;@19fef7b[<a name="public_final_weblogic.management.configuration.SNMPTrapDestinationMBean_Proxy36.getSNMPTrapDestinationspublic_final_weblogic.management.configuration.SNMPTrapDestinationMBean_Proxy36.getTargetedTrapDestinations">public final weblogic.management.configuration.SNMPTrapDestinationMBean[] $Proxy36.getSNMPTrapDestinations(),public final weblogic.management.configuration.SNMPTrapDestinationMBean[] $Proxy36.getTargetedTrapDestinations()</a>]</i>.&gt;</p><p>The problem is that multiple getter methods are resolved:</p><p>public final weblogic.management.configuration.SNMPTrapDestinationMBean[] $Proxy36.getSNMPTrapDestinations(), public final weblogic.management.configuration.SNMPTrapDestinationMBean[] $Proxy36.getTargetedTrapDestinations()}]&gt;.&gt;</p><p>..presented with the result the MBeansModelAccessorImpl.resolveGetterMethod(..) method returns null..</p><p>The solution: Return &quot;getSNMPTrapDestinations&quot; since &quot;getTargetedTrapDestinations&quot; is deprecated. The solution is implemented in ModelAccessor.resolveGetterMethod(..) method</p></div><div class="section"><h4>OK - 92) Creation of collection value fails<a name="OK_-_92_Creation_of_collection_value_fails"></a></h4><div class="source"><pre class="prettyprint linenums">&lt;wjp:domain &gt;
        &lt;wjp:server&gt;
                &lt;wjp:name&gt;ms1&lt;/wjp:name&gt;
        &lt;/wjp:server&gt;                           
</pre></div><p>Creation of ms1 fails with exception:</p><div class="source"><pre class="prettyprint linenums">&lt;2011-03-22 16:00:02,248&gt; &lt;DEBUG&gt; &lt;CreateMBeanCommand&gt; &lt;DEBUG parent value is null.&gt;
&lt;2011-03-22 16:00:02,264&gt; &lt;DEBUG&gt; &lt;ClassUtils&gt; &lt;Successfully verified existence of class &lt;weblogic.management.configuration.SNMPTrapDestinationMBean&gt;. &gt;
&lt;2011-03-22 16:00:02,264&gt; &lt;DEBUG&gt; &lt;CreateMBeanCommand&gt; &lt;DEBUG secondary type is dynamic MBean proxy: interface weblogic.management.configuration.SNMPTrapDestinationMBean&gt;
&lt;2011-03-22 16:00:02,264&gt; &lt;DEBUG&gt; &lt;CreateMBeanCommand&gt; &lt;DEBUG resolved operation id: createSNMPTrapDestination&gt;
&lt;2011-03-22 16:00:02,264&gt; &lt;DEBUG&gt; &lt;ExecutionResultImpl&gt; &lt;Message added with id [Message] and content [Creation of MBean failed with exception.].&gt;
&lt;2011-03-22 16:00:02,279&gt; &lt;DEBUG&gt; &lt;ExecutionResultImpl&gt; &lt;Message added with id [StackTrace] and content [javax.management.RuntimeOperationsException
        at weblogic.rjvm.ResponseImpl.unmarshalReturn(ResponseImpl.java:211)
        ..
        at javax.management.remote.rmi.RMIConnector$RemoteMBeanServerConnection.getMBeanInfo(RMIConnector.java:1031)
        at com.alpha.pineapple.plugin.weblogic.jmx.command.CreateMBeanCommand.createMBean(CreateMBeanCommand.java:256)
        at com.alpha.pineapple.plugin.weblogic.jmx.command.CreateMBeanCommand.execute(CreateMBeanCommand.java:143)
        at com.alpha.pineapple.command.execution.CommandRunnerImpl.run(CommandRunnerImpl.java:69)
        at com.alpha.pineapple.resolvedmodel.traversal.MBeansCreatorVisitorImpl.visit(MBeansCreatorVisitorImpl.java:97)
        ..
        at java.lang.Thread.run(Thread.java:595)
Caused by: java.lang.IllegalArgumentException: ObjectName must not be null
</pre></div><p>Since collections are presented as a explicit resolved collections, it represents the problem that the parent (i.e. the resolved collection) can't produce a valid object name to invoke the factory method on. </p><p>Solution: if the parent is resolved collection then resolve the parent object name from the parent's parent. </p></div><div class="section"><h4>OK - 96) Refactor ResolvedModelJmxUtils.validateSessionEditMode + saveChanges away<a name="OK_-_96_Refactor_ResolvedModelJmxUtils.validateSessionEditMode__saveChanges_away"></a></h4><p>use the methods on the session.... </p></div><div class="section"><h4>OK - 95) Test WebLogicjmxEditSession<a name="OK_-_95_Test_WebLogicjmxEditSession"></a></h4><p>that isEditSessionActive() return false after save and active.</p></div><div class="section"><h4>OK - 93) Creation of MBean attributes fails<a name="OK_-_93_Creation_of_MBean_attributes_fails"></a></h4><p>The problem is that the resolved participant for the MBean isn't updated after the MBean is created. </p></div><div class="section"><h4>OK - 29) TestEnumValueCommand always fails on type check<a name="OK_-_29_TestEnumValueCommand_always_fails_on_type_check"></a></h4><p>Resolved with TDD89.</p></div><div class="section"><h4>OK - 89) Test/Creation of enum property debug-level in SNMPAgent fails.<a name="OK_-_89_TestCreation_of_enum_property_debug-level_in_SNMPAgent_fails."></a></h4><p>Resolution</p><div class="source"><pre class="prettyprint linenums">        Completed traversing resolved type [com.alpha.pineapple.resolvedmodel.ResolvedEnum@10cface[
        primaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1c17a8c[
        name=SnmpTrapVersion,
        exception=&lt;null&gt;,
        type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@1549f0e,
        value=1,
        state=SET],
        &lt;secondaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@130cda4[
        name=SnmpTrapVersion,
        exception=&lt;null&gt;,
        type=int,
        value=1,
        state=SET]]].
</pre></div><p>Example enums: snmp-trap-version=1 debug-level=0</p><p>TestEnumValueCommand:</p><div class="source"><pre class="prettyprint linenums">    // validate whether primary participant is XMLBeans enum type
    if (!(primaryType instanceof StringEnumAbstractBase))  {
</pre></div><p>The problem that the primary type isn't <i>StringEnumAbstractBase</i> but <i>SchemaPropertyImpl</i>...</p><p>Type cast are to restrictive in the comaprison logic.</p></div><div class="section"><h4>OK - 101) Failed to set enabled-server property on SnmpLogFilter<a name="OK_-_101_Failed_to_set_enabled-server_property_on_SnmpLogFilter"></a></h4><p>Create message: +--- Description: enabled-server=admserver StackTrace: com.alpha.pineapple.plugin.weblogic.jmx.management.JMXManagmentException: Failed to assign value [admserver] due to exception: javax.management.InvalidAttributeValueException: argument type mismatch. at com.alpha.pineapple.plugin.weblogic.jmx.command.SetMBeanAttributeCommand.setAttributeValue(SetMBeanAttributeCommand.java:408) at com.alpha.pineapple.plugin.weblogic.jmx.command.SetMBeanAttributeCommand.setMBeanAttribute(SetMBeanAttributeCommand.java:281) at com.alpha.pineapple.plugin.weblogic.jmx.command.SetMBeanAttributeCommand.execute(SetMBeanAttributeCommand.java:142) at com.alpha.pineapple.command.execution.CommandRunnerImpl.run(CommandRunnerImpl.java:69) +--- </p><p>Resolution fails, see TDD102.</p><p>The SNMPLogFilterMBean contains a method with the name: addEnabledServers( serverObjName)</p><p>This attribute is applicable only when the SNMP Agent is running on the Admin Server of a WebLogic Domain. The EnabledServers attribute allows the users to limit the scope of the monitored data sources to the specific named Servers. The EnabledServers list is ignored when the SNMAgentDeploymentMBean is targeted to a Managed Server.</p><p>Solution:</p><p>The attribute resolution is implemented in MBeansModelAccessorImpl.findAttributeInfo(..) which remap the XMLBeans attribute name <i>EnabledServer</i> =&gt; MBean attribute name <i>EnabledServers</i>:</p><div class="source"><pre class="prettyprint linenums">    // custom logic to handle case for SNMPLogFilterMBean.EnabledServer
        // which is represented by the MBean attribute SNMPLogFilterMBean.EnabledServers 
        if ((isMBeanType(objName, &quot;SNMPLogFilter&quot;)) &amp;&amp; (attributeID == &quot;EnabledServer&quot; )) {

        if (attributeID == &quot;EnabledServer&quot; ) {                  
                attributeID = &quot;EnabledServers&quot;;
        }               
        }       
</pre></div><p>The next problem is that the MBean attribute set<i>EnabledServers</i> has an argument of type: <tt>javax.management.ObjectName[]</tt></p><p>The solution is to intrepret the values from the primary model as server names and: 1) lookup server using server name on domain Mbean =&gt; list of object names 2) add each object name. </p><p>The solution is implemented in SetMBeanAttributeCommand.convertAttributeValue():</p><div class="source"><pre class="prettyprint linenums">        // custom logic to handle case for SNMPLogFilterMBean.EnabledServers
        if ((mbeansModelAccessor.isMBeanType(objName, &quot;SNMPLogFilter&quot;)) &amp;&amp; (attributeInfo.getName().equals(&quot;EnabledServers&quot; ))) {
                return convertReferencedObjectNameAttributeValue(attributeValue, attributeInfo );
        }
                                
        // convert simple value to type exposed by MBean attribute
        return convertSimpleAttributeValue( attributeValue, attributeTypeClass, attributeInfo );
</pre></div></div><div class="section"><h4>OK - 105) Failed to set enabled-server property on SNMPStringMonitor<a name="OK_-_105_Failed_to_set_enabled-server_property_on_SNMPStringMonitor"></a></h4><div class="source"><pre class="prettyprint linenums">javax.management.MBeanException: 
MBean invoke failed: weblogic.management.mbeanservers.edit.ValidationException: 
        at weblogic.rjvm.ResponseImpl.unmarshalReturn(ResponseImpl.java:211)
        at weblogic.rmi.internal.BasicRemoteRef.invoke(BasicRemoteRef.java:224)
        at javax.management.remote.rmi.RMIConnectionImpl_923_WLStub.invoke(Unknown Source)
        at weblogic.management.remote.common.RMIConnectionWrapper$15.run(ClientProviderBase.java:606)
        at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:363)
        at weblogic.security.service.SecurityManager.runAs(SecurityManager.java:147)
        at weblogic.security.Security.runAs(Security.java:61)
        at weblogic.management.remote.common.RMIConnectionWrapper.invoke(ClientProviderBase.java:604)
        at javax.management.remote.rmi.RMIConnector$RemoteMBeanServerConnection.invoke(RMIConnector.java:972)
        at com.alpha.pineapple.plugin.weblogic.jmx.session.WeblogicJMXEditSessionImpl.saveAndActivate(WeblogicJMXEditSessionImpl.java:346)
        at com.alpha.pineapple.plugin.weblogic.jmx.command.CreateMBeanCommand.createMBean(CreateMBeanCommand.java:314)
        at com.alpha.pineapple.plugin.weblogic.jmx.command.CreateMBeanCommand.execute(CreateMBeanCommand.java:156)
        at com.alpha.pineapple.command.execution.CommandRunnerImpl.run(CommandRunnerImpl.java:69)
        at com.alpha.pineapple.resolvedmodel.traversal.MBeansCreatorVisitorImpl.visit(MBeansCreatorVisitorImpl.java:99)
        at com.alpha.pineapple.resolvedmodel.ResolvedObject.accept(ResolvedObject.java:25)
        ...
Caused by: weblogic.descriptor.DescriptorValidateException: The following failures occurred:
-- MonitoredAttributeName is a required value that has not been specified.

        at weblogic.descriptor.internal.AbstractDescriptorBeanHelper.validateSubTree(AbstractDescriptorBeanHelper.java:65)
        at weblogic.descriptor.internal.DescriptorImpl.validate(DescriptorImpl.java:290)
        at weblogic.management.provider.internal.EditAccessImpl.validateChanges(EditAccessImpl.java:612)
        at weblogic.management.provider.internal.EditAccessImpl.saveChanges(EditAccessImpl.java:647)
</pre></div><p>Solution is to move the save &amp; activate to the deploy operation and remove them from the SetMBean attribute and CreateMbean commands. TODO: document this...This introduces a all-or-nothing semantic in regard to saving changes.</p><p>Solution, extends TDD101:</p><p>The attribute resolution is implemented in MBeansModelAccessorImpl.findAttributeInfo(..) which remap the XMLBeans attribute name <i>EnabledServer</i> =&gt; MBean attribute name <i>EnabledServers</i>:</p><div class="source"><pre class="prettyprint linenums">        // custom logic to handle case for SNMPxxxxMBean.EnabledServer
        // which is represented by SNMPxxxxMBean.EnabledServers
        if (attributeID.equals(&quot;EnabledServers&quot; )) {                    
                if (isMBeanType(objName, &quot;SNMPLogFilter&quot;)) attributeID = &quot;EnabledServers&quot;;
                if (isMBeanType(objName, &quot;SNMPStringMonitor&quot;)) attributeID = &quot;EnabledServers&quot;;                  
                if (isMBeanType(objName, &quot;SNMPGaugeMonitor&quot;)) attributeID = &quot;EnabledServers&quot;;                                           
                if (isMBeanType(objName, &quot;SNMPCounterMonitor&quot;)) attributeID = &quot;EnabledServers&quot;;                                         
                if (isMBeanType(objName, &quot;SNMPJMXMonitor&quot;)) attributeID = &quot;EnabledServers&quot;;             
        }       
</pre></div><p>The conversion of the attribute value from a name to a object name is implemented in SetMBeanAttributeCommand.convertAttributeValue(..):</p><div class="source"><pre class="prettyprint linenums">        // custom logic to handle case for SNMPxxxxMBean.EnabledServers
        if (attributeInfo.getName().equals(&quot;EnabledServers&quot; )) {                
                if (mbeansModelAccessor.isMBeanType(objName, &quot;SNMPLogFilter&quot;))  {               
                        return convertReferencedObjectNameAttributeValue(attributeValue, attributeInfo );

                if (mbeansModelAccessor.isMBeanType(objName, &quot;SNMPStringMonitor&quot;))  {                   
                        return convertReferencedObjectNameAttributeValue(attributeValue, attributeInfo );
                        
                if (mbeansModelAccessor.isMBeanType(objName, &quot;SNMPGaugeMonitor&quot;))  {                    
                        return convertReferencedObjectNameAttributeValue(attributeValue, attributeInfo );
                        
                if (mbeansModelAccessor.isMBeanType(objName, &quot;SNMPCounterMonitor&quot;))  {                  
                        return convertReferencedObjectNameAttributeValue(attributeValue, attributeInfo );
                        
                if (mbeansModelAccessor.isMBeanType(objName, &quot;SNMPJMXMonitor&quot;))  {              
                        return convertReferencedObjectNameAttributeValue(attributeValue, attributeInfo );                                                                                       
        }       
        
        // convert simple value to type exposed by MBean attribute
        return convertSimpleAttributeValue( attributeValue, attributeTypeClass, attributeInfo );
</pre></div><p>@TODO: document this... </p></div><div class="section"><h4>OK - 105) Fails to set target attribute on WLDFSystemResource<a name="OK_-_105_Fails_to_set_target_attribute_on_WLDFSystemResource"></a></h4><div class="source"><pre class="prettyprint linenums">Failed to set attribute [Target] on MBean [com.bea:Name=wldf-module-1,Type=WLDFSystemResource] because it did not contain attribute.].&gt;
</pre></div><p>WLDFSystemResource doesnt have a target attribute but a targets attribute, which takes server object names as input. </p><p>Solution, same type as TDD100,105:</p><p>a) MBeansModelAccessorImpl.findAttributeInfo(..) which remap the XMLBeans attribute name <i>WLDFSystemResource.target</i> =&gt; MBean attribute name <i>targets</i>:</p><p>b) SetMBeanAttributeCommand.convertAttributeValue(..): convert the simple server name to a server object name.</p></div><div class="section"><h4>OK - 109) Resolution of object name of WLDFResourceBean fails in ResolvedModelJmxGetterImpl.resolveObjectName()<a name="OK_-_109_Resolution_of_object_name_of_WLDFResourceBean_fails_in_ResolvedModelJmxGetterImpl.resolveObjectName"></a></h4><div class="source"><pre class="prettyprint linenums">ResolvedModelJmxGetterImpl&gt; &lt;Failed to resolve object name from 
[[MBeanServerInvocationHandler]com.bea:
Name=wldf-module-1,
Type=weblogic.diagnostics.descriptor.WLDFResourceBean,
Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],
Path=WLDFResource[wldf-module-1]]. Will return null.&gt;
</pre></div><p>Temporary solution is implemented in <tt>MBeansModelAccessorImpl.resolveObjectNameFromMBeanProxy()</tt> which can resolve object name from WLDFBean which don't support the deprecated <tt>getObjectName</tt> method which Configuration MBeans contains. </p><p>The method is used by the <tt>&lt;CreateMBeanCommand</tt>.</p><p>The permanent solution is replace the usage of Dynamic MBean proxies with a consistent usage of Object names.</p></div><div class="section"><h4>OK - 110) Resolution of WLDF MBeans fails<a name="OK_-_110_Resolution_of_WLDF_MBeans_fails"></a></h4><p>The problem is the getter matcher <tt>MBeansGetterMethodMatcherImpl</tt> rejects methods from the <tt>weblogic.diagnostics.*</tt> where theh WLDF MBean is located. </p><p>The solution is to add the <tt>weblogic.diagnostics</tt> package to the list list of positive MBean packages in <tt>MBeansGetterMethodMatcherImpl</tt>. </p></div><div class="section"><h4>OK - 116 ) XmlBeansModelResolverImpl doesn't resolve message key xbmr.resolveattribute_value_failed correctly <a name="OK_-_116__XmlBeansModelResolverImpl_doesnt_resolve_message_key_xbmr.resolveattribute_value_failed_correctly"></a></h4><p>Message key = xbmr.resolveattribute_value_failed</p><div class="source"><pre class="prettyprint linenums">ModelResolutionFailedException: Failed to resolve XMLBean attribute [Name] as model object value isnt XMLObject, but of type [{1}].,
</pre></div></div><div class="section"><h4>OK - 115) XmlBeansDescriptorGenerator throws NullPointerException during resolution<a name="OK_-_115_XmlBeansDescriptorGenerator_throws_NullPointerException_during_resolution"></a></h4><p>Resolved type:</p><div class="source"><pre class="prettyprint linenums">&lt;PreOrderDirectorImpl&gt; &lt;Starting to traverse resolved type [com.alpha.pineapple.resolvedmodel.ResolvedPrimitive@230be4[

primaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@e1e567[
name=Name,
exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: Failed to resolve XMLBean attribute [Name] as value isnt of type XMLObject but [null].
,type=&lt;null&gt;,
value=&lt;null&gt;,
state=FAILED],

secondaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1420fea[name=Name,
exception=&lt;null&gt;,
type=class java.lang.String,
value=alphadomain,
state=SET]]].&gt;
</pre></div><p>Exception: +---- at XmlBeansDescriptionGeneratorImpl.describeTypeFromSchemaProperty(XmlBeansDescriptionGeneratorImpl.java:143) at XmlBeansDescriptionGeneratorImpl.visit(XmlBeansDescriptionGeneratorImpl.java:80) at ResolvedPrimitive.accept(ResolvedPrimitive.java:25) +----</p><p>Solution: Make name generation tolerant for nulls.</p></div><div class="section"><h4>OK - 117) Resolution generate errors Server.SSL<a name="OK_-_117_Resolution_generate_errors_Server.SSL"></a></h4><p>Resolution of object where the primary participant resolution failed.</p><p>1) The resolution of XMLBean collection value [admserver] failed - admserver didn't exist in collection. - type is stored as a schema property - error message: Failed to resolve collection value [admserver] from collection which contained the values null., - error msg key: (XmlBeansModelResolverImpl) xbmr.createnonexistingcollectionvalue_info - error message is set in the method XmlBeansModelResolverImpl.createNonExistingCollectionValue:</p><div class="source"><pre class="prettyprint linenums">         Object[] args = { id, parent.getValueAsSingleLineString() };                           
        String message = messageProvider.getMessage(&quot;xbmr.createnonexistingcollectionvalue_info&quot;, args );                           
        ModelResolutionFailedException e = new ModelResolutionFailedException(message);                     

        // reuse type from parent resolved collection. 
        Object type = parent.getType();  &lt;=== CAPTURE OF TYPE INFO!
        
                // create unsuccessful resolution result if value doesn't exist in collection        
                return ResolvedParticipantImpl.createUnsuccessfulResult( id , type, NULL_VALUE , e );            
</pre></div><p>which id invoked through the call stack:</p><div class="source"><pre class="prettyprint linenums">ResolvedModelBuilderVisitorImpl.visit(ResolvedCollection resolvedCollection...)
  ResolvedModelBuilderVisitorImpl.resolveCollectionEntry
    ResolvedModelBuilderVisitorImpl.getPrimaryCollectionValue()
      XmlBeansModelResolverImpl.createNonExistingCollectionValue  
</pre></div><p>2) The resolution of the XMLBean attribute [Ssl] failed - type is null. - error message: ...value isnt of type XMLObject but [null]... - error msg key: (XmlBeansModelResolverImpl) xbmr.resolveattribute_value_failed - error message is set in the method XmlBeansModelResolverImpl.resolveAttribute:</p><div class="source"><pre class="prettyprint linenums">        // exit if model object isn't XMLBean 
        if (!(participant.getValue() instanceof XmlObject)) {
                
                // if name is null, then generated null name
                if (attributeName == null) {
                        attributeName =&quot;null&quot;;
                }
                
            // create exception to describe the situation
                Object[] args = { attributeName, participant.getValue()};               
                String errorMessage = messageProvider.getMessage(&quot;xbmr.resolveattribute_value_failed&quot;, args );          

</pre></div><p>the call stack:</p><div class="source"><pre class="prettyprint linenums">XmlBeansModelResolverImpl.resolveAttribute
</pre></div><p>The problem is that the schema property for the [Ssl] attribute isn't stored for further processing.</p><p>Resolution:</p><div class="source"><pre class="prettyprint linenums">&lt;XmlBeansModelResolverImpl&gt; &lt;Starting to resolve XMLBean attribute [Ssl] from [
  com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1355a47[
  name=admserver,
  exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: Failed to resolve collection value [admserver] from collection which contained the values null.,
  type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@497536,
  value=&lt;null&gt;,
  state=FAILED]]. &gt;

&lt;MBeansModelResolverImpl&gt; &lt;Starting to resolve MBean attribute [Ssl] from [com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@130b97d[name=admserver,exception=&lt;null&gt;,type=class $Proxy37,value=[MBeanServerInvocationHandler]com.bea:Name=admserver,Type=Server,state=SET]].&gt;
...
&lt;MBeansModelResolverImpl&gt; &lt;Successfully resolved MBean attribute [com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1ff6df2[name=Ssl,exception=&lt;null&gt;,type=interface weblogic.management.configuration.SSLMBean,value=[MBeanServerInvocationHandler]com.bea:Name=admserver,Type=SSL,Server=admserver,state=SET]]. &gt;
&lt;ResolvedModelBuilderVisitorImpl&gt; &lt;DEBUG // secondary is succesful&gt;
&lt;ResolvedModelBuilderVisitorImpl&gt; &lt;Created resolved object [
  com.alpha.pineapple.resolvedmodel.ResolvedObject@8b4796[
  primaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@8fb65[
    name=Ssl,
    exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: 
    Failed to resolve XMLBean attribute [Ssl] as value isnt of type XMLObject but [null].,
    type=&lt;null&gt;,
    value=&lt;null&gt;,
    state=FAILED],

  secondaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1ff6df2[
    name=Ssl,
    exception=&lt;null&gt;,
    type=interface weblogic.management.configuration.SSLMBean,
    value=[MBeanServerInvocationHandler]com.bea:Name=admserver,
    Type=SSL,
    Server=admserver,state=SET]]].&gt;
</pre></div><p>During visit of SSL:</p><div class="source"><pre class="prettyprint linenums">&lt;Visiting as OBJECT [com.alpha.pineapple.resolvedmodel.ResolvedObject@de9984[

primaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@30d5aa[
name=Ssl,
exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: Failed to resolve XMLBean attribute [Ssl] as value isnt of type XMLObject but [null].,
type=&lt;null&gt;,
value=&lt;null&gt;,
state=FAILED],

secondaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@782dc6[
name=Ssl,
exception=&lt;null&gt;,
type=interface weblogic.management.configuration.SSLMBean,
value=[MBeanServerInvocationHandler]com.bea:Name=admserver,
Type=SSL,
Server=admserver,
state=SET]]].&gt;


&lt;XmlBeansModelResolverImpl&gt; &lt;Starting to resolve attributes names for XMLBean 
[com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@30d5aa[......


&lt;ExecutionResultImpl&gt; &lt;Message added with id [StackTrace] and content [
java.lang.NullPointerException
at XmlBeansModelResolverImpl.resolveAttributeNames(XmlBeansModelResolverImpl.java:232)
</pre></div><p>Code from XmlBeansModelResolverImpl.resolveAttributeNames:</p><div class="source"><pre class="prettyprint linenums">        // get schema property
        SchemaProperty schemaProperty = (SchemaProperty) attribute.getType();
        
        // get schema properties
(line232) SchemaType schemaType = schemaProperty.getType();
        SchemaProperty[] schemaProperties = schemaType.getProperties();
</pre></div><p>Line 232 generate NullPointerException because the type is NULL...</p><p>Solution: Refactor XmlBeansModelResolverImpl.resolveAttributeName() to do type control/extraction before value control/extraction. This enables the inclusion of type information (SchemaProperty) even if the resolution fails due to a null value. </p></div><div class="section"><h4>OK - 118) Resolution fails for primary nodes: Server.ExecuteQueue:execute-queue[]<a name="OK_-_118_Resolution_fails_for_primary_nodes:_Server.ExecuteQueue:execute-queue"></a></h4><p>Debug messages:</p><div class="source"><pre class="prettyprint linenums">&lt;Starting to resolve values for XMLBean collection attribute [com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1ced290[
name=SnmpTrapDestination,
exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: Failed to resolve XMLBean attribute [SnmpTrapDestination] as value isnt of type XMLObject but [null].,
type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@155aa19,
value=&lt;null&gt;,
state=FAILED]].&gt;
</pre></div><p>Error message:</p><div class="source"><pre class="prettyprint linenums">Message: Failed to resolve collection value [java.lang.NullPointerException] due to exception [{1}].
StackTrace: java.lang.NullPointerException at XmlBeansModelResolverImpl.resolveCollectionAttributeValues(XmlBeansModelResolverImpl.java:296) 
at ResolvedModelBuilderVisitorImpl.visit(ResolvedModelBuilderVisitorImpl.java:184)  
</pre></div><p>msg key: rmbv.resolvedcollection_error method: ResolvedModelBuilderVisitorImpl.public Object visit(ResolvedCollection resolvedCollection .. </p><p>XmlBeansModelResolverImpl.resolveCollectionAttributeValues(XmlBeansModelResolverImpl.java:</p><div class="source"><pre class="prettyprint linenums">        // exit if value state is nil
        if (attribute.getValueState() == ValueState.NIL ) 
        {
                return result;
        }
        
        // get attribute value        
        Object[] valueAsArray = (Object[]) attribute.getValue();
                                
        // iterate over the values
(line 296) for ( Object singleValue : valueAsArray )
        {
</pre></div><p>The problem is that the participant value is null but there is no check for null before the iteration starts. the is a check for valuestate.NIL, bu the valuestate is actually FAILED.</p><p>The solution is to add a check for value state FAILED and return an empty map. </p></div><div class="section"><h4>OK - 119) Execution of CreateReport fails with WLDF model<a name="OK_-_119_Execution_of_CreateReport_fails_with_WLDF_model"></a></h4><p>Example module: [weblogic-jmx-example-9.2; wldf:0.9.2].</p><p>Error message:</p><div class="source"><pre class="prettyprint linenums">Invoking operation [create-report] on module [weblogic-jmx-example-9.2; wldf:0.9.2].
StackTrace:
java.lang.RuntimeException: com.alpha.pineapple.plugin.PluginExecutionFailedException: Operation failed with exception [java.lang.NullPointerException
        at com.alpha.pineapple.resolvedmodel.traversal.PreOrderDirectorImpl.traverse(PreOrderDirectorImpl.java:114)
        at com.alpha.pineapple.plugin.weblogic.jmx.operation.CreateReport.execute(CreateReport.java:96)                         
</pre></div><p>Stacktrace:</p><div class="source"><pre class="prettyprint linenums">Caused by: com.alpha.pineapple.plugin.PluginExecutionFailedException: Operation failed with exception [java.lang.NullPointerException
        at com.alpha.pineapple.resolvedmodel.traversal.PreOrderDirectorImpl.traverse(PreOrderDirectorImpl.java:114)
        at com.alpha.pineapple.plugin.weblogic.jmx.operation.CreateReport.execute(CreateReport.java:96)
        at com.alpha.pineapple.plugin.session.SessionHandlerImpl.execute(SessionHandlerImpl.java:75)
        at com.alpha.pineapple.command.InvokePluginsCommand.executeModel(InvokePluginsCommand.java:248)
</pre></div><p>Solution: Add missing logic in the method: ResolvedModelIntializerImpl.initialize(WldfResourceDocument wldfResourceDoc,....</p></div><div class="section"><h4>OK - 120) Execution of CreateReport fails with WLDF model, part 2<a name="OK_-_120_Execution_of_CreateReport_fails_with_WLDF_model_part_2"></a></h4><p>Example module: [weblogic-jmx-example-9.2; wldf:0.9.2] </p><p>Error message:</p><div class="source"><pre class="prettyprint linenums">Caused by: java.lang.ClassCastException: com.bea.ns.weblogic.x90.diagnostics.impl.WldfResourceDocumentImpl
        at com.alpha.pineapple.plugin.weblogic.jmx.operation.ResolvedModelIntializerImpl.createDomainXmlBeanParticipant(ResolvedModelIntializerImpl.java:116)
</pre></div><p>Stacktrace:</p><div class="source"><pre class="prettyprint linenums">RuntimeException: com.alpha.pineapple.plugin.PluginExecutionFailedException: Operation failed with exception [java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at com.alpha.pineapple.plugin.weblogic.jmx.operation.ResolvedModelIntializerImpl.initialize(ResolvedModelIntializerImpl.java:104)
</pre></div><p>Solution: implement code to type cast to WldfResourceDocument</p></div><div class="section"><h4>OK - 112) Fails to test module model which uses the WLDF schema<a name="OK_-_112_Fails_to_test_module_model_which_uses_the_WLDF_schema"></a></h4><div class="source"><pre class="prettyprint linenums">java.lang.RuntimeException: 
com.alpha.pineapple.plugin.PluginExecutionFailedException: 
Failed to type cast content to [interface com.bea.ns.weblogic.x920.domain.DomainDocument]. 
Operation execution aborted.
</pre></div><p>Solution : TTD119+120</p></div><div class="section"><h4>OK - 125) Test XmlBeansModelAccessorImpl.getSchemaPropertyByName(String attributeName, XmlObject xmlObject)<a name="OK_-_125_Test_XmlBeansModelAccessorImpl.getSchemaPropertyByNameString_attributeName_XmlObject_xmlObject"></a></h4></div><div class="section"><h4>OK - 123) Execution of CreateReport fails with WLDF model, part 3<a name="OK_-_123_Execution_of_CreateReport_fails_with_WLDF_model_part_3"></a></h4><p>Example module: [weblogic-jmx-example-9.2; wldf:0.9.2] </p><p>Error message:</p><p>Stacktrace:</p><div class="source"><pre class="prettyprint linenums">java.lang.RuntimeException: com.alpha.pineapple.plugin.PluginExecutionFailedException: Operation failed with exception [java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at com.alpha.pineapple.plugin.weblogic.jmx.operation.ResolvedModelIntializerImpl.initialize(ResolvedModelIntializerImpl.java:108)
        at com.alpha.pineapple.plugin.weblogic.jmx.operation.DeployConfiguration.execute(DeployConfiguration.java:93)
        ....
Caused by: java.lang.IllegalArgumentException: null is not a legal value for Name
        at weblogic.descriptor.beangen.LegalChecks.checkNonNull(LegalChecks.java:139)
        at weblogic.management.configuration.WLDFSystemResourceMBeanImpl.setName(WLDFSystemResourceMBeanImpl.java:243)
        at weblogic.management.configuration.DomainMBeanImpl.createWLDFSystemResource(DomainMBeanImpl.java:11242)
                
</pre></div><p>In the method ResolvedModelIntializerImpl.initialize(WldfResourceDocument wldfResourceDoc,..: </p><div class="source"><pre class="prettyprint linenums">        // get resource name from doc
        WldfResourceType wldfResource = wldfResourceDoc.getWldfResource();                
        String name = wldfResource.getName();        
</pre></div><p>.. the resource is read form the XML model.. if the name is undefined as shown here:</p><div class="source"><pre class="prettyprint linenums">                                &lt;wjp:wldf-system-resource&gt;
                                        &lt;wjp:name&gt;wldf-module-1&lt;/wjp:name&gt;
                                        &lt;wjp:target&gt;admserver&lt;/wjp:target&gt;
                                &lt;/wjp:wldf-system-resource&gt;             
                        &lt;/wjp:domain&gt;
                        
                        &lt;wdf:wldf-resource&gt;
                                &lt;!-- &lt;wdf:name&gt;wldf-module-1&lt;/wdf:name&gt; --&gt;
                                &lt;wdf:harvester&gt;

</pre></div><p>...then the above exception is thrown. If the name is defined then another exception is thrown, becayse the name field isn't writeable.</p><p>Possible solutions:</p><p>1) <i>wdf:wldf-resource</i> can't contain a name</p><p>a shown here:</p><div class="source"><pre class="prettyprint linenums">
                                &lt;wjp:wldf-system-resource&gt;
                                        &lt;wjp:name&gt;wldf-module-1&lt;/wjp:name&gt;
                                        &lt;wjp:target&gt;admserver&lt;/wjp:target&gt;
                                &lt;/wjp:wldf-system-resource&gt;             
                        &lt;/wjp:domain&gt;
                        
                        &lt;wdf:wldf-resource&gt;
                                &lt;wdf:harvester&gt;

</pre></div><p>..this poses the problem that the only connection between the two module it the implicit by their placement in the same model. Currently there is not way to identify name of the <i>wjp:wldf-system-resource</i> since the two models are executed at different times. </p><p>2) <i>wdf:wldf-resource</i> should define a name </p><p>..and the name should/could match the name of a <i>wjp:wldf-system-resource</i>. </p><p>..this poses the problem that when the <i>wjp:wldf-system-resource</i> is created then the <i>wdf:wldf-resource</i> is also created. When the model with then <i>wdf:wldf-resource</i> is executed then the plugin will attempt to set the name attribute which will fail, since the attribute isn't writeable.</p><p>Solution: #2 + remove failure in SetMBeanAttributeCommand which fails when trying to set an unwritable attribute.</p></div><div class="section"><h4>OK - 126) Resolution of HarvestedType:harvested-type[] fails<a name="OK_-_126_Resolution_of_HarvestedType:harvested-type_fails"></a></h4><p>Resolution of model using WLDF schema.</p><p>MBean: weblogic.diagnostics.descriptor.WLDFHarvesterBean attribute: HarvestedType</p><p>Error message: Failed to resolve collection value due to exception [java.lang.NullPointerException]. </p><p>Stack trace:</p><div class="source"><pre class="prettyprint linenums">java.lang.NullPointerException
        at com.alpha.pineapple.plugin.weblogic.jmx.model.mbeans.MBeansModelResolverImpl.resolveCollectionAttributeValues(MBeansModelResolverImpl.java:150)
        at com.alpha.pineapple.resolvedmodel.traversal.ResolvedModelBuilderVisitorImpl.visit(ResolvedModelBuilderVisitorImpl.java:190)
        at com.alpha.pineapple.resolvedmodel.ResolvedCollection.accept(ResolvedCollection.java:25)
        at com.alpha.pineapple.resolvedmodel.traversal.PreOrderDirectorImpl.traverse(PreOrderDirectorImpl.java:96)
</pre></div><p>Reslution error:</p><div class="source"><pre class="prettyprint linenums">com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@14b3e3[
name=HarvestedType,
exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: 
Failed to resolve MBean attribute [HarvestedType] as no getter method could be resolved from MBean [[MBeanServerInvocationHandler]com.bea:Name=wldf-module-1,Type=weblogic.diagnostics.descriptor.WLDFHarvesterBean,Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/Harvester[wldf-module-1]].,
type=&lt;null&gt;,
value=&lt;null&gt;,
state=FAILED]
</pre></div><p>Resolution info:</p><div class="source"><pre class="prettyprint linenums">&lt;ResolvedModelBuilderVisitorImpl&gt; &lt;Visiting as COLLECTION [com.alpha.pineapple.resolvedmodel.ResolvedCollection@13ab760[
primaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1a620d8[
name=HarvestedType,
exception=&lt;null&gt;,
type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@1b65730,
value={&lt;xml-fragment xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; xmlns:sec=&quot;http://www.bea.com/ns/weblogic/90/security&quot; xmlns:wdf=&quot;http://www.bea.com/ns/weblogic/90/diagnostics&quot; xmlns:wjp=&quot;http://www.bea.com/ns/weblogic/920/domain&quot; xmlns:wls=&quot;http://www.bea.com/ns/weblogic/90/security/wls&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance...},
state=SET],

secondaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1dd369f[
name=HarvestedType,
exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: Failed to resolve MBean attribute [HarvestedType] as no getter method could be resolved from MBean [[MBeanServerInvocationHandler]com.bea:Name=wldf-module-1,
Type=weblogic.diagnostics.descriptor.WLDFHarvesterBean,
Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],
Path=WLDFResource[wldf-module-1]/Harvester[wldf-module-1]].,type=&lt;null&gt;,value=&lt;null&gt;,state=FAILED]]].&gt;

&lt;XmlBeansModelResolverImpl&gt; &lt;Starting to resolve values for XMLBean collection attribute [com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1a620d8[name=HarvestedType,exception=&lt;null&gt;,type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@1b65730,value={&lt;xml-fragment xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; xmlns:sec=&quot;http://www.bea.com/ns/weblogic/90/security&quot; xmlns:wdf=&quot;http://www.bea.com/ns/weblogic/90/diagnostics&quot; xmlns:wjp=&quot;http://www.bea.com/ns/weblogic/920/domain&quot; xmlns:wls=&quot;http://www.bea.com/ns/weblogic/90/security/wls&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance...},state=SET]].&gt;
&lt;XmlBeansModelResolverImpl&gt; &lt;Successfully resolved values for XMLBean collection attribute [{
weblogic.management.runtime.JRockitRuntimeMBean=
com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@133eb05[
name=weblogic.management.runtime.JRockitRuntimeMBean,
exception=&lt;null&gt;,
type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@1b65730,
value=&lt;xml-fragment xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; xmlns:sec=&quot;http://www.bea.com/ns/weblogic/90/security&quot; xmlns:wdf=&quot;http://www.bea.com/ns/weblogic/90/diagnostics&quot; xmlns:wjp=&quot;http://www.bea.com/ns/weblogic/920/domain&quot; xmlns:wls=&quot;http://www.bea.com/ns/weblogic/90/security/wls&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance...,state=SET]}].&gt;

&lt;ResolvedModelBuilderVisitorImpl&gt; &lt;DEBUG // primary collection values :{weblogic.management.runtime.JRockitRuntimeMBean=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@133eb05[name=weblogic.management.runtime.JRockitRuntimeMBean,exception=&lt;null&gt;,type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@1b65730,value=&lt;xml-fragment xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot; xmlns:sec=&quot;http://www.bea.com/ns/weblogic/90/security&quot; xmlns:wdf=&quot;http://www.bea.com/ns/weblogic/90/diagnostics&quot; xmlns:wjp=&quot;http://www.bea.com/ns/weblogic/920/domain&quot; xmlns:wls=&quot;http://www.bea.com/ns/weblogic/90/security/wls&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance...,state=SET]}&gt;
&lt;MBeansModelResolverImpl&gt; &lt;Starting to resolve values for MBean collection attribute [com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1dd369f[name=HarvestedType,exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: Failed to resolve MBean attribute [HarvestedType] as no getter method could be resolved from MBean [[MBeanServerInvocationHandler]com.bea:Name=wldf-module-1,Type=weblogic.diagnostics.descriptor.WLDFHarvesterBean,Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/Harvester[wldf-module-1]].,type=&lt;null&gt;,value=&lt;null&gt;,state=FAILED]].&gt;
&lt;ResolvedModelBuilderVisitorImpl&gt; &lt;DEBUG // collection value resolution error :java.lang.NullPointerException&gt;
</pre></div><p>The MBean attribute resolution which fails:</p><div class="source"><pre class="prettyprint linenums">&lt;MBeansModelResolverImpl&gt; &lt;Starting to resolve MBean attribute [HarvestedType] from 
[com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1743ff4[
name=Harvester,
exception=&lt;null&gt;,
type=interface weblogic.diagnostics.descriptor.WLDFHarvesterBean,
value=[MBeanServerInvocationHandler]com.bea:Name=wldf-module-1,
Type=weblogic.diagnostics.descriptor.WLDFHarvesterBean,Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/Harvester[wldf-module-1],
state=SET]].&gt;
</pre></div><p>The problem is that <tt>MBeansGetterMethodMatcherImpl.isMatch()</tt> fails to recognize <tt>WLDFHarvestedTypeBean[] WLDFHarvesterBean.getHarvestedTypes()</tt> as attribute because the returned array component type doesn't end with <tt>MBean</tt> but <tt>Bean</tt>. </p><p>The solution: <tt>MBeansGetterMethodMatcherImpl.isMatch()</tt> matches component types which ends with <tt>Bean</tt>. </p></div></div><div class="section"><h3>Resolved TDD Notes, part 2<a name="Resolved_TDD_Notes_part_2"></a></h3><div class="section"><h4>OK - 127) Failed to resolve WLDF MBean attribute from attribute <tt>HarvestedType</tt> <a name="OK_-_127_Failed_to_resolve_WLDF_MBean_attribute_from_attribute_HarvestedType"></a></h4><div class="source"><pre class="prettyprint linenums">&lt;ResolvedModelBuilderVisitorImpl&gt; 
&lt;Created resolved object [com.alpha.pineapple.resolvedmodel.ResolvedPrimitive@190efa8[
primaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@1310e0a[
name=Name,
exception=&lt;null&gt;,
type=org.apache.xmlbeans.impl.schema.SchemaPropertyImpl@c1df71,
value=&lt;null&gt;,
state=FAILED],

secondaryParticipant=com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@661a11[
name=Name,
exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: Failed to resolve MBean attribute [Name] due to exception [java.lang.RuntimeException: Failed to resolve MBean attribute from getter method &lt;public final weblogic.diagnostics.descriptor.WLDFHarvestedTypeBean[] $Proxy34.getHarvestedTypes()&gt;. Array component type &lt;interface weblogic.diagnostics.descriptor.WLDFHarvestedTypeBean&gt; didn't end with 'MBean' as expected.].,
type=&lt;null&gt;,
value=&lt;null&gt;,
state=FAILED]]].&gt;
</pre></div><p>The exception is thrown in line 140 in <tt>MBeansGetterMethodMatcherImpl.resolveAttributeFromGetterMethod</tt> </p><p>Resolution:</p><div class="source"><pre class="prettyprint linenums">&lt;MBeansModelResolverImpl&gt; &lt;Starting to resolve MBean attribute [HarvestedType] from [com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@117a4c6[
name=Harvester,exception=&lt;null&gt;,
type=interface weblogic.diagnostics.descriptor.WLDFHarvesterBean,
value=[MBeanServerInvocationHandler]com.bea:Name=wldf-module-1,Type=weblogic.diagnostics.descriptor.WLDFHarvesterBean,Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/Harvester[wldf-module-1],
state=SET]].&gt;

&lt;MethodUtilsImpl&gt; &lt;Starting to resolve getter methods from &lt;[MBeanServerInvocationHandler]com.bea:Name=wldf-module-1,Type=weblogic.diagnostics.descriptor.WLDFHarvesterBean,Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/Harvester[wldf-module-1]&gt; 
using attribute &lt;HarvestedType&gt; 
and method matcher &lt;com.alpha.pineapple.plugin.weblogic.jmx.model.mbeans.MBeansGetterMethodMatcherImpl@6e795b&gt;.&gt;

&lt;MethodUtilsImpl&gt; &lt;Successfully resolved getters methods 
on object &lt;[MBeanServerInvocationHandler]com.bea:Name=wldf-module-1,Type=weblogic.diagnostics.descriptor.WLDFHarvesterBean,Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/Harvester[wldf-module-1]&gt; 
with result &lt;[Ljava.lang.reflect.Method;@18a270a[{}]&gt;.&gt;
</pre></div><p>The problem is that the getter method <tt>WLDFHarvestedTypeBean[] WLDFHarvesterBean.getHarvestedTypes()</tt> isn't resolved from the attribute name <tt>HarvestedType</tt>. </p><p>Which leads back to <tt>MBeansGetterMethodMatcherImpl.resolveAttributeFromGetterMethod</tt> which returns WLDFHarvestedType instead of the expected HarvestedTypes. </p><div class="source"><pre class="prettyprint linenums">        1) MBeansModelResolverImpl.resolveAttribute( &quot;HarvestedType&quot;, ResolvedParticipantImpl[..value=com.bea:Name=wldf-module-1..] )
        
                1.1) MBeansModelAccessorImpl.resolveGetterMethod( &quot;HarvestedType&quot;, com.bea:Name=wldf-module-1 ) 
                 
                        1.1.1) MethodUtilsImpl.resolveGetterMethods( com.bea:Name=wldf-module-1, &quot;HarvestedType&quot;, MBeansGetterMethodMatcherImpl )
                        
                                1.1.1.1) MBeansGetterMethodMatcherImpl.isMatch( WLDFHarvestedTypeBean[] $Proxy18.getHarvestedTypes() )
                                        =&gt; returns true
                        
                                1.1.1.2) MBeansGetterMethodMatcherImpl.resolveAttributeFromGetterMethod( WLDFHarvestedTypeBean[] $Proxy18.getHarvestedTypes() )
                                        =&gt; returns &quot;WLDFHarvestedType&quot; 

                                1.1.1.3) if (&quot;HarvestedType&quot;.equalsIgnoreCase( &quot;WLDFHarvestedType&quot; )) 
                                        =&gt; fails and method isn't added to result set.                                                                                                          
</pre></div><p>Possible solutions:</p><p>a) Implement logic in 1.1) <tt>MBeansModelAccessorImpl.resolveGetterMethod</tt> which maps the attribute name from &quot;HarvestedType&quot; to &quot;WLDFHarvestedType&quot; and step 1.1.1.3) will succceed. </p><p>b) Implement logic in 1.1.1.2) <tt>MBeansGetterMethodMatcherImpl.resolveAttributeFromGetterMethod</tt> which maps the attribute name from &quot;HarvestedType&quot; to &quot;WLDFHarvestedType&quot; and step 1.1.1.3) will succceed. </p><p>c) Implement mapping logic in <tt>SpecialCasesAttributeMapperImpl</tt>, as described in TDD129.</p><p>Solution c) is implemented.</p></div><div class="section"><h4>OK - 114) Resolution of collection values for WLDF MBean fails, e.g. harvested-type<a name="OK_-_114_Resolution_of_collection_values_for_WLDF_MBean_fails_e.g._harvested-type"></a></h4><p>Model extract:</p><div class="source"><pre class="prettyprint linenums">                        &lt;wdf:wldf-resource&gt;
                                &lt;wdf:name&gt;wldf-module-1&lt;/wdf:name&gt;
                                &lt;wdf:harvester&gt;
                                        &lt;wdf:enabled&gt;true&lt;/wdf:enabled&gt;
                                        &lt;wdf:sample-period&gt;10000&lt;/wdf:sample-period&gt;
                                        
                                        &lt;!-- CPU usage on machine to high (80%) --&gt;
                                        &lt;wdf:harvested-type&gt;
                                                &lt;wdf:name&gt;weblogic.management.runtime.JRockitRuntimeMBean&lt;/wdf:name&gt;
                                                &lt;wdf:enabled&gt;true&lt;/wdf:enabled&gt;
                                                &lt;wdf:harvested-attribute&gt;AllProcessorsAverageLoad&lt;/wdf:harvested-attribute&gt;                                             
                                        &lt;/wdf:harvested-type&gt;                                                                           
                                &lt;/wdf:harvester&gt;
                                ...
</pre></div><p>Resolution message:</p><div class="source"><pre class="prettyprint linenums">&lt;2011-04-06 16:01:25,514&gt; &lt;DEBUG&gt; &lt;MBeansModelResolverImpl&gt; 
&lt;Starting to resolve values for MBean collection attribute 
[com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@3640c2[
name=HarvestedType,
exception=com.alpha.pineapple.resolvedmodel.traversal.ModelResolutionFailedException: 
Failed to resolve MBean attribute [HarvestedType] as no getter method could be resolved from MBean 
[[MBeanServerInvocationHandler]com.bea:Name=wldf-module-1,
Type=weblogic.diagnostics.descriptor.WLDFHarvesterBean,
Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],
Path=WLDFResource[wldf-module-1]/Harvester[wldf-module-1]].,
type=&lt;null&gt;,
value=&lt;null&gt;,
state=FAILED]].&gt;
</pre></div><p>Error message: </p><p>NullPointerException in MBeansModelResolverImpl.resolveCollectionAttributeValues line 149...</p><div class="source"><pre class="prettyprint linenums">java.lang.NullPointerException
at com.alpha.pineapple.plugin.weblogic.jmx.model.mbeans.MBeansModelResolverImpl.resolveCollectionAttributeValues(MBeansModelResolverImpl.java:149)
</pre></div><p>Solution: solved by TDD127</p></div><div class="section"><h4>OK - 129) WebLogic Model package definition is duplicated.<a name="OK_-_129_WebLogic_Model_package_definition_is_duplicated."></a></h4><p>Can be found in MBeansGetterMethodMatcherImpl.MODEL_PACKAGES and WeblogicJMXNamingUtils.CANDIDATE_PACKAGES</p><p>Moved to new constant container: WebLogicMBeanConstants</p></div><div class="section"><h4>OK - 129) Failed to create weblogic.management.runtime.JRockitRuntimeMBean:harvested-type<a name="OK_-_129_Failed_to_create_weblogic.management.runtime.JRockitRuntimeMBean:harvested-type"></a></h4><div class="source"><pre class="prettyprint linenums">Failed to create MBean [null] because parent MBean 
[com.bea:Name=wldf-module-1,Type=weblogic.diagnostics.descriptor.WLDFHarvesterBean,
Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/Harvester[wldf-module-1]] 
do not define factory method [createWLDFHarvestedTypeBean].     
</pre></div></div></div></div><div class="section"><h2>Log messages:<a name="Log_messages:"></a></h2><div class="source"><pre class="prettyprint linenums">&lt;ResolvedModelJmxGetterImpl&gt; &lt;Failed to resolve object name from [[MBeanServerInvocationHandler]com.bea:Name=KMnnoPgIgD-wldf,Type=weblogic.diagnostics.descriptor.WLDFHarvesterBean,Parent=[alphadomain]/WLDFSystemResources[KMnnoPgIgD-wldf],Path=WLDFResource[KMnnoPgIgD-wldf]/Harvester[KMnnoPgIgD-wldf]]. Will return null.&gt;
&lt;ExecutionResultImpl&gt; &lt;Message added with id [Message] and content [Failed to create MBean [xherZelWAW-wldf] because parent MBean is undefined.].&gt;
</pre></div><p>Modified CreateMBeanCommand to resolve parent object using <tt>resolveObjectNameFromMBeanProxy()</tt> if <tt>resolveParentObjectName()</tt> doesn't return a useful one... which it doesn't for WLDF beans:</p><div class="source"><pre class="prettyprint linenums">                // get parent object name
                ObjectName parentObjectName = modelJmxGetter.resolveParentObjectName( resolvedType );
                
                // if not object name then resolve it
                if(!(parentObjectName instanceof ObjectName)) {                                 
                        Object secondaryParentValue = parent.getSecondaryParticiant().getValue();                       
                        parentObjectName = mbeansModelAccessor.resolveObjectNameFromMBeanProxy(connection, secondaryParentValue );
                }
</pre></div><p>Next reported error: +----- <i>ExecutionResultImpl</i> <i>Message added with id [Message] and content [ Failed to create MBean [null] because parent MBean [com.bea:Name=NaBHSIcUzp-wldf,Type=weblogic.diagnostics.descriptor.WLDFHarvesterBean,Parent=[alphadomain]/WLDFSystemResources[NaBHSIcUzp-wldf],Path=WLDFResource[NaBHSIcUzp-wldf]/Harvester[NaBHSIcUzp-wldf]] do not define factory method [createWLDFHarvestedTypeBean]. ].</i> +-----</p><p>..so next it the method name resolution which resolves <tt>createWLDFHarvestedTypeBean</tt> instead of <tt>createHarvestedType</tt>.</p><p>Solution: Introduction of the <tt>SpecialCasesAttributeMapper</tt> class which is destined to contain all special mapping rules.</p><div class="section"><h3>Resolved TDD Notes, part 3<a name="Resolved_TDD_Notes_part_3"></a></h3><div class="section"><h4>OK - 130) Remove duplicate attribute mapping logic<a name="OK_-_130_Remove_duplicate_attribute_mapping_logic"></a></h4><p>Remapping of attribute names is now implemented in:</p><ul><li>SetMBeanAttributeCommand</li><li>CreateMBeanCommand</li><li>MBeanResolverImpl</li><li>(DeleteMBeanCommand)</li></ul><p>Solution: moving it to the class <tt>SpecialCasesAttributeMapper</tt> </p></div><div class="section"><h4>OK - 133) Resolution of collection values for WLDF MBean fails, e.g. watch-type<a name="OK_-_133_Resolution_of_collection_values_for_WLDF_MBean_fails_e.g._watch-type"></a></h4><div class="source"><pre class="prettyprint linenums">java.lang.NullPointerException
        at com.alpha.pineapple.plugin.weblogic.jmx.model.mbeans.MBeansModelResolverImpl.resolveCollectionAttributeValues(MBeansModelResolverImpl.java:150)
        at com.alpha.pineapple.resolvedmodel.traversal.ResolvedModelBuilderVisitorImpl.visit(ResolvedModelBuilderVisitorImpl.java:190)
</pre></div><p>look at TTD114 /127 /129:</p><p>b) Implement logic in 1.1.1.2) <tt>MBeansGetterMethodMatcherImpl.resolveAttributeFromGetterMethod</tt> which maps the attribute name from &quot;HarvestedType&quot; to &quot;WLDFHarvestedType&quot; and step 1.1.1.3) will succceed. </p><p>c) Implement mapping logic in <tt>SpecialCasesAttributeMapperImpl</tt>, as described in TDD129.</p><p>Resolution: +--- <i>MBeansModelResolverImpl</i> <i>Starting to resolve MBean attribute [Watch] from [com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@2a1389[ name=WatchNotification, exception=&lt;null</i>, type=interface weblogic.diagnostics.descriptor.WLDFWatchNotificationBean, value=[MBeanServerInvocationHandler]com.bea:Name=wldf-module-1,Type=weblogic.diagnostics.descriptor.WLDFWatchNotificationBean,Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/WatchNotification[wldf-module-1], state=SET]].&gt; +--- </p><p>Fails to resolve the method:</p><div class="source"><pre class="prettyprint linenums">&lt;MBeansGetterMethodMatcherImpl&gt; &lt;DEBUG DEBUG :public final 
weblogic.diagnostics.descriptor.WLDFWatchBean[] 
$Proxy35.getWatches()&gt;
</pre></div><p>From the attribute name <tt>Watch</tt>.</p><p>Solution: Add attribute mapping rule in <tt>SpecialCasesAttributeMapperImpl.mapResolution(..)</tt>: +--- if (name.equals( &quot;Watch&quot;) ) return &quot;WLDFWatch&quot;; +---</p></div><div class="section"><h4>135) Fails to create Watch on WatchNotification MBean<a name="a135_Fails_to_create_Watch_on_WatchNotification_MBean"></a></h4><p>Error message: +--- Failed to create MBean [null] because parent MBean [com.bea:Name=wldf-module-1,Type=weblogic.diagnostics.descriptor.WLDFWatchNotificationBean,Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/WatchNotification[wldf-module-1]] do not define factory method [createWLDFWatch]. +---</p><p>The MBean defines the factory method:</p><div class="source"><pre class="prettyprint linenums">public final weblogic.diagnostics.descriptor.WLDFWatchBean $Proxy35.createWatch(java.lang.String)&gt;
</pre></div><p>Solution: Add attribute mapping rule in <tt>SpecialCasesAttributeMapperImpl.mapCreateMBean(..)</tt>: +--- if (name.equals(&quot;WLDFWatchBean&quot;)) return &quot;Watch&quot;; +---</p></div><div class="section"><h4>OK - 136) Resolution of collection values for SNMP notication MBean fails, e.g. snmp-notification[]<a name="OK_-_136_Resolution_of_collection_values_for_SNMP_notication_MBean_fails_e.g._snmp-notification"></a></h4><div class="source"><pre class="prettyprint linenums">java.lang.NullPointerException
        at com.alpha.pineapple.plugin.weblogic.jmx.model.mbeans.MBeansModelResolverImpl.resolveCollectionAttributeValues(MBeansModelResolverImpl.java:150)
        at com.alpha.pineapple.resolvedmodel.traversal.ResolvedModelBuilderVisitorImpl.visit(ResolvedModelBuilderVisitorImpl.java:190)
        at com.alph
</pre></div><p>look at TTD114 /127 /129/134:</p><p>Resolution: +--- <i>MBeansModelResolverImpl</i> <i>Starting to resolve MBean attribute [SnmpNotification] from [com.alpha.pineapple.resolvedmodel.ResolvedParticipantImpl@162667[ name=WatchNotification, exception=&lt;null</i>, type=interface weblogic.diagnostics.descriptor.WLDFWatchNotificationBean, value=[MBeanServerInvocationHandler]com.bea:Name=wldf-module-1, Type=weblogic.diagnostics.descriptor.WLDFWatchNotificationBean,Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/WatchNotification[wldf-module-1], state=SET]].&gt; +--- </p><p>Fails to resolve the method:</p><div class="source"><pre class="prettyprint linenums">public final weblogic.diagnostics.descriptor.WLDFSNMPNotificationBean[] $Proxy67.getSNMPNotifications()
</pre></div><p>From the attribute name <tt>SnmpNotification</tt>.</p><p>Solution: Add attribute mapping rule in <tt>SpecialCasesAttributeMapperImpl.mapResolution(..)</tt>: +--- if (name.equals( &quot;SnmpNotification&quot;) ) return &quot;WLDFSNMPNotification&quot;; +---</p></div><div class="section"><h4>OK - 108) Clarify how to create WLDFResourceBean<a name="OK_-_108_Clarify_how_to_create_WLDFResourceBean"></a></h4><p>The leaf element in domain.xsd is the LDFSystemResourceMBean, which is named targeted and refers to a resource-file in the <tt>DOMAIN_NAME/config/diagnostics</tt> directory.</p><p>The root element of the diagnostics.xsd is the wldf-resource. WLDFResourceBean contains the configuration settings for a diagnostic system module. This bean is represented by a <i>wldf-resource</i> element in a DIAG_MODULE.xml diagnostics descriptor file in the domain&#xfffd;s config/diagnostics directory. </p><p>WLDFResourceBean can be retrieved from WLDFSystemResourceMBean as a child if the module doesn't have application-scope, e.g. (http://download.oracle.com/docs/cd/E13222_01/wls/docs92/wldf_configuring/understand_wldf_config.html):</p><p>...If a WLDFResourceBean is linked from a WLDFSystemResourceMBean, the settings for WLDF components apply to the targeted server. If a WLDFResourceBean is contained within a weblogic-diagnostics.xml descriptor file which is deployed as part of an application archive, you can configure only the Instrumentation component, and the settings apply only to that application. In the latter case, the WLDFResourceMBean is not a child of a WLDFSystemResourceMBean.... </p><p>...solution is implemented in DeployConfiguration....</p></div><div class="section"><h4>OK - 107) Fails to set descriptor-file-name<a name="OK_-_107_Fails_to_set_descriptor-file-name"></a></h4><p>The model: +--- <i>wjp:domain </i> <i>wjp:wldf-system-resource</i> <i>wjp:name</i>wldf-module-1<i>/wjp:name</i> <i>wjp:target</i>admserver<i>/wjp:target</i> <i>wjp:descriptor-file-name</i>diagnostics/wldf-module-1.xml<i>/wjp:descriptor-file-name</i> <i>/wjp:wldf-system-resource</i> <i>/wjp:domain</i> +---</p><p>The exception:</p><div class="source"><pre class="prettyprint linenums">com.alpha.pineapple.plugin.weblogic.jmx.management.JMXManagmentException: Attribute with name [DescriptorFileName] isnt writable.
        at com.alpha.pineapple.plugin.weblogic.jmx.command.SetMBeanAttributeCommand.validateAttribute(SetMBeanAttributeCommand.java:490)
        at com.alpha.pineapple.plugin.weblogic.jmx.command.SetMBeanAttributeCommand.setMBeanAttribute(SetMBeanAttributeCommand.java:277)
        at com.alpha.pineapple.plugin.weblogic.jmx.command.SetMBeanAttributeCommand.execute(SetMBeanAttributeCommand.java:144)
        at com.alpha.pineapple.command.execution.CommandRunnerImpl.run(CommandRunnerImpl.java:69)
        at com.alpha.pineapple.resolvedmodel.traversal.MBeansCreatorVisitorImpl.visit(MBeansCreatorVisitorImpl.java:175)
        at com.alpha.pineapple.resolvedmodel.ResolvedPrimitive.accept(ResolvedPrimitive.java:25)
        at com.alpha.pineapple.resolvedmodel.traversal.PreOrderDirectorImpl.traverse(PreOrderDirectorImpl.java:95)
        at com.alpha.pineapple.resolvedmodel.traversal.PreOrderDirectorImpl.traverse(PreOrderDirectorImpl.java:101)
        at com.alpha.pineapple.resolvedmodel.traversal.PreOrderDirectorImpl.traverse(PreOrderDirectorImpl.java:101)
        at com.alpha.pineapple.resolvedmodel.traversal.PreOrderDirectorImpl.traverse(PreOrderDirectorImpl.java:101)
        at com.alpha.pineapple.plugin.weblogic.jmx.operation.DeployConfiguration.execute(DeployConfiguration.java:148)
        at com.alpha.pineapple.plugin.session.SessionHandlerImpl.execute(SessionHandlerImpl.java:75)
        at com.alpha.pineapple.command.InvokePluginsCommand.executeModel(InvokePluginsCommand.java:283)
        at com.alpha.pineapple.command.InvokePluginsCommand.executeModels(InvokePluginsCommand.java:226)
        at com.alpha.pineapple.command.InvokePluginsCommand.execute(InvokePluginsCommand.java:142)
        at com.alpha.pineapple.command.execution.CommandRunnerImpl.run(CommandRunnerImpl.java:69)
</pre></div><p>Solution: se TDD123, which implemented: remove failure in SetMBeanAttributeCommand which fails when trying to set an unwritable attribute.</p></div><div class="section"><h4>OK - 138) Fails to create SNMP Notification on Watch MBean<a name="OK_-_138_Fails_to_create_SNMP_Notification_on_Watch_MBean"></a></h4><p>Error message: +--- Failed to create MBean [null] because parent MBean [com.bea:Name=wldf-module-1,Type=weblogic.diagnostics.descriptor.WLDFWatchNotificationBean,Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/WatchNotification[wldf-module-1]] do not define factory method [createWLDFSNMPNotification]. +---</p><p>The MBean defines the factory method:</p><div class="source"><pre class="prettyprint linenums">WLDFWatchNotificationBean.createSNMPNotification (java.lang.String name) 
</pre></div><p>Solution: Add attribute mapping rule in <tt>SpecialCasesAttributeMapperImpl.mapCreateMBean(..)</tt>: +--- if (name.equals(&quot;WLDFSNMPNotificationBean&quot;)) return &quot;SNMPNotification&quot;; +---</p></div><div class="section"><h4>OK - 137) Fails to set HarvestedAttribute attribute on WLDFHarvestedTypeBean MBean<a name="OK_-_137_Fails_to_set_HarvestedAttribute_attribute_on_WLDFHarvestedTypeBean_MBean"></a></h4><p>Error message: +--- Failed to set attribute [HarvestedAttribute] on MBean [com.bea:Name=weblogic.management.runtime.JRockitRuntimeMBean, Type=weblogic.diagnostics.descriptor.WLDFHarvestedTypeBean, Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/Harvester[wldf-module-1]/HarvestedTypes[weblogic.management.runtime.JRockitRuntimeMBean]] because it did not contain attribute. +---</p><div class="section"><h5>Problem 1: Resolution fails because attribute is unknown.<a name="Problem_1:_Resolution_fails_because_attribute_is_unknown."></a></h5><p>Solution:</p><p>Resolution fails, which is solved by attribute mapping rule in <tt>SpecialCasesAttributeMapperImpl.mapResolution(..)</tt>: +--- if (name.equals( &quot;HarvestedAttribute&quot;) ) return &quot;HarvestedAttributes&quot;; +---</p></div><div class="section"><h5>Problem 2: <tt>MBeansGetterMethodMatcherImpl.isMatch()</tt> doesn't support array attributes of the type String <a name="Problem_2:_MBeansGetterMethodMatcherImpl.isMatch_doesnt_support_array_attributes_of_the_type_String"></a></h5><p>Solution: added support for the array component type <tt>java.lang.String</tt> in <tt>MBeansGetterMethodMatcherImpl.isMatch()</tt> and <tt>MBeansGetterMethodMatcherImpl.resolveAttributeFromGetterMethod()</tt></p></div><div class="section"><h5>Problem 3: set HarvestedAttribute <a name="Problem_3:_set_HarvestedAttribute"></a></h5><p>Solution: Add attribute mapping rule in <tt>SpecialCasesAttributeMapperImpl.mapAttributeName(..)</tt>:</p><div class="source"><pre class="prettyprint linenums">        if (name.equals(&quot;HarvestedAttribute&quot; )) {               
                if (isMBeanType(objName, &quot;weblogic.diagnostics.descriptor.WLDFHarvestedTypeBean&quot;)) return &quot;HarvestedAttributes&quot;;
</pre></div></div></div><div class="section"><h4>OK - 135) Fails to resolve Notification attribute on Watch MBean<a name="OK_-_135_Fails_to_resolve_Notification_attribute_on_Watch_MBean"></a></h4><p>Error message: +--- Failed to set attribute [Notification] on MBean [com.bea:Name=high-cpu-load, Type=weblogic.diagnostics.descriptor.WLDFWatchBean, Parent=[alphadomain]/WLDFSystemResources[wldf-module-1],Path=WLDFResource[wldf-module-1]/WatchNotification[wldf-module-1]/Watches[high-cpu-load]] because it did not contain attribute. +---</p><p>Solution:</p><p>Resolution fails, which is solved by attribute mapping rule in <tt>SpecialCasesAttributeMapperImpl.mapResolution(..)</tt>: +--- // handle case for Watch.Notification // which is represented by the MBean attribute WLDFWatchBean.Notificationa if (name.equals( &quot;Notification&quot;) ) return &quot;Notifications&quot;; +---</p><p>See TDD137</p></div><div class="section"><h4>OK - 140) Fails to set SNMPNotification attribute on Watch MBean <a name="OK_-_140_Fails_to_set_SNMPNotification_attribute_on_Watch_MBean"></a></h4><p>Error message:</p><div class="source"><pre class="prettyprint linenums">Description:
Notification=wldf-snmp-notification
StackTrace:
com.alpha.pineapple.plugin.weblogic.jmx.management.JMXManagmentException: 
Failed to assign value [wldf-snmp-notification] due to exception: 
javax.management.InvalidAttributeValueException: argument type mismatch.
        at com.alpha.pineapple.plugin.weblogic.jmx.command.SetMBeanAttributeCommand.setAttributeValue(SetMBeanAttributeCommand.java:442)
        at com.alpha.pineapple.plugin.weblogic.jmx.command.SetMBeanAttributeCommand.setMBeanAttribute(SetMBeanAttributeCommand.java:283)
        at com.alpha.pineapple.plugin.weblogic.jmx.command.SetMBeanAttributeCommand.execute(SetMBeanAttributeCommand.java:148)
        at com.alpha.pineapple.command.execution.CommandRunnerImpl.run(CommandRunnerImpl.java:69)                                                       
</pre></div><p>Error message from logs:</p><div class="source"><pre class="prettyprint linenums">&lt;ResolvedModelJmxGetterImpl&gt; &lt;Failed to resolve object name from 
[[MBeanServerInvocationHandler]com.bea:Name=SEsmhpRDYN-wldf,Type=weblogic.diagnostics.descriptor.WLDFWatchBean,Parent=[alphadomain]/WLDFSystemResources[CiQXHgLNDV-wldf],Path=WLDFResource[CiQXHgLNDV-wldf]/WatchNotification[CiQXHgLNDV-wldf]/Watches[SEsmhpRDYN-wldf]]. 
Will return null.&gt;


&lt;ExecutionResultImpl&gt; &lt;Message added with id [Message] and content 
[Failed to set attribute [Notification] because MBean is undefined.].&gt;

</pre></div><p>The problem is that <tt>ResolvedModelJmxGetterImpl.getObjectName(..)</tt> can't resolve a dynamic MBEan proxy to a object name. </p><p>Solution: Added this code to <tt>SetMBeanAttributeCommand.setMBeanAttribute()</tt>:</p><div class="source"><pre class="prettyprint linenums">        ObjectName objName = modelJmxGetter.getObjectName(resolvedType);

                // if not object name then resolve it
                if(!(objName instanceof ObjectName)) {                                  
                        Object secondaryParentValue = parent.getSecondaryParticiant().getValue();                       
                        objName = mbeansModelAccessor.resolveObjectNameFromMBeanProxy(connection, secondaryParentValue );
                }

</pre></div><p>which can resolve any object object from a dynamic proxy.</p></div><div class="section"><h4>OK - 68) Implement support for resolution of entities in the MBean resolver <a name="OK_-_68_Implement_support_for_resolution_of_entities_in_the_MBean_resolver"></a></h4></div><div class="section"><h4>OK - 14) Implement/test/document traversal of arrays of different size... <a name="OK_-_14_Implementtestdocument_traversal_of_arrays_of_different_size..."></a></h4></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2012.
          All Rights Reserved.      
                    
      </div>

                          
        
                </div>
    </footer>
  </body>
</html>
