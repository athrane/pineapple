<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 13 Apr 2017
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Allan Thrane Andersen" />
    <meta name="Date-Revision-yyyymmdd" content="20170413" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Pineapple infrastructure test plugin - How-to: Test the load-balancing setup in a server environment</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Pineapple infrastructure test plugin</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="../../../index.html" title="Pineapple Home">
        Pineapple Home</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href="../../" title="Pineapple modules">
        Pineapple modules</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href="../" title="Pineapple infrastructure test plugin">
        Pineapple infrastructure test plugin</a>
        </li>
      <li class="divider ">/</li>
        <li class="">How-to: Test the load-balancing setup in a server environment</li>
        
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 13 Apr 2017</li> 
            
                            </ul>
      </div>

                  
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Project Overview</li>
                                
      <li>
    
                          <a href="../../../index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/installation.html" title="Installation">
          <i class="none"></i>
        Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/index.html" title="For Users">
          <i class="none"></i>
        For Users</a>
            </li>
                  
      <li>
    
                          <a href="../../../development/index.html" title="For Developers">
          <i class="none"></i>
        For Developers</a>
            </li>
                  
      <li>
    
                          <a href="../../../usage/terms.html" title="Terms and Conditions">
          <i class="none"></i>
        Terms and Conditions</a>
            </li>
                              <li class="nav-header">Clients</li>
                                
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-web-application/pineapple-standalone-web-client/index.html" title="Standalone Web Application">
          <i class="none"></i>
        Standalone Web Application</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-web-application/pineapple-web-application-war/index.html" title="Deployable Web Application">
          <i class="none"></i>
        Deployable Web Application</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-maven-plugin/index.html" title="Maven Plugin">
          <i class="none"></i>
        Maven Plugin</a>
            </li>
                              <li class="nav-header">Plugins</li>
                                
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-agent-plugin/index.html" title="Agent">
          <i class="none"></i>
        Agent</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-composite-execution-plugin/index.html" title="Composite Execution">
          <i class="none"></i>
        Composite Execution</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-ssh-plugin/index.html" title="SSH">
          <i class="none"></i>
        SSH</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-docker-plugin/index.html" title="Docker">
          <i class="none"></i>
        Docker</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-infrastructure-test-plugin/index.html" title="Infrastructure Test">
          <i class="none"></i>
        Infrastructure Test</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-jrockit-installation-plugin/index.html" title="JRockit Installation">
          <i class="none"></i>
        JRockit Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-fusion-middleware-installation-plugin/index.html" title="Fusion Middleware Installation">
          <i class="none"></i>
        Fusion Middleware Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-weblogic-installation-plugin/index.html" title="WebLogic Installation">
          <i class="none"></i>
        WebLogic Installation</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-weblogic-deployment-plugin/index.html" title="WebLogic Deployment">
          <i class="none"></i>
        WebLogic Deployment</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-plugins/pineapple-weblogic-scripting-tool-plugin/index.html" title="WebLogic Scripting Tool (WLST)">
          <i class="none"></i>
        WebLogic Scripting Tool (WLST)</a>
            </li>
                  
      <li>
    
                          <a href="../../../pineapple-modules/pineapple-weblogic-jmx-plugin/index.html" title="WebLogic JMX">
          <i class="none"></i>
        WebLogic JMX</a>
            </li>
                              <li class="nav-header">API's</li>
                                
      <li>
    
                          <a href="../../../pineapple-applications/pineapple-web-application/pineapple-web-application-war/usage/rest.html" title="REST">
          <i class="none"></i>
        REST</a>
            </li>
                  
      <li>
    
                          <a href="../../../development/plugin-framework.html" title="Plugin Framework">
          <i class="none"></i>
        Plugin Framework</a>
            </li>
                              <li class="nav-header">Additional Information</li>
                                
      <li>
    
                          <a href="http://pineapplesoftware.blogspot.com" class="externalLink" title="The Pineapple Project Blog">
          <i class="none"></i>
        The Pineapple Project Blog</a>
            </li>
                  
      <li>
    
                          <a href="http://exceptiontrail.blogspot.com" class="externalLink" title="Pineapple Exception Trail Blog">
          <i class="none"></i>
        Pineapple Exception Trail Blog</a>
            </li>
                              <li class="nav-header">Project Tools</li>
                                
      <li>
    
                          <a href="https://bintray.com/pineapple/maven/com.alpha.pineapple" class="externalLink" title="Downloads">
          <i class="none"></i>
        Downloads</a>
            </li>
                  
      <li>
    
                          <a href="https://github.com/athrane/pineapple" class="externalLink" title="Source Code">
          <i class="none"></i>
        Source Code</a>
            </li>
                  
      <li>
    
                          <a href="https://github.com/athrane/pineapple/issues" class="externalLink" title="Issue Tracker">
          <i class="none"></i>
        Issue Tracker</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                        
      <li>
    
                          <a href="../project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="http://maven.apache.org" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                        
        <div id="bodyColumn"  class="span10" >
                                  
            <!-- NOTE: For help with the syntax of this file, see: --><!-- http://maven.apache.org/guides/mini/guide-apt-format.html --><div class="section">
<h2>How-to: Test the load-balancing setup in a server environment<a name="How-to:_Test_the_load-balancing_setup_in_a_server_environment"></a></h2>
<div class="section">
<h3>Requirements<a name="Requirements"></a></h3>
<p>The example requires these preconditions to be run:</p>
<ul>
<li>A load balanced environment with a lest two servers. </li></ul></div>
<div class="section">
<h3>Overview<a name="Overview"></a></h3>
<p>Three steps are needed to configure the plugin to work:</p>
<ul>
<li>Define <b>resource</b> which defines access to the plugin. </li>
<li>Define test cases in Pineapple module.</li></ul>
<p>This example extends the last step of the <a href="#resolve-to-ip.html">basic example</a> by adding some new test cases. </p>
<p>For information about how to define resource, credentials and modules refer to <a href="../usage/index.html">the plugin usage page.</a></p></div>
<div class="section">
<h3>Add the load balancing test cases to the module<a name="Add_the_load_balancing_test_cases_to_the_module"></a></h3>
<p>Open the model file for the target environment and add the test case:</p>
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;mmd:models xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:mmd=&quot;http://pineapple.dev.java.net/ns/module_model_1_0&quot;                 
  xmlns:itp=&quot;http://pineapple.dev.java.net/ns/plugin/infrastructure_1_0&quot; &gt;
  &lt;mmd:model target-resource=&quot;infrastructure-test&quot;&gt;             
    &lt;mmd:content&gt;                               
      &lt;itp:infrastructure&gt;                                                                                                      

        &lt;itp:http-configuration id=&quot;default-http-config&quot; description=&quot;My default HTTP configuration&quot; &gt;
          &lt;itp:proxy host=&quot;bigbossproxy&quot; port=&quot;8080&quot;/&gt;
        &lt;/itp:http-configuration&gt;

        &lt;itp:test-load-balancing description=&quot;session-stickyness-test for...&quot; requests=&quot;5&quot; http-configuration-ref=&quot;default-http-config&quot; &gt; 
          &lt;itp:urls&gt;
            &lt;itp:url&gt;http://www.myhost.com&lt;/itp:url&gt;
            &lt;itp:url&gt;http://www.myhost.com/login&lt;/itp:url&gt;                                                                                                                                              
          &lt;/itp:urls&gt;                                   
          &lt;itp:assert&gt;
            &lt;itp:properties&gt;
              &lt;itp:property name=&quot;host&quot; value=&quot;null&quot; /&gt;
              &lt;itp:property name=&quot;environment&quot; value=&quot;null&quot; /&gt;                                          
              &lt;itp:property name=&quot;location&quot; value=&quot;null&quot; /&gt;                                                                                             
            &lt;/itp:properties&gt;                                           
            &lt;itp:servers&gt;
              &lt;itp:server&gt;qaserver1&lt;/itp:server&gt;
              &lt;itp:server&gt;qaserver2&lt;/itp:server&gt;
              &lt;itp:server&gt;qaserver3&lt;/itp:server&gt;                            
            &lt;/itp:servers&gt;
          &lt;/itp:assert&gt;
        &lt;/itp:test-load-balancing&gt;                                                                                                                          
      &lt;/itp:infrastructure&gt;                                                                     
    &lt;/mmd:content&gt;
  &lt;/mmd:model&gt;
&lt;/mmd:models&gt;
</pre></div>
<div class="section">
<h4>Meaning of the elements in the example <a name="Meaning_of_the_elements_in_the_example"></a></h4>
<ul>
<li>The <tt>test-load-balancing</tt> defines the load-balancing test. </li>
<li>The <tt>description</tt> attribute should contain a suitable description of the test which is used by Pineapple at run time in clients and reports to show the outcome of the test. </li>
<li>The <tt>requests</tt> attribute should contain the number of times the sequence of URL should be invoked. In the example the defined URL sequence is invoked 5 times. </li>
<li>The <tt>http-configuration-ref</tt> attribute references a HTTP Configuration element which configures the HTTP client with settings TCP, HTTP and proxy server. In the example the test cases uses the HTTP configuration named <i>default-http-config</i> which defines a proxy server.</li>
<li>The <tt>urls</tt> element is a container element which contains a sequence of URL's which are invoked to test the load balancing. The protocol can either be HTTP or HTTPS. In the example two URLS are defined, each by their own <tt>url</tt> element. </li>
<li>The <tt>assert</tt> element defines a container element for the expected test values. </li>
<li>The <tt>properties</tt> element defines a container element for the expected property values. In the example three properties are tested:
<ul>
<li>The <tt>host</tt> element should contain the the expected name of the accessed host. </li>
<li>The <tt>environment</tt> element should contain the the expected name of the accessed environment is returned from the load-balanced environment. This value is computed by the accessed environment or it can be null. Later in this example it is described how this value can be computed by using a simple test application. </li>
<li>The <tt>location</tt> element should contain the the expected name of the accessed location in the load-balanced environment. The location can be used to logical divide an environment in multiple sections. An environment can be divided into multiple clusters or network zones. Later in this example it is described how this value can be computed by using a simple test application. </li></ul></li>
<li>The <tt>servers</tt> element should contain the range of servers which is included in the load balancing setup. The example expected request to be load balanced between three servers: qaserver1-3. Later in this example it is described how this value can be computed by using a simple test application.</li></ul></div></div>
<div class="section">
<h3>Computing values for environment, location and servers <a name="Computing_values_for_environment_location_and_servers"></a></h3>
<p>The values can be computed by implementing a small test application which is deployed into the environment whose load balancing setup should be tested. </p>
<p>TODO: write this.. </p></div>
<div class="section">
<h3>Using Pineapple to run the test<a name="Using_Pineapple_to_run_the_test"></a></h3>
<ul>
<li>Copy the module to <tt>${user.home}/.pineapple/conf/modules</tt>.</li>
<li>Start the client by invoking <tt>runPineapple.cmd</tt>.</li>
<li>Select the module with name == <tt>pineapple-loadbalancing-example</tt></li>
<li>Select the environment <tt>qa-environment</tt></li>
<li>Press the button <tt>Deploy configuration</tt> to run the tests. </li></ul></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2017.
          All Rights Reserved.      
                    
      </div>

                          
        
                </div>
    </footer>
  </body>
</html>
