<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src\site\apt/development\index.apt at 09 Jun 2019
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Allan Thrane Andersen" />
    <meta name="Date-Revision-yyyymmdd" content="20190609" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Pineapple infrastructure test plugin &#x2013; Development documentation</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script type="text/javascript" src="../js/apache-maven-fluido-1.7.min.js"></script>
    <!-- Google Analytics -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28287414-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>Pineapple infrastructure test plugin</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
      <li class=""><a href="../../../index.html" title="Pineapple Home">Pineapple Home</a><span class="divider">/</span></li>
      <li class=""><a href="../../index.html" title="Pineapple modules">Pineapple modules</a><span class="divider">/</span></li>
      <li class=""><a href="../index.html" title="Pineapple infrastructure test plugin">Pineapple infrastructure test plugin</a><span class="divider">/</span></li>
    <li class="active ">Development documentation</li>
        <li id="publishDate" class="pull-right">Last Published: 09 Jun 2019</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Project Overview</li>
    <li><a href="../../../index.html" title="Home"><span class="none"></span>Home</a></li>
    <li><a href="../../../usage/installation.html" title="Installation"><span class="none"></span>Installation</a></li>
    <li><a href="../../../usage/index.html" title="For Users"><span class="none"></span>For Users</a></li>
    <li><a href="../../../development/index.html" title="For Developers"><span class="none"></span>For Developers</a></li>
    <li><a href="../../../usage/terms.html" title="Terms and Conditions"><span class="none"></span>Terms and Conditions</a></li>
      <li class="nav-header">Clients</li>
    <li><a href="../../../pineapple-applications/pineapple-web-application/pineapple-standalone-web-client/index.html" title="Standalone Web Application"><span class="none"></span>Standalone Web Application</a></li>
    <li><a href="../../../pineapple-applications/pineapple-web-application/pineapple-web-application-war/index.html" title="Deployable Web Application"><span class="none"></span>Deployable Web Application</a></li>
    <li><a href="../../../pineapple-applications/pineapple-maven-plugin/index.html" title="Maven Plugin"><span class="none"></span>Maven Plugin</a></li>
      <li class="nav-header">Plugins</li>
    <li><a href="../../../pineapple-plugins/pineapple-agent-plugin/index.html" title="Agent"><span class="none"></span>Agent</a></li>
    <li><a href="../../../pineapple-plugins/pineapple-composite-execution-plugin/index.html" title="Composite Execution"><span class="none"></span>Composite Execution</a></li>
    <li><a href="../../../pineapple-plugins/pineapple-ssh-plugin/index.html" title="SSH"><span class="none"></span>SSH</a></li>
    <li><a href="../../../pineapple-plugins/pineapple-git-plugin/index.html" title="Git"><span class="none"></span>Git</a></li>
    <li><a href="../../../pineapple-plugins/pineapple-docker-plugin/index.html" title="Docker"><span class="none"></span>Docker</a></li>
    <li><a href="../../../pineapple-modules/pineapple-infrastructure-test-plugin/index.html" title="Infrastructure Test"><span class="none"></span>Infrastructure Test</a></li>
      <li class="nav-header">API's</li>
    <li><a href="../../../pineapple-applications/pineapple-web-application/pineapple-web-application-war/usage/rest.html" title="REST"><span class="none"></span>REST</a></li>
    <li><a href="../../../development/plugin-framework.html" title="Plugin Framework"><span class="none"></span>Plugin Framework</a></li>
      <li class="nav-header">Additional Information</li>
    <li><a href="http://pineapplesoftware.blogspot.com" class="externalLink" title="The Pineapple Project Blog"><span class="none"></span>The Pineapple Project Blog</a></li>
    <li><a href="http://exceptiontrail.blogspot.com" class="externalLink" title="Pineapple Exception Trail Blog"><span class="none"></span>Pineapple Exception Trail Blog</a></li>
      <li class="nav-header">Project Tools</li>
    <li><a href="https://bintray.com/pineapple/maven/com.alpha.pineapple" class="externalLink" title="Downloads"><span class="none"></span>Downloads</a></li>
    <li><a href="https://github.com/athrane/pineapple" class="externalLink" title="Source Code"><span class="none"></span>Source Code</a></li>
    <li><a href="https://github.com/athrane/pineapple/issues" class="externalLink" title="Issue Tracker"><span class="none"></span>Issue Tracker</a></li>
      <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
</ul>
          <hr />
          <div id="poweredBy">
    <script type="text/javascript">asyncJs( 'https://apis.google.com/js/plusone.js' )</script>
    <div class="g-plusone" data-href="http://maven.apache.org" data-size="tall" ></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<div class="section">
<h2><a name="Development_documentation"></a>Development documentation</h2>
<div class="section">
<h3><a name="Schema_location"></a>Schema location</h3>
<p>The schema is located in the folder: <tt>src/main/resources.</tt></p>
<div class="section">
<h4><a name="Adding_the_schemas_to_the_main_project_web_site"></a>Adding the schemas to the main project web site</h4>
<p>During the <tt>site</tt> phase the schema is copied to the main site in the <tt>pineapple-project</tt>. The schema is copied to the directory <tt>/ns/plugin</tt>.</p>
<p>This is implemented in the <tt>pom.xml</tt> for the <tt>pineapple-infrastructure-test-plugin</tt> project </p></div></div>
<div class="section">
<h3><a name="Generation_of_classes_from_XML_schemas"></a>Generation of classes from XML schemas</h3>
<p>The project uses JAXB through the Maven plugin <tt>cxf-xjc-plugin</tt> to generate classes from XML schema. </p>
<div class="section">
<h4><a name="Customized_package_names"></a>Customized package names</h4>
<p>The generated classes are mapping into the package <tt>com.alpha.pineapple.model</tt> using the JAXB bindings file at: <tt>src/main/resources/bindings.xjb</tt>.</p></div>
<div class="section">
<h4><a name="Customized_type_names"></a>Customized type names</h4>
<p>The JAXB bindings file also defines mappings of Schema type into Java types. The applied rule is to remove the postfixed <tt>Type</tt> from the Schema type in the corresponding Java types, i.e. from the schema type named <tt>NiceType</tt> a Java type named <tt>Nice</tt> is generated by JAXB. </p></div></div>
<div class="section">
<h3><a name="Handling_HTTPS_connections"></a>Handling HTTPS connections</h3>
<p>The test commands <tt>TestLoadBalancingCommand</tt> and <tt>TestStickynessCommand</tt> uses the command <tt>InvokeHttpGetMethodCommand</tt> for HTTP invocations. </p>
<p>The <tt>InvokeHttpGetMethodCommand</tt> uses the <a class="externalLink" href="http://hc.apache.org/httpclient-3.x/">Apache HTTP Client</a>. The <tt>HTTPClient</tt> is configured to used a <tt>SecureProtocolSocketFactory</tt> implementation which accepts all SSL certificates. The used implementation is <tt>EasySSLProtocolSocketFactory</tt> which is configured with the trust manager <tt>AcceptingSSLTrustManager</tt> which accepts all certificate chains. </p>
<p>The consequence is that certificate validation is disabled for SSL and all certificates are accepted. The certificates <b>are</b> not stored permanently in the key store of the used Java installation. </p></div>
<div class="section">
<h3><a name="Internal_configuration"></a>Internal configuration</h3>
<div class="section">
<h4><a name="Logging"></a>Logging</h4>
<p>The plugin uses Log4j for logging. Each project which links to this project must provide a Log4j configuration which is accessible at runtime as a result of the build process.</p>
<p>The plugin component does not provide a Log4j configuration as part of its production build. A log4j configuration file is defined in the project in the directory <tt>src/test/resources/log4.properties</tt> for testing. </p>
<p>The test configuration configures Log4j to write to the log file to <tt>${user.home}/.pineapple/logs/pineapple.log</tt>.</p></div>
<div class="section">
<h4><a name="Spring_configuration_file"></a>Spring configuration file </h4>
<p>The plugin contains a configuration file which defines a Spring application context. The Spring application context defines the input unmarshalling for the plugin. The file is located in <tt>src/main/resources/com.alpha.pineapple.plugin.net-config.xml</tt>. </p></div>
<div class="section">
<h4><a name="JAXB_binding_file"></a>JAXB binding file </h4>
<p>JAXB bindings file used during generation of model objects from the plugin schema is located at <tt>src/main/resources/bindings.xjb</tt>.</p></div>
<div class="section">
<h4><a name="Internationalization_.28I18N.29_configuration_file"></a>Internationalization (I18N) configuration file </h4>
<p>The plugin uses internationalization. Messages used by classes in the plugin are located in the file <tt>src/main/resources/com.alpha.pineapple.plugin.net-messages.properties</tt>. </p></div></div>
<div class="section">
<h3><a name="Test"></a>Test </h3>
<div class="section">
<h4><a name="Unit_test"></a>Unit test</h4>
<p>Commonly used constants in the unit tests are defined in the class <tt>com.alpha.testutils.InfrastructurePluginTestConstants</tt>.</p></div>
<div class="section">
<h4><a name="Integration_test"></a>Integration test</h4>
<p>Integration tests for the project are placed in the same packages as the unit tests. The integration tests are postfixed with <tt>IntegrationTest</tt> where the unit test have the postfix <tt>Test</tt>.</p>
<p>Example: The unit test for the class <tt>InvokeHTTPGetCommand</tt> is named <tt>InvokeHTTPGetCommandTest</tt> and the integration test is named <tt>InvokeHTTPGetCommandIntegrationTest</tt>. </p></div>
<div class="section">
<h4><a name="Helper_classes"></a>Helper classes</h4>
<p>Helper classes:</p>
<ul>
<li><tt>com.alpha.testutils.ObjectMotherContent</tt> </li>
<li><tt>com.alpha.testutils.ObjectMotherHttpServer</tt> </li></ul>
<div class="section">
<h5><a name="com.alpha.testutils.ObjectMotherContent"></a>com.alpha.testutils.ObjectMotherContent </h5>
<p><tt>com.alpha.testutils.ObjectMotherContent</tt> is an implementation of the ObjectMother pattern. The class provides helper functions for testing by creating content for operations.</p></div>
<div class="section">
<h5><a name="com.alpha.testutils.ObjectMotherHttpServer"></a>com.alpha.testutils.ObjectMotherHttpServer </h5>
<p><tt>com.alpha.testutils.ObjectMotherHttpServer</tt> is an implementation of the ObjectMother pattern. The class provides helper functions for creating HTTP server instances.</p>
<p>The factory method <tt>ObjectMotherHttpServer.createHttpServer(..)</tt> creates a HTTP server which listens @ 127.0.0.1:3000. The HTTP server is configured with:</p>
<ul>
<li>The <tt>com.alpha.testutils.jetty.SnifferServlet</tt> which responds at <tt>HTTP://127.0.0.1:3000/sniffer</tt>. All other URL's respond with an HTTP 404 status code. </li>
<li>The server also sets the <i>JSESSIONID</i> session tracking cookie when an valid URL is visited. Setting the cookie is implemented by the <tt>com.alpha.testutils.jetty.JSessionIdSetterFilter</tt> servlet filter.</li></ul>
<p>The factory method <tt>ObjectMotherHttpServer.createHttpServerWithRedirect(..)</tt> a HTTP server which listens @ 127.0.0.1:3000. The HTTP server is configured with:</p>
<ul>
<li>The <tt>com.alpha.testutils.jetty.SnifferServlet</tt> which responds at <tt>HTTP://127.0.0.1:3000/sniffer</tt>. All other URL's respond with an HTTP 404 status code. </li>
<li>The server also sets the <i>JSESSIONID</i> session tracking cookie when an valid URL is visited. Setting the cookie is implemented by the <tt>com.alpha.testutils.jetty.JSessionIdSetterFilter</tt> servlet filter.</li>
<li>A redirect servlet which redirects requests from <tt>HTTP://127.0.0.1:3000/redirect</tt> to <tt>HTTP://127.0.0.1:3000/sniffer</tt>. and returns HTTP 302 status code.</li></ul>
<p>The class is used by integration tests. e.g. the class is used by the class <tt>InvokeHTTPGetCommandIntegrationTest</tt>. </p></div></div></div>
<div class="section">
<h3><a name="Implementation"></a>Implementation</h3>
<div class="section">
<h4><a name="Plugin_class"></a>Plugin class</h4>
<p>The package <tt>com.alpha.pineapple.plugin.net</tt> is the root package of the plugin and contains the plugin class <tt>PluginImpl</tt>. </p></div>
<div class="section">
<h4><a name="Session_class"></a>Session class</h4>
<p>No session class exists for this plugin. </p></div>
<div class="section">
<h4><a name="Operation_classes"></a>Operation classes</h4>
<p>The package <tt>com.alpha.pineapple.plugin.net.operation</tt> contains the operation classes for the plugin.</p>
<p>The plugin implement these default operations: </p>
<ul>
<li><tt>TestOperation</tt> implements the operation <tt>test</tt>. </li></ul></div>
<div class="section">
<h4><a name="Model_helper_classes"></a>Model helper classes</h4>
<p>The package <tt>com.alpha.pineapple.plugin.net.model</tt> contains a helper class named <tt>AssertionValuesPropertyGetter</tt> which reads properties from the model class <tt>AssertionValues</tt> into a hash map and provides an interface for property lookup by name.</p>
<p>The class <tt>MapperImpl</tt> which implements the interface <tt>Mapper</tt> implements mapping between the schema generated classes to the command context using the proper command keys. The class is used by the operation class to map data to the command context prior to command invocation.</p></div></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
Copyright (C) 2007-2019 Allan Thrane Andersen. All Rights Reserved.
        </div>
      </div>
    </footer>
  </body>
</html>
